<?xml version="1.0" encoding="utf-8"?>
<html MadCap:onlyLocalStylesheets="False" MadCap:searchable="True" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="MultiProdPublish.Classic+OIE" MadCap:fileTags="Tags/okta-authors.Mark Cowan">
    <head>
        <link href="../../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>[%=Heading.Level1%] | Okta</title>
        <link href="" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>Office 365 sign-on rules options</h1>
        <p>This topic explains conditions and actions available for Office 365 app sign-on rules.</p>
        <div MadCap:conditions="MultiProdPublish.Classic">
            <h2>Conditions</h2>
            <p>Select under what conditions this rule will apply.  </p>
            <h3>People</h3>
            <p>This section determines to whom the sign-on rule will apply. You can choose from the following options:</p>
            <table style="width: 100%;mc-table-style: url('../../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                <col class="TableStyle-standard-Column-Column1" />
                <col class="TableStyle-standard-Column-Column1" />
                <thead>
                    <tr class="TableStyle-standard-Head-Header1">
                        <th class="TableStyle-standard-HeadF-Column1-Header1">Option</th>
                        <th class="TableStyle-standard-HeadD-Column1-Header1">What it does</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-standard-Body-Body1">
                        <td class="TableStyle-standard-BodyF-Column1-Body1">Users assigned this app</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body1">Applies the rule to the users who are assigned this  app</td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body2">
                        <td class="TableStyle-standard-BodyC-Column1-Body2">The following groups and users</td>
                        <td class="TableStyle-standard-BodyA-Column1-Body2">
                            <p>Applies the rule to specific groups and  users who are assigned this app. </p>
                            <p>To exclude specific groups and users from the rule, select <span class="uicontrol">Exclude the following users and groups from this rule</span> and then specify groups and users.</p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <div class="noteOkta">
                <p class="noteContent">Consider scoping the rule to groups or a subset of users if:</p>
                <ul>
                    <li>
				You want to enable exceptions for the app access.
			</li>
                    <li>You want to slowly phase the sign-on rules in to an existing app.</li>
                </ul>
            </div>
            <h3>Location</h3>
            <p>This section determines to which location the sign on rule will apply. If you are applying the rule to specific zones, you first need to set up Network Zone in Okta. See <MadCap:xref href="../../../Security/network/network-zones.htm">Network Security</MadCap:xref>. Also consider the impact of network zones when restricting access.</p>
            <p>You can choose from the following options:</p>
            <table style="width: 100%;mc-table-style: url('../../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                <col class="TableStyle-standard-Column-Column1" />
                <col class="TableStyle-standard-Column-Column1" />
                <thead>
                    <tr class="TableStyle-standard-Head-Header1">
                        <th class="TableStyle-standard-HeadF-Column1-Header1">Option</th>
                        <th class="TableStyle-standard-HeadD-Column1-Header1">What it does</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-standard-Body-Body1">
                        <td class="TableStyle-standard-BodyF-Column1-Body1">Anywhere</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body1">Applies the rule to all users regardless of where the access is originating</td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body2">
                        <td class="TableStyle-standard-BodyF-Column1-Body2">In Zone</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body2">
                            <p>Applies the rule to users coming from a specific location or IP range. For example, a branch office in a location with unreliable security. You may make MFA a consistent requirement from this location.</p>
                        </td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body1">
                        <td class="TableStyle-standard-BodyC-Column1-Body1">Not in Zone</td>
                        <td class="TableStyle-standard-BodyA-Column1-Body1">Applies this rule to anyone NOT coming from a specific location or IP range. For example, you may have corporate offices configured as a network location in Okta. You may require that MFA is always enforced when users are not coming from one of these known networks.</td>
                    </tr>
                </tbody>
            </table>
            <h3>Client</h3>
            <p>The <span class="uicontrol">Client Type</span> section determines to which clients the sign on rule will apply. You can choose from the following options:</p>
            <table style="width: 100%;mc-table-style: url('../../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                <col class="TableStyle-standard-Column-Column1" />
                <col class="TableStyle-standard-Column-Column1" />
                <thead>
                    <tr class="TableStyle-standard-Head-Header1">
                        <th class="TableStyle-standard-HeadF-Column1-Header1">Option</th>
                        <th class="TableStyle-standard-HeadD-Column1-Header1">What it does</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-standard-Body-Body1">
                        <td class="TableStyle-standard-BodyF-Column1-Body1">Web browser</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body1">Applies the rule to web browsers such as Chrome, Safari, or Internet Explorer.</td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body2">
                        <td class="TableStyle-standard-BodyF-Column1-Body2">Modern Authentication</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body2">
                            <p>Applies the rule to thick client applications configured to leverage Modern Authentication. This includes Office 2013 and 2016 clients with required patches or configuration updates, as detailed in this Microsoft Support documentation: <a href="https://www.microsoft.com/en-us/microsoft-365/blog/2015/11/19/updated-office-365-modern-authentication-public-preview/">Updated Office 365 modern authentication</a>. </p>
                            <p>Modern Authentication is a configurable setting on an Office 365 tenant for Exchange Online. See Microsoft documentation: <a href="https://support.office.com/en-us/article/Enable-Exchange-Online-for-modern-authentication-58018196-f918-49cd-8238-56f57f38d662">Enable or disable modern authentication in Exchange Online</a> and <a href="https://social.technet.microsoft.com/wiki/contents/articles/36101.office-365-enable-modern-authentication.aspx">Office 365: Enable Modern Authentication</a>.</p>
                        </td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body1">
                        <td class="TableStyle-standard-BodyF-Column1-Body1">Exchange ActiveSync/ Legacy Authentication</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body1">Applies the rule to native mail clients on iOS or Android devices, as well as older desktop clients on macOS and MS Windows that do not support Modern Authentication. Exchange ActiveSync or Legacy Auth client do not support multifactor authentication.</td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body2">
                        <td class="TableStyle-standard-BodyC-Column1-Body2">
                            <p>Custom</p>
                        </td>
                        <td class="TableStyle-standard-BodyA-Column1-Body2">
                            <p>Specify a client to allow or deny it access to Office 365. This filter can be used to deny access to untrusted clients or to only allow trusted clients. See <MadCap:xref href="../custom-client-filter.htm">Allow or deny custom clients in Office 365 sign on policy</MadCap:xref>.</p>
                        </td>
                    </tr>
                </tbody>
            </table>
            <p>The <span class="uicontrol">Platform Type</span> section determines to which platforms the sign on rule will apply. You can choose from the following options:</p>
            <table style="width: 100%;mc-table-style: url('../../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                <col class="TableStyle-standard-Column-Column1" />
                <col class="TableStyle-standard-Column-Column1" />
                <thead>
                    <tr class="TableStyle-standard-Head-Header1">
                        <th class="TableStyle-standard-HeadF-Column1-Header1">Option</th>
                        <th class="TableStyle-standard-HeadD-Column1-Header1">What it does</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-standard-Body-Body1">
                        <td class="TableStyle-standard-BodyF-Column1-Body1">iOS</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body1">Applies the rule to the users coming from an iOS device.</td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body2">
                        <td class="TableStyle-standard-BodyF-Column1-Body2">Android</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body2">
                            <p>Applies the rule to the users coming from an Android device.</p>
                        </td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body1">
                        <td class="TableStyle-standard-BodyF-Column1-Body1">Other mobile</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body1">
                            <p>Applies the rule to the users coming from non-iOS and non-Android devices. For example, Blackberry. </p>
                            <p>Also useful for client types for which Okta can't determine the operating system type by inspecting the request header. For example, when using an Outlook mail app on an iOS or Android device, the request header contains both iOS and Android. Selecting <span class="uicontrol">Other mobile</span> allows the rule to evaluate requests from these clients.</p>
                        </td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body2">
                        <td class="TableStyle-standard-BodyF-Column1-Body2">Windows</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body2">Applies the rule to the users coming from a Windows device.</td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body1">
                        <td class="TableStyle-standard-BodyF-Column1-Body1">macOS</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body1">Applies the rule to the users coming from a macOS device.</td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body2">
                        <td class="TableStyle-standard-BodyC-Column1-Body2">Other desktop</td>
                        <td class="TableStyle-standard-BodyA-Column1-Body2">Applies the rule to the users coming from clients other than Windows and macOS. For example, Linux.</td>
                    </tr>
                </tbody>
            </table>
            <div class="noteOkta" MadCap:conditions="Primary.do-not-publish">
                <p class="noteContent">Sign on rules for the Office 365 app have additional configuration options. See &lt;&lt;O365 Clients&gt;&gt;.</p>
            </div>
            <h3><MadCap:variable name="okta-feature-names.Device Trust" />
            </h3>
            <p>If Device Trust is enabled for your org, these settings allow you to manage access to apps depending on whether a device is trusted. See <MadCap:xref href="../../../device-trust/device-trust-landing.htm">Okta Device Trust solutions</MadCap:xref>.</p>
            <h2>Actions</h2>
            <p>Select what actions should be taken when the conditions set in a rule are met. For example:</p>
            <ul>
                <li>
                    <p>You can deny access if a user is coming from a risky or unknown network location.</p>
                </li>
                <li>
                    <p>You can set a requirement to prompt the user to re-authenticate after a set amount of time has elapsed after the app has launched.</p>
                </li>
                <li>
                    <p>You can prompt the user to perform MFA when signing into the app.</p>
                </li>
            </ul>
            <h3>Access</h3>
            <p>This section determines the actions that will be taken when all conditions set in the sign on rule are met. If you are requiring the user to complete MFA before accessing the app, you first need to set up MFA in Okta. See <MadCap:xref href="../../../Security/mfa/mfa-home.htm">Multifactor Authentication (MFA)</MadCap:xref>. Also consider the impact of network zones when prompting for MFA.</p>
            <p>You can choose from the following options:</p>
            <table style="width: 100%;mc-table-style: url('../../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                <col class="TableStyle-standard-Column-Column1" />
                <col class="TableStyle-standard-Column-Column1" />
                <thead>
                    <tr class="TableStyle-standard-Head-Header1">
                        <th class="TableStyle-standard-HeadF-Column1-Header1">Option</th>
                        <th class="TableStyle-standard-HeadD-Column1-Header1">What it does</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="TableStyle-standard-Body-Body1">
                        <td class="TableStyle-standard-BodyF-Column1-Body1">Allowed</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body1">Allows access when all conditions set in the sign on rule are met.</td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body2">
                        <td class="TableStyle-standard-BodyF-Column1-Body2">Denied</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body2">Denies access when all conditions set in the sign on rule are met.</td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body1">
                        <td class="TableStyle-standard-BodyF-Column1-Body1">Prompt for re-authentication</td>
                        <td class="TableStyle-standard-BodyD-Column1-Body1">For SAML apps only, specifies how frequently the user will be prompted to re-authenticate. The time period you specify begins from the moment the user last authenticated into Okta.</td>
                    </tr>
                    <tr class="TableStyle-standard-Body-Body2">
                        <td class="TableStyle-standard-BodyC-Column1-Body2">Prompt for factor</td>
                        <td class="TableStyle-standard-BodyA-Column1-Body2">Requires the user to successfully complete the MFA prompt and specifies how frequently the user will be prompted for MFA.</td>
                    </tr>
                </tbody>
            </table>
            <div class="noteOkta">
                <ul>
                    <li>
                        <p class="noteContent">Okta enforces Sign On policies when a client is directed back to its Okta org. For browser-based clients, this generally occurs when the session is terminated by closing the browser or clearing cookies.
				</p>
                    </li>
                    <li>
                        <p class="noteContent">For desktop clients (that is clients not using Modern Authentication) and Exchange ActiveSync clients, an authenticated session is cached for up to 24 hours within the Microsoft service. After configuring client access policies to restrict these client types, it may take up to 24 hours for the restrictions to take effect.</p>
                    </li>
                    <li>
                        <p class="noteContent">For thick clients supporting MFA, the individual app or service determines how frequently they are directed back to Okta for authentication. For Microsoft Office apps refresh intervals, see <a href="https://docs.microsoft.com/en-us/microsoft-365/Enterprise/session-timeouts?view=o365-worldwide">Session timeouts for Office 365</a>.		</p>
                    </li>
                </ul>
            </div>
        </div>
        <p MadCap:conditions="MultiProdPublish.OIE">To create sign-on rules for an Office 365 app instance, follow the steps explained in <MadCap:xref href="../../../identity-engine/policies/add-app-sign-on-policy-rule.htm">Add an app sign-on policy rule</MadCap:xref>. In addition to the conditions explained in the topic, you can add the following client-specific conditions to your Office 365 app sign-on policy. These conditions allow you to apply sign-on rules based on whether the user is using a web browser, legacy authentication, or modern authentication.</p>
        <div class="noteOkta">
            <p class="noteContent" MadCap:conditions="MultiProdPublish.OIE">You can add maximum 100 rules to Office 365 sign on policy, including the Catch-All rule.</p>
        </div>
        <h2 MadCap:conditions="MultiProdPublish.OIE">If conditions</h2>
        <p style="font-weight: bold;" MadCap:conditions="MultiProdPublish.OIE">Client is</p>
        <table style="width: 100%;mc-table-style: url('../../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
            <col class="TableStyle-standard-Column-Column1" style="width: 300px;" />
            <col class="TableStyle-standard-Column-Column1" />
            <thead>
                <tr class="TableStyle-standard-Head-Header1">
                    <th class="TableStyle-standard-HeadF-Column1-Header1" MadCap:conditions="MultiProdPublish.OIE">Option</th>
                    <th class="TableStyle-standard-HeadD-Column1-Header1" MadCap:conditions="MultiProdPublish.OIE">What it does</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-standard-Body-Body1">
                    <td class="TableStyle-standard-BodyF-Column1-Body1" MadCap:conditions="MultiProdPublish.OIE">Any client</td>
                    <td class="TableStyle-standard-BodyD-Column1-Body1">
                        <p MadCap:conditions="MultiProdPublish.OIE">Default option. Applies the rule irrespective of the user's client. </p>
                        <p MadCap:conditions="MultiProdPublish.OIE">This option does not support multifactor authentication. Only single-factor password-based authentication will be used to authenticate users.
</p>
                    </td>
                </tr>
                <tr class="TableStyle-standard-Body-Body2">
                    <td class="TableStyle-standard-BodyC-Column1-Body2" MadCap:conditions="MultiProdPublish.OIE">One of the following clients</td>
                    <td class="TableStyle-standard-BodyA-Column1-Body2">
                        <p MadCap:conditions="MultiProdPublish.OIE">Applies the rule to specific clients. See the table below for options.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <p style="font-weight: bold;" MadCap:conditions="MultiProdPublish.OIE">Client options</p>
        <table style="width: 100%;mc-table-style: url('../../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
            <col class="TableStyle-standard-Column-Column1" style="width: 300px;" />
            <col class="TableStyle-standard-Column-Column1" />
            <thead>
                <tr class="TableStyle-standard-Head-Header1">
                    <th class="TableStyle-standard-HeadF-Column1-Header1" MadCap:conditions="MultiProdPublish.OIE">Option</th>
                    <th class="TableStyle-standard-HeadD-Column1-Header1" MadCap:conditions="MultiProdPublish.OIE">What it does</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-standard-Body-Body1">
                    <td class="TableStyle-standard-BodyF-Column1-Body1" MadCap:conditions="MultiProdPublish.OIE">Web browser</td>
                    <td class="TableStyle-standard-BodyD-Column1-Body1" MadCap:conditions="MultiProdPublish.OIE">Applies the rule to web browsers such as Chrome, Safari, or Internet Explorer.</td>
                </tr>
                <tr class="TableStyle-standard-Body-Body2">
                    <td class="TableStyle-standard-BodyF-Column1-Body2" MadCap:conditions="MultiProdPublish.OIE">Modern Authentication</td>
                    <td class="TableStyle-standard-BodyD-Column1-Body2">
                        <p MadCap:conditions="MultiProdPublish.OIE">Applies the rule to thick client applications configured to leverage Modern Authentication. This includes Office 2013 and 2016 clients with required patches or configuration updates, as detailed in this Microsoft Support documentation: <a href="https://www.microsoft.com/en-us/microsoft-365/blog/2015/11/19/updated-office-365-modern-authentication-public-preview/">Updated Office 365 modern authentication</a>. </p>
                        <p MadCap:conditions="MultiProdPublish.OIE">Modern Authentication is a configurable setting on an Office 365 tenant for Exchange Online. See Microsoft documentation: <a href="https://support.office.com/en-us/article/Enable-Exchange-Online-for-modern-authentication-58018196-f918-49cd-8238-56f57f38d662">Enable or disable modern authentication in Exchange Online</a> and <a href="https://social.technet.microsoft.com/wiki/contents/articles/36101.office-365-enable-modern-authentication.aspx">Office 365: Enable Modern Authentication</a>.</p>
                    </td>
                </tr>
                <tr class="TableStyle-standard-Body-Body1">
                    <td class="TableStyle-standard-BodyF-Column1-Body1" MadCap:conditions="MultiProdPublish.OIE">Exchange ActiveSync/ Legacy Authentication</td>
                    <td class="TableStyle-standard-BodyD-Column1-Body1">
                        <p MadCap:conditions="MultiProdPublish.OIE">Applies the rule to native mail clients on iOS or Android devices, as well as older desktop clients on macOS and MS Windows that don't support Modern Authentication. </p>
                        <ul>
                            <li>
                                <p MadCap:conditions="MultiProdPublish.OIE">Exchange ActiveSync or Legacy Auth clients doesn't support multifactor authentication. Only single-factor password-based authentication will be used to authenticate users.
</p>
                            </li>
                            <li>
                                <p MadCap:conditions="MultiProdPublish.OIE">Okta doesn’t support Just-In-Time provisioning for Exchange ActiveSync or legacy authentication. Any Staged users or users who have not yet been imported must first sign into Okta to activate their Okta account before they can successfully authenticate into Office 365 apps through Exchange ActiveSync or legacy authentication.</p>
                            </li>
                            <li>
                                <p MadCap:conditions="MultiProdPublish.OIE">Deactivated users whose accounts have been reactivated in AD or LDAP won’t be automatically reactivated during legacy authentication. These users must first sign into Okta to reactivate their account before using legacy authentication.</p>
                            </li>
                            <li>
                                <p MadCap:conditions="MultiProdPublish.OIE">Any updates to the user's profile attributes in AD or LDAP won’t be automatically pulled into Okta during legacy authentication.</p>
                            </li>
                        </ul>
                    </td>
                </tr>
                <tr class="TableStyle-standard-Body-Body2" MadCap:conditions="">
                    <td class="TableStyle-standard-BodyC-Column1-Body2">
                        <p MadCap:conditions="MultiProdPublish.OIE">Custom</p>
                    </td>
                    <td class="TableStyle-standard-BodyA-Column1-Body2">
                        <p MadCap:conditions="MultiProdPublish.OIE">Specify a client to allow or deny it access to Office 365. This filter can be used to deny access to untrusted clients or to only allow trusted clients. See <MadCap:xref href="../custom-client-filter.htm">Allow or deny custom clients in Office 365 sign-on policy</MadCap:xref>.</p>
                    </td>
                </tr>
            </tbody>
        </table>
        <div>
            <h2>Next step</h2>
            <p>
                <MadCap:xref href="../create-sign-on-rule.htm">Create Office 365 sign on rules</MadCap:xref>
            </p>
        </div>
    </body>
</html>