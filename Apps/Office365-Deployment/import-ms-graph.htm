<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
   <head>
    </head>
   <body>
      <h1>Import users to Office 365 using Microsoft Graph API</h1>
      <p>You can import users from different source directories into Okta and provision them in Office 365 using Microsoft Graph API.</p>
      <h2>Before you begin</h2>
      <ul>
         <li>Complete <MadCap:xref href="configure-sso.htm">Configure single sign on for Office 365</MadCap:xref>.</li>
         <li>Disable the Microsoft MFA for the Office 365 admin account you’re using for WS-Federation. If the MFA is enabled, it can break provisioning and single sign on set-ups in Okta.</li>
      </ul>
      <h2>Start this procedure</h2>
      <p>To import users using Microsoft Graph API, you need to:</p>
      <ul>
         <li>
            <p>
               <MadCap:xref href="#Enable">Enable API integration and provide Microsoft admin consent</MadCap:xref>
            </p>
         </li>
         <li>
            <p>Optional. <MadCap:xref href="../Office365/Skip_Group_Import_Office365.htm">Skip importing groups during Office 365 user provisioning</MadCap:xref>
            </p>
         </li>
      </ul>
      <h2>
         <a name="Enable"/>Enable API integration and provide Microsoft admin consent</h2>
      <div class="noteOkta">
         <p class="noteContent">If you’ve already Set up Okta to Office 365 provisioning and provided Microsoft admin consent, you can skip this procedure, and start importing from Microsoft Office 365.</p>
      </div>
      <p>You can automate provisioning tasks by enabling API integration and granting admin consent. Office 365 requires a token to authenticate against the Microsoft API. This allows Okta to implement provisioning in Office 365.</p>
      <p>
         <img src="../../../Resources/Images/Office365/Office365_Provisioning_Tab_Unconfigured.png"
              class="thumbnail"
              MadCap:conditions="MultiProdPublish.Classic">
            </img>
      </p>
      <ol>
         <li>Go to <span class="menucascade">
               <span class="uicontrol">Office 365</span>
               <span class="uicontrol">Provisioning</span>
               <span class="uicontrol">API Integration</span>
               <span class="uicontrol">Configure API Integration</span>
            </span>.</li>
         <li>Check <span class="uicontrol">Enable API Integration</span>.</li>
         <li>Enter Admin Username and Admin Password.</li>
         <li>
            <p>Click <span class="uicontrol">Authenticate with Microsoft Office 365</span>. You are redirected to the Microsoft account log in page.</p>
         </li>
         <li>
            <p>On the Microsoft account log in page, do the following:</p>
            <ol style="list-style-type: lower-alpha;">
               <li>
                  <p>Log into Microsoft as a Global Administrator for your Microsoft tenant.</p>
               </li>
               <li>
                  <p>Read and accept the instructions listed on the <span class="uicontrol">Okta Microsoft Graph Client</span> page.</p>
               </li>
            </ol>
         </li>
         <li>
            <p>To import groups now, check <span class="uicontrol">Import Groups</span>.</p>
            <p>You can import groups later after finishing provisioning. See <MadCap:xref href="../Office365/Skip_Group_Import_Office365.htm">Skip importing groups during Office 365 user provisioning</MadCap:xref>.</p>
         </li>
         <li>Click <span class="uicontrol">Test API Credentials</span>.</li>
         <li>Save the credentials once they are verified successfully. You can now go to the <span class="uicontrol">Imports tab</span> and start importing from Microsoft Office 365.</li>
      </ol>
   </body>
</html>
