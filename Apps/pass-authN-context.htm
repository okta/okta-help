<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:fileTags="Tags/okta-authors.Mark Cowan">
    <head><title>[%=Heading.Level1%] | Okta</title>
        <meta name="description" content="Write attribute statements with Okta Expression Language to federate Okta user attributes to dynamic SAML attributes." />
    </head>
    <body>
        <h1>Pass Dynamic Authentication Context</h1>
        <p>You can pass Dynamic Authentication Context to your SAML apps through the SAML assertion during application authentication. The app can then use the information to limit access to certain app-specific behaviors and calculate the risk profile for the logged-in user.</p>
        <p>The feature works with both custom and OIN-sourced SAML app integrations. It's exposed through an <a href="https://developer.okta.com/docs/reference/okta-expression-language/">Okta Expression Language</a> claim and you can configure it as a custom SAML attribute. Depending on the number of factors used during authentication, the attribute can generate one or multiple values in the assertion (see <MadCap:xref href="#Assertio">Assertion examples</MadCap:xref>). </p>
        <p>Developers can also use the <a href="https://developer.okta.com/docs/reference/api/apps/#add-custom-saml-application">Okta Apps API</a> to configure the custom attribute. The process of passing authentication contexts is similar to using claims containing <a href="https://developer.okta.com/docs/reference/api/oidc/#base-claims-always-present">authentication method references</a> (<span class="varname">amr</span>) in OIDC Apps.</p>
        <h2>Enable Dynamic Authentication Method References</h2>
        <MadCap:snippetBlock src="Apps-Snippets/custom_attribute_steps.flsnp" />
        <ol start="5">
            <li>In <span class="uicontrol">Value</span>, enter <span class="userinput">session.amr</span></li>
            <li>Click <span class="uicontrol">Next</span>.</li>
            <li>Click <span class="uicontrol">Finish</span>.</li>
        </ol>
        <h2><a name="Assertio"></a>Assertion examples</h2>
        <p>The following assertion excerpts show examples of single-value versus multi-value authentication-context attributes for the <span class="varname">amr</span> attribute statement.</p>
        <p>When using just a password:</p><span class="codeblock">&lt;saml:Attribute Name="amr" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified"&gt;
    &lt;saml:AttributeValue xsi:type="xs:string"&gt;pwd&lt;/saml:AttributeValue
&lt;/saml:Attribute&gt;</span>
        <p>When using a password with <MadCap:variable name="okta-feature-names.Okta Verify" /> as a second factor:</p><span class="codeblock">&lt;saml:Attribute Name="amr" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:unspecified"&gt;
    &lt;saml:AttributeValue xsi:type="xs:string"&gt;pwd&lt;/saml:AttributeValue&gt;
    &lt;saml:AttributeValue xsi:type="xs:string"&gt;mfa&lt;/saml:AttributeValue&gt;
    &lt;saml:AttributeValue xsi:type="xs:string"&gt;swk&lt;/saml:AttributeValue&gt;
&lt;/saml:Attribute&gt;</span>
        <div class="noteOkta">
            <p class="noteContent">Currently, Okta supports only Dynamic SAML Authentication Context and Smart card for primary Identity Provider (IdP) authentication. For example, if you use a federated IdP to sign in to your application and use Dynamic SAML, the assertion only contains <span class="code">pwd</span> as a default value. Similarly, if you use Smart card, the assertion only contains <span class="code">sc</span> as the default value. </p>
        </div>
        <h2>Related topics</h2>
        <p>
            <MadCap:xref href="Apps_App_Integration_Wizard_SAML.htm">Create a SAML integration using AIW</MadCap:xref>
        </p>
        <p>
            <MadCap:xref href="apps-add-applications.htm">Add existing app integrations</MadCap:xref>
        </p>
        <p>
            <MadCap:xref href="Apps_App_Integration_Wizard.htm">Using the App Integration Wizard</MadCap:xref>
        </p>
        <p><a href="https://developer.okta.com/docs/reference/okta-expression-language/">Expression Language</a>
        </p>
    </body>
</html>