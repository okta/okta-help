<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:onlyLocalStylesheets="False"
      MadCap:fileTags="Tags/okta-authors.Mark Cowan"
      MadCap:conditions="MultiProdPublish.Classic+OIE">
   <head>
      <link href="../../Resources/TableStyles/standard.css"
            rel="stylesheet"
            MadCap:stylesheetType="table"/>
      <title>[%=Heading.Level1%] | Okta</title>
      <meta name="description"
            content="Explains how to enable Microsoft admin consent. For some Office 365 apps, Okta needs admin consent to authenticate end users."/>
   </head>
   <body>
        <!--New doc begins here-->
      <h1>Provide Microsoft admin consent for Okta</h1>
      <p MadCap:conditions="Primary.do-not-publish">OFFICE365_CRM_REDIRECT_V1 EA to GA Preview 2019.09.0</p>
      <p>Microsoft requires you as an admin to provide consent to allow Okta to access users and data in your Microsoft tenant. By granting consent,  you allow Okta to access the Microsoft Graph API on your behalf and use the information provided by Microsoft Office 365.</p>
      <h2>Before you begin</h2>
      <p>Ensure you have the Global Administrator permissions in the Microsoft tenant.</p>
      <h2>Which permissions Okta requires and why</h2>
      <p>Okta requires these permissions for the following:</p>
      <ul>
         <li>
            <span>Provisioning: to provision or deprovision users from Office 365.</span>
         </li>
         <li>Single sign on: to authenticate and authorize users into Office 365 apps that use OAuth-based authentication. Some of these apps are Yammer, Dynamics CRM, Teams, and Forms.</li>
         <li>You need to provide admin consent either when configuring provisioning or when configuring single sign on for the Office 365 app. In both cases, Okta requires the following permissions in your Microsoft tenant:</li>
      </ul>
      <table style="width: 100%;mc-table-style: url('../../Resources/TableStyles/standard.css');"
             class="TableStyle-standard"
             cellspacing="0">
         <col class="TableStyle-standard-Column-Column1"/>
         <col class="TableStyle-standard-Column-Column1"/>
         <thead>
            <tr class="TableStyle-standard-Head-Header1">
               <th class="TableStyle-standard-HeadF-Column1-Header1"
                   style="font-weight: bold;">Permission</th>
               <th class="TableStyle-standard-HeadD-Column1-Header1"
                   style="font-weight: bold;">Allows Okta to</th>
            </tr>
         </thead>
         <tbody>
            <tr class="TableStyle-standard-Body-Body1">
               <td class="TableStyle-standard-BodyF-Column1-Body1">
                  <p>
                     <span class="code">User.ReadWrite.All</span>
                  </p>
               </td>
               <td class="TableStyle-standard-BodyD-Column1-Body1">create, read, update, and delete users.</td>
            </tr>
            <tr class="TableStyle-standard-Body-Body2">
               <td class="TableStyle-standard-BodyF-Column1-Body2">
                  <p>
                     <span class="code">Group.ReadWrite.All</span>
                  </p>
               </td>
               <td class="TableStyle-standard-BodyD-Column1-Body2">create, read, update, and delete groups.</td>
            </tr>
            <tr class="TableStyle-standard-Body-Body1">
               <td class="TableStyle-standard-BodyF-Column1-Body1">
                  <p>
                     <span class="code">GroupMember.ReadWrite.All</span>
                  </p>
               </td>
               <td class="TableStyle-standard-BodyD-Column1-Body1">add or remove members in a group.</td>
            </tr>
            <tr class="TableStyle-standard-Body-Body2">
               <td class="TableStyle-standard-BodyF-Column1-Body2">
                  <p>
                     <span class="code">Organization.Read.All</span>
                  </p>
               </td>
               <td class="TableStyle-standard-BodyD-Column1-Body2">list acquired licenses and remaining seats in a tenant.</td>
            </tr>
            <tr class="TableStyle-standard-Body-Body1">
               <td class="TableStyle-standard-BodyF-Column1-Body1">
                  <p>
                     <span class="code">Application.Read.All</span>
                  </p>
               </td>
               <td class="TableStyle-standard-BodyD-Column1-Body1"> list the application registrations and service principals in a tenant.</td>
            </tr>
            <tr class="TableStyle-standard-Body-Body2">
               <td class="TableStyle-standard-BodyC-Column1-Body2">
                  <p>
                     <span class="code">RoleManagement.ReadWrite.Directory</span>
                  </p>
               </td>
               <td class="TableStyle-standard-BodyA-Column1-Body2">assign directory roles to users, groups, and service principals.</td>
            </tr>
         </tbody>
      </table>
      <h2>Provide Microsoft admin consent for Okta</h2>
      <p>You can provide admin consent in two ways:</p>
      <ul>
         <li>
            <MadCap:xref href="#Provide">Provide Microsoft admin consent for provisioning</MadCap:xref>
         </li>
         <li>
            <MadCap:xref href="#Provide2">Provide Microsoft admin consent for single sign on</MadCap:xref>
         </li>
      </ul>
      <div>
         <h3>
            <a name="Provide"/>Provide Microsoft admin consent for provisioning</h3>
         <div class="noteOkta">
            <p class="noteContent">
               <span>For provisioning to continue functioning from Okta to Office 365, an Office 365 Service Principal Account with persistent Global Admin permissions must be associated with each Office 365 application in Okta.</span>
            </p>
         </div>
         <p>If you're enabling provisioning for the Office 365 app for the first time, follow these steps:</p>
         <ol style="list-style-type: upper-alpha;">
            <li>In Okta,<ol>
                  <li>Go to <span class="menucascade">
                        <span class="uicontrol">Applications</span>
                        <span class="uicontrol">Office 365</span>
                        <span class="uicontrol">Provisioning</span>
                        <span class="uicontrol">Integration</span>
                     </span>.</li>
                  <li>Select the <span class="uicontrol">Enable API integration</span> check box.</li>
                  <li>Enter Admin Username and Admin Password.</li>
                  <li>
                     <p>Click <span class="uicontrol">Authenticate with Microsoft Office 365</span>.</p>
                     <p>You are redirected to the <span class="wintitle">Microsoft account log in</span> page.</p>
                  </li>
               </ol>
            </li>
            <li>On Microsoft,<ol>
                  <li>Log into Microsoft as a Global Administrator for your Microsoft tenant.</li>
                  <li>Read  and accept the instructions listed on the <span class="wintitle">Okta Microsoft Graph Client</span> page.</li>
               </ol>
            </li>
            <li>In Okta,<ol>
                  <li>Save the settings.</li>
               </ol>
            </li>
         </ol>
      </div>
      <div>
         <h4>Re-authenticate Microsoft admin consent for provisioning</h4>
         <div class="noteOkta">
            <p class="noteContent">If your org enabled provisioning to Microsoft prior to December 2021, you must grant admin consent  before you can modify any existing Provisioning settings for Office 365. This is true even if you previously granted admin consent, because the permissions that Okta requests have changed.
				</p>
         </div>
         <p>If you've already enabled provisioning for the Office 365 app and need to re-authenticate your consent, follow these steps:</p>
         <ol style="list-style-type: upper-alpha;">
            <li>In Okta,<ol>
                  <li>Go to <span class="menucascade">
                        <span class="uicontrol">Applications</span>
                        <span class="uicontrol">Office 365</span>
                        <span class="uicontrol">Provisioning</span>
                        <span class="uicontrol">Integration</span>
                        <span class="uicontrol">Edit</span>
                     </span>.</li>
                  <li>
                     <p>Click <span class="uicontrol">Re-authenticate with Microsoft Office 365</span>.</p>
                     <p>You are redirected to the <span class="wintitle">Microsoft account log in</span> page.</p>
                  </li>
               </ol>
            </li>
            <li>On Microsoft,<ol>
                  <li>Log into Microsoft as a Global Administrator for your Microsoft tenant.</li>
                  <li>Read  and accept the instructions listed on the <span class="wintitle">Okta Microsoft Graph Client</span> page.</li>
               </ol>
            </li>
            <li>In Okta,<ol>
                  <li>Save the settings.</li>
               </ol>
            </li>
         </ol>
      </div>
      <div>
         <h3>
            <a name="Provide2"/>Provide Microsoft admin consent for single sign on</h3>
         <ol style="list-style-type: upper-alpha;">
            <li>In Okta,<ol>
                  <li>Go to <span class="menucascade">
                        <span class="uicontrol">Applications</span>
                        <span class="uicontrol">Office 365</span>
                        <span class="uicontrol">Sign On</span>
                        <span class="uicontrol">Edit</span>
                     </span>.</li>
                  <li>In the <span class="uicontrol">API Credentials</span> section, check the box for <span class="uicontrol">Allow administrator to consent for Advanced API access</span>.</li>
                  <li>
                     <p>Click <span class="uicontrol">Authenticate with Microsoft Office 365</span>.</p>
                     <p>You are redirected to the <span class="wintitle">Microsoft account log in</span> page.</p>
                  </li>
               </ol>
            </li>
            <li>On Microsoft,<ol>
                  <li>Log into Microsoft as a Global Administrator for your Microsoft tenant.</li>
                  <li>Read  and accept the instructions listed on the <span class="wintitle">Okta Microsoft Graph Client</span> page.</li>
               </ol>
            </li>
            <li>In Okta,<ol>
                  <li>Save the settings.</li>
               </ol>
            </li>
         </ol>
      </div>
      <div>
         <h4>Re-authenticate Microsoft admin consent for single sign on</h4>
         <p>You need to re-authenticate the existing Microsoft admin consent for Okta in following cases:</p>
         <ul>
            <li>If you add a new Office 365 app  to the Okta end-user dashboard and that app requires OAuth.</li>
            <li>If the URL for an Office 365 app  changes.</li>
         </ul>
         <ol style="list-style-type: upper-alpha;">
            <li>In Okta,<ol>
                  <li>Go to <span class="menucascade">
                        <span class="uicontrol">Applications</span>
                        <span class="uicontrol">Office 365</span>
                        <span class="uicontrol">Sign On</span>
                        <span class="uicontrol">Edit</span>
                     </span>.</li>
                  <li>
                     <p>In the <span class="uicontrol">API Credentials</span> section, click <span class="uicontrol">Re-authenticate with Microsoft Office 365</span>.</p>
                     <p>You are redirected to the <span class="wintitle">Microsoft account log in</span> page.</p>
                  </li>
               </ol>
            </li>
            <li>On Microsoft,<ol>
                  <li>Log into Microsoft as a Global Administrator for your Microsoft tenant.</li>
                  <li>Read  and accept the instructions listed on the <span class="wintitle">Okta Microsoft Graph Client</span> page.</li>
               </ol>
            </li>
            <li>In Okta,<ol>
                  <li>Save the settings.</li>
               </ol>
            </li>
         </ol>
      </div>
      <h2>Related topics</h2>
      <ul>
         <li>
            <p MadCap:conditions="MultiProdPublish.OIE">
               <MadCap:xref href="Office365/o365-prov-main.htm">Get started with Office 365 provisioning and deprovisioning</MadCap:xref>
            </p>
         </li>
         <li>
            <p MadCap:conditions="MultiProdPublish.OIE">
               <MadCap:xref href="Office365/o365-sign-on-policies-main.htm">Get started with Office 365 sign on policies</MadCap:xref>
            </p>
         </li>
         <li>
            <p MadCap:conditions="MultiProdPublish.Classic">
               <MadCap:xref href="Apps_Okta_Enhancements_Office_365_Integration.htm">Get started with Office 365 provisioning and deprovisioning</MadCap:xref>
            </p>
         </li>
         <li>
            <p MadCap:conditions="MultiProdPublish.Classic">
               <MadCap:xref href="../Security/O365_Client-Access-Policies.htm">Get started with Office 365 sign on policies</MadCap:xref>
            </p>
         </li>
      </ul>
   </body>
</html>
