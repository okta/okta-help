<?xml version="1.0" encoding="utf-8"?>
<html MadCap:onlyLocalStylesheets="False" MadCap:fileTags="Tags/okta-authors.Patrick Calnan" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="MultiProdPublish.Classic+OIE">
    <head><title>[%=Heading.Level1%] | Okta</title>
        <meta name="description" content="Enable MFA for Windows server RDP authentication attempts using Okta’s Credential Provider for Windows." />
    </head>
    <body>
        <h1>Troubleshooting</h1>
        <h3>Incorrect CORS installation</h3>
        <p>Cause: There was an error sending the request when logging into ADFS.</p>
        <p>
            <img src="../../Resources/Images/okta-adfs33.png" />
        </p>
        <p>Solution: Ensure you have enabled CORS in your Okta org.</p>
        <h3>Incorrect Farm installation</h3>
        <p>Cause: During installation you encounter <span class="code">error 1001 PS0033  “cmdlet cannot be executed from a secondary server in a local database farm</span>.</p>
        <p>Solution: If you encounter this error closely follow the instructions in the <a href="adfs-okta-int-farm.htm">Farm Installation addendum</a>, especially the steps that discuss WID (windows internal database) and promoting each server to be primary.</p>
        <p>
            <img src="../../Resources/Images/okta-adfs34.png" />
        </p>
        <h3>Incompatible proxy </h3>
        <p>Cause: During login, after MFA, users received messagde <span class="code">unable to connect</span>. </p>
        <p>The ADFS plugin can use a proxy to interact with Okta. By default the the ADFS&#160;agent uses the WinHTTP proxy. Some customers may be using the IE proxy.</p>
        <p>Solution: Ensure that the ADFS&#160;plugin is using the correct proxy:</p>
        <ol style="list-style-type: lower-alpha;">
            <li>Open a command prompt window.</li>
            <li>Execute the <span class="code">netsh winhttp show proxy</span> command. </li>
            <li>Examine the result of the command which will be one of: <span class="msgblock">no proxy</span>, <span class="msgblock">winhttp</span> or <span class="msgblock">ie</span>.</li>
            <li>For customers using IE, specify IE as proxy source using a command similar to: <span class="code">netsh winhttp import proxy source=ie</span></li>
            <li>Also ensure that the <span class="code">https://&lt;yourorg&gt;.okta&lt;preview&gt;.com</span> is not blocked by company firewalls.</li>
        </ol>
        <p>The following are errors which occur under both MFA as a service, and Open ID Connect (OIDC). Effectively these are the same error but differ in how they are reported.</p>
        <h3>Assigned user is deactivated in Okta</h3>
        <p>Cause: Error messages when the assigned user is deactivated in OKTA:</p>
        <p>
            <ul>
                <li><span class="code">OIDC: Failed to authenticate. Error: access_denied - 'login_hint' did not match a user assigned to the client ADFS&#160;app.</span>
                </li>
                <li>MFA as Service: <span class="code">General failure: The remote server returned an error: (404) Not Found.</span></li>
            </ul>
        </p>
        <h3>Assigned user is suspended in Okta</h3>
        <p>Cause: Error messages when the assigned user is suspended in OKTA:</p>
        <p>
            <ul>
                <li>OIDC: <span class="code">Failed to authenticate. Error: access_denied - 'login_hint' did not match a user assigned to the client ADFS app.</span></li>
                <li>MFA as Service: <span class="code">General failure: The remote server returned an error: (401) not authorized.</span></li>
            </ul>
        </p>
        <h3>Same custom name is set to two assigned users</h3>
        <p>Cause: Error messages when the same custom name is set to two assigned users on the client ADFS app:</p>
        <p>
            <ul>
                <li>OIDC:&#160;<span class="code">HTTP 500: Internal Server Error.</span></li>
                <li>MFA as Service: <span class="code">General failure: The remote server returned an error: (401) Unauthorized</span>.</li>
            </ul>
        </p>
        <h3>Deny app Sign-on Policy</h3>
        <p>Cause: Error messages when there is a Deny App Sign-on policy:</p>
        <p>
            <ul>
                <li>OIDC: <span class="code">Failed to authenticate. Error: access_denied - The MFA attestation request was denied by policy.</span></li>
                <li>MFA as Service: <span class="code">General failure: The remote server returned an error: (403) Forbidden</span>.</li>
            </ul>
        </p>
    </body>
</html>