<?xml version="1.0" encoding="utf-8"?>
<html MadCap:onlyLocalStylesheets="False" MadCap:searchable="True" MadCap:fileTags="Tags/okta-authors.Patrick Calnan" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="MultiProdPublish.Classic+OIE">
    <head><title>[%=Heading.Level1%] | Okta</title>
        <link href="" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>Test the Sophos UTM&#160;integration</h1>
        <div>
            <p>To test the integration using the Sophos web portal. </p>
            <h3>Topics</h3>
            <ul>
                <li>
                    <MadCap:xref href="#Flow">Flow diagrams</MadCap:xref>
                </li>
                <li>
                    <MadCap:xref href="#Test">Test with the Web Portal</MadCap:xref>
                </li>
            </ul>
            <h2><a name="Flow"></a>Flow diagrams</h2>
            <p>The following network diagram shows the configuration flows.</p>
            <p>
                <img src="../../Resources/Images/sophos_15.png" />
            </p>
            <p>The detailed web sequence is listed below and shown in this <a href="../../Resources/Images/f5_17.png" target="_blank">diagram</a>.</p>
            <ol>
                <li>User Logs in with Username/Password</li>
                <li>Gateway receives data and forwards via Radius to Okta RADIUS Server Agent</li>
                <li>Okta RADIUS Server Agent sends to Okta Identity Cloud</li>
                <li>Okta Identify Cloud Determines the Authentication source and responds or optionally forwards to on-prem directory agent</li>
                <li>Optional: Directory Agent sends Password to Directory</li>
                <li>Optional: Directory Confirms the password</li>
                <li>Optional: Directory Agent Confirms the password to Okta Identity Cloud</li>
                <li>Okta Identity Cloud evaluates the authentication policy and as required sends a message to the Okta RADIUS Server Agent to challenge the user for a factor</li>
                <li>The Okta RADIUS Server Agent relays the challenge message to the Gateway</li>
                <li>The Gateway displays a message to select a factor to the user</li>
                <li>User supplies the desired factor</li>
                <li>Gateway receives data and forwards via Radius to Okta RADIUS Server Agent</li>
                <li>Okta RADIUS Server Agent sends to Okta Identity Cloud</li>
                <li>Okta Identify Cloud evaluates the Choice and triggers the appropriate response (push message shown)</li>
                <li>Push message is received and Responded to by the user</li>
                <li>Success Message returned to the Okta RADIUS Server Agent</li>
                <li>Success Message returned to the gateway</li>
                <li>Connected</li>
            </ol>
            <h2><a name="Test"></a>Test with the Web Portal</h2>
            <ol>
                <li>
                    <p>Open the Sophos User Portal.</p>
                    <p>
                        <img src="../../Resources/Images/sophos_11.png" />
                    </p>
                </li>
                <li>
                    <p>Enter your username.</p>
                    <p>Note: The username must be in the format you specified when you added the app in Okta in Part 2, above.</p>
                </li>
                <li>
                    <p>Enter your password concatenated with your OTP value or keyword. Use the following examples for format:</p>
                    <ul>
                        <li>Password1,123456</li>
                        <li>Password1,push</li>
                        <li>Password1,sms</li>
                    </ul>
                    <p>Note: The Sophos UTM appliance does not support a RADIUS challenge message. Credential concatenation is required. </p>
                </li>
                <li>
                    <p>If any of the information is incorrect, the following screen displays.</p>
                    <p>
                        <img src="../../Resources/Images/sophos_12.png" />
                    </p>
                </li>
                <li>
                    <p>If you connected successfully, the following screen displays.</p>
                    <p>
                        <img src="../../Resources/Images/sophos_14.png" />
                    </p>
                </li>
            </ol>
        </div>
    </body>
</html>