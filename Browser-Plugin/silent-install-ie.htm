<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:conditions="MultiProdPublish.Classic+OIE"
      MadCap:fileTags="Tags/okta-authors.Robert Milkovich">
   <head>
      <title>[%=Heading.Level1%] | Okta</title>
      <link href="../../Resources/TableStyles/standard.css"
            rel="stylesheet"
            MadCap:stylesheetType="table"/>
      <meta name="description"
            content="Admins can create or modify policies to silently install the Okta Browser Plugin for your users on Internet Explorer."/>
   </head>
   <body>
      <h1>Silently install <MadCap:variable name="okta-feature-names.Okta Browser Plugin"/> on <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/>
      </h1>
      <p MadCap:conditions="Primary.review-only">
         <span class="wintitle">DOC notes</span>: Keeping this page as a courtesy until IE usage further dwindles over the coming months.</p>
      <div class="noteOkta">
         <p class="noteContent">Okta  no longer supports IE. Okta recommends that customers delete the IE plugin installer and use a  <a href="plugin-browser-os.htm">supported browser</a>.</p>
      </div>
      <p>You have several installation options when installing the <MadCap:variable name="okta-feature-names.Okta Browser Plugin"/>. Use the following chart to choose the best option for your environment.</p>
      <table border="1"
             cellpadding="5"
             cellspacing="0"
             style="height: 152px;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/standard.css');"
             class="TableStyle-standard">
         <col class="TableStyle-standard-Column-Column1"/>
         <col class="TableStyle-standard-Column-Column1"/>
         <col class="TableStyle-standard-Column-Column1"/>
         <col class="TableStyle-standard-Column-Column1"/>
         <thead>
            <tr class="TableStyle-standard-Head-Header1">
               <th class="TableStyle-standard-HeadF-Column1-Header1"
                   style="text-align: left;">Installation options</th>
               <th class="TableStyle-standard-HeadF-Column1-Header1"
                   style="text-align: left;">Requires end-user interaction?</th>
               <th class="TableStyle-standard-HeadF-Column1-Header1"
                   style="text-align: left;">'Choose Add-ons' button appears?</th>
               <th class="TableStyle-standard-HeadD-Column1-Header1"
                   style="text-align: left;">Number of browser restarts</th>
            </tr>
         </thead>
         <tbody>
            <tr class="TableStyle-standard-Body-Body1" MadCap:conditions="">
               <td class="TableStyle-standard-BodyF-Column1-Body1">Classic installation</td>
               <td class="TableStyle-standard-BodyF-Column1-Body1"
                   style="text-align: center;">Yes</td>
               <td align="center" class="TableStyle-standard-BodyF-Column1-Body1">Yes</td>
               <td align="center" class="TableStyle-standard-BodyD-Column1-Body1">2</td>
            </tr>
            <tr class="TableStyle-standard-Body-Body2" MadCap:conditions="">
               <td class="TableStyle-standard-BodyF-Column1-Body2">Classic with allow listing</td>
               <td class="TableStyle-standard-BodyF-Column1-Body2"
                   style="text-align: center;">Yes</td>
               <td align="center" class="TableStyle-standard-BodyF-Column1-Body2">No</td>
               <td align="center" class="TableStyle-standard-BodyD-Column1-Body2">1</td>
            </tr>
            <tr class="TableStyle-standard-Body-Body1" MadCap:conditions="">
               <td class="TableStyle-standard-BodyF-Column1-Body1">Silent mode without allow listing</td>
               <td align="center"
                   class="TableStyle-standard-BodyF-Column1-Body1"
                   style="text-align: left;">
                  <p style="text-align: center;">No</p>
               </td>
               <td align="center" class="TableStyle-standard-BodyF-Column1-Body1">Yes</td>
               <td align="center" class="TableStyle-standard-BodyD-Column1-Body1">2</td>
            </tr>
            <tr class="TableStyle-standard-Body-Body2" MadCap:conditions="">
               <td class="TableStyle-standard-BodyC-Column1-Body2">Silent mode with allow listing</td>
               <td class="TableStyle-standard-BodyC-Column1-Body2"
                   style="text-align: center;">No</td>
               <td align="center" class="TableStyle-standard-BodyC-Column1-Body2">No</td>
               <td align="center" class="TableStyle-standard-BodyA-Column1-Body2">1</td>
            </tr>
         </tbody>
      </table>
      <h2>Task 1: Enable Silent Mode</h2>
      <ol>
         <li>
            <MadCap:snippetText src="../../Resources/Snippets/task steps/Settings_Downloads.flsnp"/>
         </li>
         <li>Download the <span class="uicontrol">.msi</span> or <span class="uicontrol">.exe</span> version of the plugin for <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/>.</li>
         <li>To run the installer in silent mode on <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/>, use the following command-line parameters:
			<p>
               <span class="codeblock" xml:space="preserve">okta.swa.ie-x.x.x.exe /q 
okta.swa.ie-x.x.x.msi /q
</span>
            </p>
            <p>Replace   <span class="code">x.x.x</span> with the version number of the installer.</p>
            <h3>Limitations</h3>
            <ul>
               <li>You must add your installation to your allowlist so that user interaction isn’t required.</li>
               <li>If you run either installer as a local administrator in the user space, then the next time end users open the browser, they’re prompted to enable add-ons. After installation, a browser launches and prompts the user  to click <span class="uicontrol">Choose add-ons</span>.</li>
               <li>If you don’t run the installer as a local administrator in the user space and the user has <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/> open, the installer fails to close the browser, and the installation fails.</li>
            </ul>
         </li>
         <li>
            <p>Use the following batch file to force all running instances of <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/> on the machine to close and then run the silent installation of the browser plugin:</p>
            <p>
               <span class="codeblock" xml:space="preserve">c:\windows\system32\Taskkill /IM iexplore.exe /F
c:\windows\system32\msiexec.exe /i %LMI_PACKAGEROOT%\okta.swa.ie-x.x.x.msi /q
echo %ERRORLEVEL%
</span>
            </p>
            <p>This can be especially helpful if you're using <span class="uicontrol">LogMeIn</span> without administrator rights to install the plugin. If you attempt to use the commands natively instead of using the batch file, the <span class="uicontrol">Taskkill</span> command returns a 123 and causes <span class="uicontrol">LogMeIn</span> to abort.</p>
            <p>If you're installing in silent mode on Windows 7, users are prompted to restart their browsers.</p>
         </li>
      </ol>
      <h2>Task 2: Configure Allowlist</h2>
      <p>Configure an allowlist to suppress the appearance of the <span class="uicontrol">Choose add-ons</span> button during the plugin installation. This prevents end users from interfering with the installation.</p>
      <p>On Windows, <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/> uses a <span class="varname">CLSID</span> (class identifier) to set the allowlist policy. To set this policy on your system:</p>
      <ol>
         <li>Close <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/>.</li>
         <li>Open the <span class="uicontrol">Local Group Policy Editor</span>.</li>
         <li>Go to <span class="uicontrol">Start</span>, type <span class="code">gpedit.msc</span> in the search field, and then click <span class="uicontrol">Edit Group Policy</span>.</li>
         <li>Go to the appropriate path for your version of <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/>:<ul>
               <li>
                  <p>
                     <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/> 10: <span class="menucascade">
                        <span class="uicontrol">User Configuration</span>
                        <span class="uicontrol">Administrative Templates</span>
                        <span class="uicontrol">Windows Components</span>
                        <span class="uicontrol">Internet Explorer</span>
                        <span class="uicontrol">Security Features</span>
                        <span class="uicontrol">Add-on Management</span>
                     </span>
                  </p>
               </li>
               <li>
                  <p>
                     <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/> 11: <span class="menucascade">
                        <span class="uicontrol">Computer Configuration</span>
                        <span class="uicontrol">Administrative Templates</span>
                        <span class="uicontrol">Windows Components</span>
                        <span class="uicontrol">Internet Explorer</span>
                        <span class="uicontrol">Security Features</span>
                        <span class="uicontrol">Add-on Management</span>
                     </span>
                  </p>
               </li>
            </ul>
         </li>
      </ol>
      <ol MadCap:continue="true">
         <li>Double-click <span class="uicontrol">Add-on List</span>.</li>
         <li>Click <span class="uicontrol">Show...</span> under <span class="uicontrol">Options</span>.</li>
         <li>In the <span class="uicontrol">Show Contents</span> window, add each of the following Class ID values under <span class="uicontrol">Value Name</span> (including the brackets):
				<table border="1"
                   cellpadding="5"
                   cellspacing="0"
                   style="height: 152px;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/standard.css');"
                   class="TableStyle-standard">
               <col class="TableStyle-standard-Column-Column1"/>
               <col class="TableStyle-standard-Column-Column1"/>
               <col class="TableStyle-standard-Column-Column1"/>
               <thead>
                  <tr class="TableStyle-standard-Head-Header1">
                     <th class="TableStyle-standard-HeadF-Column1-Header1"
                         style="text-align: left;">Class ID</th>
                     <th class="TableStyle-standard-HeadF-Column1-Header1"
                         style="text-align: left;">Value name</th>
                     <th class="TableStyle-standard-HeadD-Column1-Header1"
                         style="text-align: left;">Value</th>
                  </tr>
               </thead>
               <tbody>
                  <tr class="TableStyle-standard-Body-Body1" MadCap:conditions="">
                     <td class="TableStyle-standard-BodyF-Column1-Body1">
                        <span class="varname">OktaBHO Class</span>
                     </td>
                     <td class="TableStyle-standard-BodyF-Column1-Body1"
                         style="text-align: center;">
                        <span class="codeblock">{E411779C-5CFE-413F-A57B-18C55A4EFADA}</span>
                     </td>
                     <td align="center" class="TableStyle-standard-BodyD-Column1-Body1">1</td>
                  </tr>
                  <tr class="TableStyle-standard-Body-Body2" MadCap:conditions="">
                     <td class="TableStyle-standard-BodyF-Column1-Body2">
                        <span class="varname">OktaIeHelper Class</span>
                     </td>
                     <td class="TableStyle-standard-BodyF-Column1-Body2"
                         style="text-align: center;">
                        <span class="codeblock" xml:space="preserve">{302700E7-59EF-49EC-9439-EA590552D1ED}</span>
                     </td>
                     <td align="center" class="TableStyle-standard-BodyD-Column1-Body2">1</td>
                  </tr>
                  <tr class="TableStyle-standard-Body-Body1" MadCap:conditions="">
                     <td class="TableStyle-standard-BodyC-Column1-Body1">
                        <span class="varname">Okta Toolbar Extension</span>
                     </td>
                     <td align="center"
                         class="TableStyle-standard-BodyC-Column1-Body1"
                         style="text-align: left;">
                        <span class="codeblock">{8C938A58-9A96-4A95-929D-C8C28C639C32}</span>
                     </td>
                     <td align="center" class="TableStyle-standard-BodyA-Column1-Body1">1</td>
                  </tr>
               </tbody>
            </table>
            <p>Add <span class="varname">OktaIeHelper Class</span> ID only if you're running <MadCap:variable name="okta-variables.ProductName"/> plugin version 5.3.2 or earlier.</p>
            <p>The BHO (browser helper object) is an <MadCap:variable name="3rd Party Integrations.MSFT-IE-short"/> plugin module that provides added functionality to the browser. <span class="varname">OktaBHO</span>, <span class="varname">OktaIeHelper</span>, and <span class="varname">Okta Toolbar Extension</span> are other types of BHO and are also customized by <MadCap:variable name="okta-variables.ProductName"/>.</p>
            <p>
               <img alt="rawAddonList.jpg"
                    src="../../Resources/Images/plugin2.jpeg"
                    style="background-color: #efefef;"/>
            </p>
         </li>
      </ol>
      <ol MadCap:continue="true">
         <li>Deploy this policy to your target machines.</li>
      </ol>
      <p>After you complete this task, <MadCap:variable name="okta-variables.ProductName"/> doesn't prompt your end users to enable or disable the plugin installation during the silent installation.</p>
   </body>
</html>
