<?xml version="1.0" encoding="utf-8"?>
<html MadCap:onlyLocalStylesheets="False" MadCap:searchable="True" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Primary.deprecated" MadCap:fileTags="Tags/okta-authors.Patrick Calnan">
    <head>
        <link rel="canonical" href="https://help.okta.com/oag/en-us/Content/Topics/Access-Gateway/ref-arch-seq.htm" />
        <link href="../../Resources/TableStyles/standard-shaded-rows.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>[%=Heading.Level1%] | Okta</title>
        <link href="" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1><MadCap:variable name="okta-feature-names.Access Gateway" /> sequence flows</h1>
        <p>Requests are routed through Okta, <MadCap:variable name="okta-feature-names.Access Gateway" /> and customer applications in a given order, creating a variety of artifacts such as Okta, <MadCap:variable name="okta-feature-names.Access Gateway" /> and application session. &#160;The following diagrams represent the most common sequence flows as well as an overview of service provider and identify provider flows</p>
        <h2><a name="Sequence"></a>Sequence diagrams</h2>
        <table style="mc-table-style: url('../../Resources/TableStyles/standard-shaded-rows.css');" class="TableStyle-srb_header_alt_shade" cellspacing="0">
            <col class="TableStyle-srb_header_alt_shade-Column-Column1" />
            <col class="TableStyle-srb_header_alt_shade-Column-Column1" />
            <thead>
                <tr class="TableStyle-srb_header_alt_shade-Head-Header1">
                    <th class="TableStyle-srb_header_alt_shade-HeadF-Column1-Header1">Sequence</th>
                    <th class="TableStyle-srb_header_alt_shade-HeadD-Column1-Header1">Description</th>
                </tr>
            </thead>
            <tbody>
                <tr class="TableStyle-srb_header_alt_shade-Body-Body1">
                    <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1">Not protected<br />No session</td>
                    <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1">Describes the sequence of activities which occur when a user attempts to access a non-protected web resource, in a known application, where no existing <MadCap:variable name="okta-feature-names.Access Gateway" /> session exists</td>
                </tr>
                <tr class="TableStyle-srb_header_alt_shade-Body-Body2">
                    <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2">Not protected<br />With session</td>
                    <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2">Describes the sequence of activities which occur when a user attempts to access a non-protected web resource, in a known application, where an existing <MadCap:variable name="okta-feature-names.Access Gateway" /> already session exists.</td>
                </tr>
                <tr class="TableStyle-srb_header_alt_shade-Body-Body1">
                    <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1">Protected<br />No session</td>
                    <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1">Describes the sequence of activities which occur when a user attempts to access a protected web resource, in a known application, where no existing <MadCap:variable name="okta-feature-names.Access Gateway" /> session exists.</td>
                </tr>
                <tr class="TableStyle-srb_header_alt_shade-Body-Body2">
                    <td class="TableStyle-srb_header_alt_shade-BodyC-Column1-Body2">Protected<br />With session</td>
                    <td class="TableStyle-srb_header_alt_shade-BodyA-Column1-Body2">Describes the sequence of activities which occur when a user attempts to access a protected web resource, in a known application, where an existing <MadCap:variable name="okta-feature-names.Access Gateway" /> session already exists.</td>
                </tr>
            </tbody>
        </table>
        <ul class="tabs" data-tabs="data-tabs" data-deep-link="true" id="oag-ref-arch-seq">
            <li class="tabs-title is-active"><a href="#tab1" aria-selected="true">Not protected, no session</a>
            </li>
            <li class="tabs-title"><a href="#tab2">Not protected, with session</a>
            </li>
            <li class="tabs-title"><a href="#tab3">Protected, no session</a>
            </li>
            <li class="tabs-title"><a href="#tab4">Protected, with session</a>
            </li>
        </ul>
        <div class="tabs-content" data-tabs-content="oag-ref-arch-seq">
            <div class="tabs-panel is-active" id="tab1">
                <div style="background-color: #f7f7f7;">
                    <p>The not protected resource, with no session sequence is common with Customer identity access management (CIAM) applications. This sequence represents a request for a non-protected, or public, resource where no existing <MadCap:variable name="okta-feature-names.Access Gateway" /> session exists.<br /></p>
                    <h3>Diagram</h3>
                    <img src="../../Resources/Images/access-gateway/ref-arch-not-prot-no-sess.png" id="img_new" />
                    <h3>Events</h3>
                    <table style="mc-table-style: url('../../Resources/TableStyles/standard-shaded-rows.css');" class="TableStyle-srb_header_alt_shade" cellspacing="0">
                        <col class="TableStyle-srb_header_alt_shade-Column-Column1" />
                        <col class="TableStyle-srb_header_alt_shade-Column-Column1" />
                        <thead>
                            <tr class="TableStyle-srb_header_alt_shade-Head-Header1">
                                <th class="TableStyle-srb_header_alt_shade-HeadF-Column1-Header1">Step</th>
                                <th class="TableStyle-srb_header_alt_shade-HeadD-Column1-Header1">
                                    <p>Description</p>
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="TableStyle-srb_header_alt_shade-Body-Body1">
                                <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">1</td>
                                <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1">
                                    <p>User signs into Okta.</p>
                                </td>
                            </tr>
                            <tr class="TableStyle-srb_header_alt_shade-Body-Body2">
                                <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;">2</td>
                                <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2">
                                    <p><MadCap:variable name="okta-feature-names.Access Gateway" /> checks for session, no session exists.</p>
                                </td>
                            </tr>
                            <tr class="TableStyle-srb_header_alt_shade-Body-Body1">
                                <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">3</td>
                                <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1">
                                    <p><MadCap:variable name="okta-feature-names.Access Gateway" /> checks if resource is protected.</p>
                                </td>
                            </tr>
                            <tr class="TableStyle-srb_header_alt_shade-Body-Body2">
                                <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;">4</td>
                                <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2">
                                    <p><MadCap:variable name="okta-feature-names.Access Gateway" /> forwards required to application. <br />Note that since there is no session no headers can be provided on forward.</p>
                                </td>
                            </tr>
                            <tr class="TableStyle-srb_header_alt_shade-Body-Body1">
                                <td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">5</td>
                                <td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1">
                                    <p>Application returns response to <MadCap:variable name="okta-feature-names.Access Gateway" />.</p>
                                </td>
                            </tr>
                            <tr class="TableStyle-srb_header_alt_shade-Body-Body2">
                                <td class="TableStyle-srb_header_alt_shade-BodyC-Column1-Body2" style="text-align: center;font-weight: bold;">
                                    <p style="text-align: center;font-weight: bold;">&#160;</p>
                                </td>
                                <td class="TableStyle-srb_header_alt_shade-BodyA-Column1-Body2">
                                    <p><MadCap:variable name="okta-feature-names.Access Gateway" /> redirects response to User.</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div> <!-- end tab 1 --><div class="tabs-panel" id="tab2"><div style="background-color: #f7f7f7;"><p>The not protected resource, with session represents a request for a non-protected, or public, resource where a <MadCap:variable name="okta-feature-names.Access Gateway" /> session already exists.<br /></p><h3>Diagram</h3><img src="../../Resources/Images/access-gateway/ref-arch-not-prot-w-sess.png" id="img_new" /><h3>Events</h3><table style="mc-table-style: url('../../Resources/TableStyles/standard-shaded-rows.css');" class="TableStyle-srb_header_alt_shade" cellspacing="0"><col class="TableStyle-srb_header_alt_shade-Column-Column1" /><col class="TableStyle-srb_header_alt_shade-Column-Column1" /><thead><tr class="TableStyle-srb_header_alt_shade-Head-Header1"><th class="TableStyle-srb_header_alt_shade-HeadF-Column1-Header1">Step</th><th class="TableStyle-srb_header_alt_shade-HeadD-Column1-Header1"><p>Description</p></th></tr></thead><tbody><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">1</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p>User signs into Okta.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;">2</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> checks for session, uses existing session. </p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">3</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> checks if resource is protected.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;">4</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> forwards required to application. <br />Since session exists headers are provided on forward.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">5</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p>Application returns response to <MadCap:variable name="okta-feature-names.Access Gateway" />.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyC-Column1-Body2" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">6</p></td><td class="TableStyle-srb_header_alt_shade-BodyA-Column1-Body2"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> redirects response to User.</p></td></tr></tbody></table></div></div> <!-- End tab 2--><div class="tabs-panel" id="tab3"><div style="background-color: #f7f7f7;"><p>The protected resource, without session represents a request for a standard protected resource where <MadCap:variable name="okta-feature-names.Access Gateway" /> and no session exists.<br /></p><h3>Diagram</h3><img src="../../Resources/Images/access-gateway/ref-arch-prot-no-sess.png" id="img_new" /><h3>Events</h3><table style="mc-table-style: url('../../Resources/TableStyles/standard-shaded-rows.css');" class="TableStyle-srb_header_alt_shade" cellspacing="0"><col class="TableStyle-srb_header_alt_shade-Column-Column1" /><col class="TableStyle-srb_header_alt_shade-Column-Column1" /><thead><tr class="TableStyle-srb_header_alt_shade-Head-Header1"><th class="TableStyle-srb_header_alt_shade-HeadF-Column1-Header1">Step</th><th class="TableStyle-srb_header_alt_shade-HeadD-Column1-Header1"><p>Description</p></th></tr></thead><tbody><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">1</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p>User signs into Okta.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;">2</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> checks for session.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">3</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> checks if resource is protected.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;">4</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> makes a SAML authentication request to the users browser.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">5</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p>Okta request login.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">6</p></td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p>User sends credentials and other MFA as required to Okta.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">7</p></td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p>Okta returns SAML assertion to browser.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">8</p></td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p>Browser forwards request with SAML assertion.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">9</p></td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> creates session for application.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">10</p></td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> evaluates request in the context of any associated policy</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">11</p></td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> forwards request with all defined headers to application.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">12</p></td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p>Application returns request to <MadCap:variable name="okta-feature-names.Access Gateway" />.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyC-Column1-Body1" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">13</p></td><td class="TableStyle-srb_header_alt_shade-BodyA-Column1-Body1"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> rewrites and returns response to User.</p></td></tr></tbody></table></div></div> <!-- End tab3 --><div class="tabs-panel" id="tab4"><div style="background-color: #f7f7f7;"><p>The protected resource, with session represents a request for a standard protected resource where an <MadCap:variable name="okta-feature-names.Access Gateway" /> session already exists.<br /></p><h3>Diagram</h3><img src="../../Resources/Images/access-gateway/ref-arch-prot-w-sess.png" id="img_new" /><h3>Events</h3><table style="mc-table-style: url('../../Resources/TableStyles/standard-shaded-rows.css');" class="TableStyle-srb_header_alt_shade" cellspacing="0"><col class="TableStyle-srb_header_alt_shade-Column-Column1" /><col class="TableStyle-srb_header_alt_shade-Column-Column1" /><thead><tr class="TableStyle-srb_header_alt_shade-Head-Header1"><th class="TableStyle-srb_header_alt_shade-HeadF-Column1-Header1">Step</th><th class="TableStyle-srb_header_alt_shade-HeadD-Column1-Header1"><p>Description</p></th></tr></thead><tbody><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">1</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p>User requests resource.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;">2</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> checks for session. <br />Session exists for requested application. </p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;">3</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> checks if resource is protected.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;">4</td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> evaluates timeouts and behaves as defined by <MadCap:xref href="application-advanced-session-timeouts.htm">Application session timeout interaction</MadCap:xref>.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">5</p></td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> evaluates request in the context of any associated policy</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body2" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">6</p></td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body2"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> forwards request with all defined headers to application.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body1"><td class="TableStyle-srb_header_alt_shade-BodyF-Column1-Body1" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">7</p></td><td class="TableStyle-srb_header_alt_shade-BodyD-Column1-Body1"><p>Application returns request to <MadCap:variable name="okta-feature-names.Access Gateway" />.</p></td></tr><tr class="TableStyle-srb_header_alt_shade-Body-Body2"><td class="TableStyle-srb_header_alt_shade-BodyC-Column1-Body2" style="text-align: center;font-weight: bold;"><p style="text-align: center;font-weight: bold;">8</p></td><td class="TableStyle-srb_header_alt_shade-BodyA-Column1-Body2"><p><MadCap:variable name="okta-feature-names.Access Gateway" /> rewrites and returns response to User.</p></td></tr></tbody></table></div></div> <!-- End tab4 --></div> <!-- End tabs-content div--><h2>Related topics</h2><p><MadCap:xref href="ref-architectures.htm">Reference architectures</MadCap:xref></p><p><MadCap:xref href="about-oag-dns.htm">About [%=okta-feature-names.Access Gateway%] DNS use</MadCap:xref></p><p><MadCap:xref href="about-high-availability.htm">About [%=okta-feature-names.Access Gateway%] high availability</MadCap:xref></p><p><a href="about-oag-prereqs.htm">About [%=okta-feature-names.Access Gateway%] prerequisites</a></p></body>
</html>