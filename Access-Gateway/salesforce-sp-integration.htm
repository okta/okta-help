<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Primary.do-not-publish" MadCap:fileTags="Tags/okta-authors.Patrick Calnan">
    <head>
        <link rel="canonical" href="https://help.okta.com/oag/en-us/Content/Topics/Access-Gateway/salesforce-sp-integration.htm" /> <title>[%=Heading.Level1%] | Okta</title></head>
    <body>
        <h2>Introduction</h2>
        <p>This Integration Guide will walk through the steps required to activate Salesforce as a Service Provider within Access Gateway.</p>
        <h2>Access Gateway IDP Setup</h2>
        <p>Follow these instructions to prepare your Access Gateway Instance for IDP Setup and Configuration.</p>
        <p> You must have an admin login for the Access Gateway Admin Console. You must have a properly configured Access Gateway instance. </p>
        <h2>Adding Local Auth Module</h2>
        <p>Once you verify that Access Gateway is up and functioning properly, begin by adding a Local Auth Module.</p>
        <ol>
            <li>
                <p>In <span class="wintitle">Settings</span> tab, select <span class="uicontrol">Auth Modules</span>.</p>
            </li>
            <li>
                <p>Click <span class="uicontrol">+</span> and select <span class="uicontrol">Local Auth</span> to add the module.</p>
            </li>
            <li>
                <p>Under the <span class="wintitle">Accounts</span> sub-heading, enter a <span class="uicontrol">User Name</span> and <span class="uicontrol">Password</span>.</p>
            </li>
            <li>
                <p>Under the <span class="wintitle">Attributes</span> section, enter the Salesforce user’s <span class="uicontrol">lastName</span> and <span class="uicontrol">email</span>.</p>
                <p>
                    <img src="../../Resources/Images/access-gateway/salesforce-sp-integration.03.png" alt="" style="mc-thumbnail: popup;mc-thumbnail-max-width: 250px;mc-thumbnail-max-height: auto;border-left-style: solid;border-left-width: 1px;border-left-color: #d3d3d3;border-right-style: solid;border-right-width: 1px;border-right-color: #d3d3d3;border-top-style: solid;border-top-width: 1px;border-top-color: #d3d3d3;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #d3d3d3;" />
                </p>
                <p>Click <span class="uicontrol">Okay</span>. </p>
                <p>Note: It can be helpful to add a description to help end users when logging in to the Auth Module.</p>
            </li>
            <li>
                <p>After creating the Local Auth Module, click the <span class="uicontrol">Investigator Icon</span> to simulate user access.</p>
                <p>
                    <img src="../../Resources/Images/access-gateway/salesforce-sp-integration.04.png" alt="" style="mc-thumbnail: popup;mc-thumbnail-max-width: 250px;mc-thumbnail-max-height: auto;border-left-style: solid;border-left-width: 1px;border-left-color: #d3d3d3;border-right-style: solid;border-right-width: 1px;border-right-color: #d3d3d3;border-top-style: solid;border-top-width: 1px;border-top-color: #d3d3d3;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #d3d3d3;" />
                </p>
            </li>
        </ol>
        <h2>Adding Local SAML IDP</h2>
        <ol>
            <li>
                <p>Navigate to the <span class="wintitle">Identity Providers</span> tab.</p>
            </li>
            <li>
                <p>Click the <span class="uicontrol">+</span> button and select <span class="uicontrol">Local SAML IDP</span>.</p>
                <p>
                    <img src="../../Resources/Images/access-gateway/salesforce-sp-integration.05.png" alt="" style="mc-thumbnail: popup;mc-thumbnail-max-width: 250px;mc-thumbnail-max-height: auto;border-left-style: solid;border-left-width: 1px;border-left-color: #d3d3d3;border-right-style: solid;border-right-width: 1px;border-right-color: #d3d3d3;border-top-style: solid;border-top-width: 1px;border-top-color: #d3d3d3;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #d3d3d3;" />
                </p>
            </li>
            <li>
                <p>Enter a <span class="uicontrol">Name</span>, <span class="uicontrol">host</span> and <span class="uicontrol">Cookie domain</span> for the for the Local SAML IDP. The cookie domain must include the host and the host must be unique to the environment.</p>
                <p>
                    <img src="../../Resources/Images/access-gateway/salesforce-sp-integration.06.png" alt="" style="mc-thumbnail: popup;mc-thumbnail-max-width: 250px;mc-thumbnail-max-height: auto;border-left-style: solid;border-left-width: 1px;border-left-color: #d3d3d3;border-right-style: solid;border-right-width: 1px;border-right-color: #d3d3d3;border-top-style: solid;border-top-width: 1px;border-top-color: #d3d3d3;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #d3d3d3;" />
                </p>
            </li>
            <li>
                <p>Select <span class="uicontrol">LOCAL</span> from the <span class="uicontrol">Default Auth Module</span> drop down.</p>
                <p>
                    <img src="../../Resources/Images/access-gateway/salesforce-sp-integration.07.png" alt="" style="mc-thumbnail: popup;mc-thumbnail-max-width: 250px;mc-thumbnail-max-height: auto;border-left-style: solid;border-left-width: 1px;border-left-color: #d3d3d3;border-right-style: solid;border-right-width: 1px;border-right-color: #d3d3d3;border-top-style: solid;border-top-width: 1px;border-top-color: #d3d3d3;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #d3d3d3;" />
                </p>
            </li>
            <li>
                <p>Select <span class="uicontrol">email</span> and <span class="uicontrol">Email Address</span> as the app attributes for the <span class="uicontrol">Name Attribute</span> and <span class="uicontrol">Name Attribute format</span> fields.</p>
                <p>
                    <img src="../../Resources/Images/access-gateway/salesforce-sp-integration.08.png" alt="" style="mc-thumbnail: popup;mc-thumbnail-max-width: 250px;mc-thumbnail-max-height: auto;border-left-style: solid;border-left-width: 1px;border-left-color: #d3d3d3;border-right-style: solid;border-right-width: 1px;border-right-color: #d3d3d3;border-top-style: solid;border-top-width: 1px;border-top-color: #d3d3d3;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #d3d3d3;" />
                </p>
            </li>
            <li>
                <p>Click <span class="uicontrol">Okay</span>.</p>
            </li>
        </ol>
        <h2>Setup Salesforce as Service Provider</h2>
        <h2>Salesforce Service Provider Initiated Setup</h2>
        <ol>
            <li>
                <p>Once you have configured the Local SAML IDP, click <span class="uicontrol">Download</span> to view the metadata.</p>
                <p>
                    <img src="../../Resources/Images/access-gateway/salesforce-sp-integration.09.png" alt="" style="mc-thumbnail: popup;mc-thumbnail-max-width: 250px;mc-thumbnail-max-height: auto;border-left-style: solid;border-left-width: 1px;border-left-color: #d3d3d3;border-right-style: solid;border-right-width: 1px;border-right-color: #d3d3d3;border-top-style: solid;border-top-width: 1px;border-top-color: #d3d3d3;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #d3d3d3;" />
                </p>
            </li>
            <li>
                <p>Log in to your <span class="uicontrol">Salesforce Org</span> and search for the <span class="uicontrol">Single-Sign-On</span> settings.</p>
            </li>
            <li>
                <p>Enable <span class="uicontrol">Federated Single Sign-On Using SAML</span>, if not already enabled.</p>
            </li>
            <li>
                <p>Click create <span class="uicontrol">New Entry from Metadata File</span>.</p>
            </li>
            <li>
                <p>Upload your <span class="uicontrol">IDP Metadata File</span> into Salesforce.</p>
            </li>
            <li>
                <p>On the <span class="uicontrol">SAML Single Sign-On Settings</span> page, click <span class="uicontrol">Save</span>. Salesforce will create a unique <span class="uicontrol">SSO Policy</span> for your local IDP.</p>
            </li>
            <li>
                <p>Click <span class="uicontrol">Download Metadata</span>.</p>
            </li>
        </ol>
        <h2>Adding SAML Remote Service Provider Application</h2>
        <ol>
            <li>
                <p>Return to <span class="uicontrol">Access Gateway Browser</span>, click the <span class="uicontrol">Applications</span> tab, and select <span class="uicontrol">+ Add</span>.</p>
            </li>
            <li>
                <p>Scroll down, select the <span class="uicontrol">SAML Remote Service Provider App</span>, and click <span class="uicontrol">Create</span>.</p>
            </li>
            <li>
                <p>In the <span class="uicontrol">Settings</span> tab under <span class="uicontrol">Label</span>, name your <span class="uicontrol">Remote SAML App</span>.</p>
            </li>
            <li>
                <p>Open the <span class="uicontrol">Salesforce Metadata File</span> you previously downloaded in a text editor.</p>
                <p>
                    <img src="../../Resources/Images/access-gateway/app-integration-salesforce-service-provider-11.png" alt="" style="mc-thumbnail: popup;mc-thumbnail-max-width: 250px;mc-thumbnail-max-height: auto;border-left-style: solid;border-left-width: 1px;border-left-color: #d3d3d3;border-right-style: solid;border-right-width: 1px;border-right-color: #d3d3d3;border-top-style: solid;border-top-width: 1px;border-top-color: #d3d3d3;border-bottom-style: solid;border-bottom-width: 1px;border-bottom-color: #d3d3d3;" />
                </p>
            </li>
            <li>
                <p>Copy the <span class="uicontrol">Salesforce Metadata</span> from the text editor, and click <span class="uicontrol">Register SP Metadata</span>.</p>
            </li>
            <li>
                <p>Paste the <span class="uicontrol">Salesforce Metadata</span> into the <span class="uicontrol">SAML Upload Wizard</span>, and click <span class="uicontrol">Validate</span>.</p>
                <p>
                    <img src="../../Resources/Images/access-gateway/app-integration-salesforce-service-provider-12.png" alt="" style="mc-thumbnail: popup;mc-thumbnail-max-width: 250px;mc-thumbnail-max-height: auto;" />
                </p>
            </li>
            <li>
                <p>Click <span class="uicontrol">Done</span>.</p>
            </li>
            <li>
                <p>In the <span class="uicontrol">Attributes Tab</span>, select <span class="uicontrol">Email Address</span> for the <span class="uicontrol">Name ID Format</span>, and select <span class="uicontrol">email</span> for the <span class="uicontrol">Value</span>.</p>
                <p>
                    <img src="../../Resources/Images/access-gateway/app-integration-salesforce-service-provider-13.png" alt="" style="mc-thumbnail: popup;mc-thumbnail-max-width: 250px;mc-thumbnail-max-height: auto;" />
                </p>
            </li>
            <li>
                <p>Click <span class="uicontrol">Okay</span>, and then Click <span class="uicontrol">Done</span>.</p>
            </li>
            <li>
                <p>Once completed, you can test the <span class="uicontrol">Salesforce Integration</span> via the <span class="wintitle">Topology Tab</span>.</p>
            </li>
        </ol>
        <h2>Appendix</h2>
        <h2>Add the local IDP Host name in the Management Console</h2>
        <p>In order to verify the <span class="uicontrol">Local IDP Hostname</span>, you must add it in the Management Console.</p>
        <ol>
            <li>
                <p>Start the Access Gateway VM and open a terminal window. The default credentials for the Management Console are:</p>
                <ul>
                    <li>Username: oag-mgmt</li>
                    <li>Password: "default password"</li>
                </ul>
            </li>
            <li>
                <p>In the Management Console, Enter <span class="uicontrol">1</span> to enter Network Settings.</p>
            </li>
            <li>
                <p>Enter <span class="uicontrol">4</span> to navigate to <span class="uicontrol">Edit /etc/hosts</span></p>
            </li>
            <li>
                <p>Click <span class="uicontrol">Add Entry</span> and enter the IP Address and Hostname of your local IDP.</p>
            </li>
            <li>
                <p>Enter <span class="uicontrol">C</span> to commit these changes to /etc/hosts Editor.</p>
            </li>
            <li>
                <p>Enter <span class="uicontrol">R</span> to Restart the Network.</p>
            </li>
            <li>
                <p>Return to the browser to finish the IDP Integration.</p>
            </li>
        </ol>
    </body>
</html>