<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:conditions="Primary.do-not-publish" MadCap:fileTags="Tags/okta-authors.Barbara Vo">
    <head>
        <link href="../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>[%=Heading.Level1%] | Okta</title>
        <meta name="description" content="Security Context for Policy Rule Conditions enables you to build custom security heuristics using signals derived from Okta." />
    </head>
    <body>
        <h1>Security Context for Policy Rule Conditions</h1>
        <MadCap:snippetBlock src="../../../Resources/Snippets/ea-featmgr.flsnp" />
        <p>Security Context for Policy Rule Conditions enables admins to build custom security heuristics using signals derived from <MadCap:variable name="okta-variables.ProductName" />. </p>
        <p>You can use security heuristics with <MadCap:variable name="okta-variables.ProductName" /> sign-on policy rules to enhance the security of your org.</p>
        <p>A security heuristic is an expression that has multiple conditions joined by various operators. You can use Expression Language to create expressions. For more information, see <a href="https://developer.okta.com/docs/reference/okta-expression-language/" target="blank" title="Okta Expression Language overview" alt="Okta Expression Language overview"><MadCap:variable name="okta-variables.ProductName" /> Expression Language overview</a>.</p>
        <h2>Feature group and Expression Language</h2>
        <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
            <col class="TableStyle-standard-Column-Column1" style="width: 282px;" />
            <col class="TableStyle-standard-Column-Column1" style="width: 432px;" />
            <col class="TableStyle-standard-Column-Column1" style="width: 456px;" />
            <col class="TableStyle-standard-Column-Column1" style="width: 258px;" />
            <col class="TableStyle-standard-Column-Column1" />
            <tbody>
                <tr class="TableStyle-standard-Body-Body1">
                    <td class="TableStyle-standard-BodyF-Column1-Body1" style="font-weight: bold; background-color: #f5f5f5;">Feature Group</td>
                    <td class="TableStyle-standard-BodyF-Column1-Body1" style="font-weight: bold; background-color: #f5f5f5;">Feature</td>
                    <td class="TableStyle-standard-BodyF-Column1-Body1" style="font-weight: bold; background-color: #f5f5f5;">Name</td>
                    <td class="TableStyle-standard-BodyF-Column1-Body1" style="font-weight: bold; background-color: #f5f5f5;">Type</td>
                    <td class="TableStyle-standard-BodyD-Column1-Body1" style="font-weight: bold; background-color: #f5f5f5;">Note</td>
                </tr>
                <tr class="TableStyle-standard-Body-Body2">
                    <td class="TableStyle-standard-BodyF-Column1-Body2">ThreatInsight</td>
                    <td class="TableStyle-standard-BodyF-Column1-Body2">IPs flagged by ThreatInsight</td>
                    <td class="TableStyle-standard-BodyF-Column1-Body2"><span class="code">security.ip.isSuspicious</span>
                    </td>
                    <td class="TableStyle-standard-BodyF-Column1-Body2">Boolean</td>
                    <td class="TableStyle-standard-BodyD-Column1-Body2">An IP is considered suspicious if ThreatInsight flags it as a high threat.</td>
                </tr>
                <tr class="TableStyle-standard-Body-Body1">
                    <td class="TableStyle-standard-BodyF-Column1-Body1">IP Reputation</td>
                    <td class="TableStyle-standard-BodyF-Column1-Body1" style="padding: 0px;">
                        <table style="width: 100%;">
                            <col />
                            <tbody>
                                <tr>
                                    <td>Tor Exit Node</td>
                                </tr>
                                <tr>
                                    <td>Anonymizing Proxy</td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                    <td class="TableStyle-standard-BodyF-Column1-Body1" style="padding: 0px;">
                        <table style="width: 100%;">
                            <col />
                            <tbody>
                                <tr>
                                    <td><span class="code">security.ip.isTorProxy</span>
                                    </td>
                                </tr>
                                <tr>
                                    <td><span class="code">security.ip.isAnonymousProxy</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                    <td class="TableStyle-standard-BodyF-Column1-Body1" style="padding: 0px;">
                        <table style="width: 100%;">
                            <col />
                            <tbody>
                                <tr>
                                    <td>Boolean</td>
                                </tr>
                                <tr>
                                    <td>Boolean</td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                    <td class="TableStyle-standard-BodyD-Column1-Body1" style="padding: 0px;">
                        <table style="width: 100%;">
                            <col />
                            <tbody>
                                <tr>
                                    <td>&#160;</td>
                                </tr>
                                <tr>
                                    <td>&#160;</td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <tr class="TableStyle-standard-Body-Body2">
                    <td class="TableStyle-standard-BodyF-Column1-Body2">Risk Level</td>
                    <td class="TableStyle-standard-BodyF-Column1-Body2"><a href="../Security_Risk_Scoring.htm">Risk Level</a>
                    </td>
                    <td class="TableStyle-standard-BodyF-Column1-Body2"><span class="code">security.risk.level</span>
                    </td>
                    <td class="TableStyle-standard-BodyF-Column1-Body2">String</td>
                    <td class="TableStyle-standard-BodyD-Column1-Body2">
                        <p>LOW/MEDIUM/HIGH

						</p>
                        <p>Based on the risk level determined by the risk scoring feature. </p>
                    </td>
                </tr>
                <tr class="TableStyle-standard-Body-Body1">
                    <td class="TableStyle-standard-BodyC-Column1-Body1">User Behavior</td>
                    <td class="TableStyle-standard-BodyC-Column1-Body1">All User Behaviors available for your org through <a href="../proc-security-behavior-detection.htm">Behavior Detection</a>.</td>
                    <td class="TableStyle-standard-BodyC-Column1-Body1"><span class="code">security.userBehaviors['behaviorName'].detected</span>
                    </td>
                    <td class="TableStyle-standard-BodyC-Column1-Body1">Boolean</td>
                    <td class="TableStyle-standard-BodyA-Column1-Body1">Previously configured behaviors can be passed using the name of the predefined behaviors in the expression. The names of these behaviors are unique.</td>
                </tr>
            </tbody>
        </table>
        <h2>Before you begin</h2>
        <ul>
            <li>Enable Adaptive Multifactor Authentication (MFA). See <MadCap:xref href="../proc-security-behavior-detection.htm">Behavior Detection and evaluation</MadCap:xref>.</li>
            <li>The maximum number of conditions in a heuristic is 30.</li>
            <li>The Expression Language for Security Context supports a subset of operators such as:<ul><li>AND</li><li>OR</li><li>==</li><li>!=</li><li>!or NOT</li></ul></li>
        </ul>
        <h2>Configure the Security Context for sign-on policies</h2>
        <ol>
            <li>
                <MadCap:snippetText src="../../../Resources/Snippets/task steps/Security_Authentication.flsnp" />
            </li>
            <li>Click the <span class="wintitle">Sign On</span> tab.</li>
            <li>Select a sign-on policy.</li>
            <li><span class="uicontrol">Add</span> or edit a sign-on policy.</li>
            <li>Under <span class="wintitle">Conditions</span>, toggle <span class="uicontrol">Advanced</span> mode to enable <span class="uicontrol">Security Context</span>.</li>
            <li>Under the <span class="wintitle">AND Security Context is</span> condition, enter the Expression Language to define security signals.</li>
            <li>Click <span class="uicontrol">Create Rule</span> or <span class="uicontrol">Update Rule</span>.</li>
        </ol>
        <h2>Expression examples</h2>
        <h3>Unrecognized IPs or devices, risk is medium or high</h3>
        <ol>
            <li>Create a behavior policy for a new device and a new IP address.</li>
            <li>Paste this expression into the <span class="uicontrol">AND Security Context is</span> field:</li>
        </ol>
        <p><span class="code">security.userBehaviors['NewIP'].detected OR security.userBehaviors['NewDevice'].detected OR security.risk.level=='HIGH' OR security.risk.level == 'MEDIUM'</span>
        </p>
        <h3>Suspicious IPs</h3>
        <p>Paste this expression into the <span class="uicontrol">AND Security Context is</span> field:</p>
        <p><span class="code">security.ip.isSuspicious</span>
        </p>
        <h3>Standard risk-based authentication with factor chaining, add Tor Proxy</h3>
        <p>Paste this expression into the <span class="uicontrol">AND Security Context is</span> field:</p>
        <p><span class="code">security.risk.level == 'HIGH' OR security.ip.isTorProxy</span>
        </p>
    </body>
</html>