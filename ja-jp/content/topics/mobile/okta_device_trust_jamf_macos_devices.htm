<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_nav_poc" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-searchable="True" data-mc-toc-path="Devices|Device Trust" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="Jamf ProマネージドのmacOSデバイス向けOkta Device Trustは、管理されていないコンピューターがアプリにアクセスするのを防止します。デバイス登録タスクは、個々のコンピューターを登録するタスクです。" />
        <meta name="viewport" content="width=device-width, height=device-height" /><title>Jamf ProマネージドのmacOSデバイスにOkta Device Trustを強制適用する</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Pendo Script (Per Chris Bank) -->
        <!-- End Pendo Script -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" />
        <style>/*<meta />*/

.button.select-language-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../resources/stylesheets/okta-main-new-nav.css" rel="stylesheet" type="text/css" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-NMZZV4P');
			/* ]]> */
		</script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KXMLV58');
			/* ]]> */
		</script>
        <script>
		/* <![CDATA[ */
		(function(apiKey){
			(function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
			v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
			o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
			y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
			z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id:              'VISITOR-UNIQUE-ID'
            },
            account: {
                id:           'ACCOUNT-UNIQUE-ID'
            }
        });
		})('a9bd3885-93ae-46ab-700b-dd29e613c19d');
		/* ]]> */
        function openSurvey() {
            window.open('https://surveys.okta.com/jfe/form/SV_e4L0iW8a3tz8Yol?source=' + encodeURIComponent(document.location.href), '_blank');
        }
		</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1024px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">メインコンテンツにスキップする</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">アカウント</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">設定</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">ログアウト</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="ナビゲーションパネルを表示" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>プレースホルダー</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">アカウント</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">設定</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">ログアウト</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="検索フィールド" placeholder="検索" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">フィルター： </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="検索フィルター" title="すべてのファイル" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">すべてのファイル</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="検索" role="button" tabindex="0"><span class="invisible-label">検索を送信</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMZZV4P" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.OrgId variable">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="mc-variable okta-coveo-config.PlatformRestUri variable">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchPageUrl variable">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchTokenServiceUrl variable">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <div id="coveo_dev_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.DevOrgId variable">oktanonproduction1il1gtac7</span>
                                    </div>
                                    <div id="coveo_dev_token" style="Display:None"><span class="mc-variable okta-coveo-config.DevSearchToken variable">xxf1de37f5-c8aa-42db-a8ef-0cbf06dfa5e3</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************** Coveo Search bar ************************************* -->
                                    <!-- set margin and size in /Content/Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css to make room for replacing Flare-generated top-nav with HTML code (see below)-->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper" data-mc-conditions="MultiProdPublish.SearchBar">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="replace_top_nav">
                                        <div class="navbar" data-mc-conditions="Primary.live-site-only">
                                            <div class="dropdown" data-test="menuBarCategory" id="documentationMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">ドキュメント <em class="fa fa-caret-down"></em></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=oie-index" data-test="menuBarLink">Identity Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?id=index-admin" data-test="menuBarLink">Classic Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oag&amp;id=ext_oag_main" data-test="menuBarLink">Access Gateway</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=asa&amp;id=csh-asa-overview" data-test="menuBarLink">Advanced Server Access</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=wf&amp;id=ext-Okta-workflows" data-test="menuBarLink">Workflows</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="relnotesMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">リリースノート <em class="fa fa-caret-down"></em></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=csh-oie-release-notes" data-test="menuBarLink">Identity Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?id=ext_okta_relnotes" data-test="menuBarLink">Classic Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oag&amp;id=ext_oag_releasenotes" data-test="menuBarLink">Access Gateway</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=asa&amp;id=ext-asa-releasenotes" data-test="menuBarLink">Advanced Server Access</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=wf&amp;id=ext-workflows-releasenotes" data-test="menuBarLink">Workflows</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="oktaDevDocsMenu"><a href="https://developer.okta.com/" target="_blank" data-test="menuBarLink">Okta Developer</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="auth0Menu"><a href="https://auth0.com/docs" target="_blank" data-test="menuBarLink">Auth0</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="trainingMenu"><a href="https://www.okta.com/services/training/" target="_blank" data-test="menuBarLink">トレーニング</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="supportMenu"><a href="https://support.okta.com/help/s/?language=en_US" target="_blank" data-test="menuBarLink">サポート</a>
                                            </div>
                                        </div>
                                        <div class="logo_container" id="OktaBanner" data-mc-conditions="Primary.live-site-only"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" data-test="OktaBanner"><img src="../../resources/images/okta-assets/logo.png" alt="Oktaのドキュメント" title="Oktaのドキュメント" data-test="OktaBannerImg" /></a>
                                        </div>
                                        <div class="toolbar-main" data-test="toolBar" data-mc-conditions="Primary.live-site-only">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_no_expand mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie select-language-button" title="言語を変更">
                                                        <div>
                                                            <div role="img" class="button-icon-wrapper" aria-label="言語を変更">
                                                                <div class="button-icon"> </div>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics" data-test="bodyWrapper">
                                        <!-- *** Col1: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                                <div class="nocontent">
                                                    <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="ブレッドクラム" data-mc-breadcrumbs-divider="  &gt;  " data-mc-breadcrumbs-count="3" data-mc-toc="True">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="oie-label" data-mc-conditions="MultiProdPublish.Classic">
                                                <img class="oie-label" title="ラベル：Okta Classic Engineコンテンツ" src="../../resources/images/okta-assets/classic_engine.svg" />
                                            </div>
                                            <div class="body-main" data-test="bodyContent">
                                                <!-- Main content body -->
                                                <div role="main" id="mc-main-content">
                                                    <h1>Jamf ProマネージドのmacOSデバイスにOkta <span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>を強制適用する</h1>
                                                    <p> Okta デバイス登録タスク v1.3.1は、Python 3に対応するためにリリースされました。Python 2.xのスクリプトが必要な場合は、<a href="https://okta.okta.com/static/devicetrust/MacOktaDeviceRegistrationTaskSetup.1.2.1.py">デバイス登録タスク v1.2.1</a>を参照してください。</p>
                                                    <p>Jamf ProマネージドmacOSデバイス用<span class="mc-variable okta-feature-names.Okta_Device_Trust variable">Okta Device Trust</span>を使用すると、管理外のmacOSデバイスから企業のSAMLやWS-Fedクラウドアプリにアクセスできないようにすることが可能です。<span class="mc-variable okta-feature-names.Okta_Device_Trust variable">Okta Device Trust</span>は、既知の安全なデバイスのみがOktaマネージドアプリにアクセスできることを保証します。</p>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-flow.png" data-mc-popup-alt="The image illustrates how Okta Device Trust is enforced for Jamf Pro managed macOS devices."><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1256" data-mc-height="817" src="../../resources/images/dt-macos-flow_thumb_220_220.png" alt="Jamf ProマネージドmacOSデバイスに対してOkta Device Trustを強制適用する方法を示す図。" tabindex="" /></a>
                                                    </p>
                                                    <h2>前提条件</h2><a name="Prerequi"></a>
                                                    <p>このソリューションは、以下と連携します。
                </p>
                                                    <ul>
                                                        <li><a href="../miscellaneous/platforms_browser_os_support.htm" class="MCXref xref">サポートされるmacOSのプラットフォーム、ブラウザー、およびオペレーティングシステム</a>を実行しているAppleコンピューター。</li>
                                                        <li>Jamf Pro MDMソリューション</li>
                                                        <li>Oktaへの連携認証フローを実行する際に、管理対象コンピューター上のOktaキーチェーンにアクセス可能なブラウザーおよびネイティブアプリとして以下が挙げられます。
						<ul><li>ブラウザー：Chromeブラウザー、Safariブラウザー</li><li>先進認証対応のネイティブアプリ：
					<ul><li>Box</li><li>Googleドライブ</li><li>Microsoft Office</li><li>Skype for Business</li><li>Slack</li></ul></li></ul></li>
                                                        <li> Okta デバイス登録タスクは、様々なタスク（会員登録、登録など）を完了させるPythonスクリプトです。このスクリプトの適切なバージョンを使用するにあたり、お使いのOSに応じて、次のいずれかを完了してください。<ul><li> macOS 10.15.xx（Catalina）、11.xx（Big Sur）、または12.xx（Monterey）をお使いの場合は、Python 3をベースとした登録バージョン1.3.3以降をお使いください。</li><li>macOS 10.14.xx（Mojave）をお持ちで、現在登録スクリプト1.2.1以前をお使いの方は、そのまま使い続けるか、Python 3を使う前にCatalina、Big Sur、またはMontereyにアップグレードしてください。</li></ul></li>
                                                    </ul>
                                                    <h2>はじめに</h2>
                                                    <ul>
                                                        <li>
                                                            <p>安全なアプリケーションへのアクセスに使用されていないデバイスでは、Device Trustのデプロイは更新されません。このため、安全なリソースへのアクセスを必要とするデバイスにのみ証明書を発行することをお勧めします。</p>
                                                        </li>
                                                        <li>Microsoft Officeアプリの保護には先進認証が必要：この<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>ソリューションでMicrosoft Officeアプリを保護するには、先進認証のサポートが有効になっている必要があります。詳しくは、Microsoftの<a href="https://docs.microsoft.com/en-us/office365/enterprise/modern-auth-for-office-2013-and-2016?redirectSourcePath=%252fen-us%252farticle%252fusing-office-365-modern-authentication-with-office-clients-776c0036-66fd-41cb-8928-5495c0f9168a" rel="noreferrer" target="_blank">こちら</a>の記事をご覧ください。レガシープロトコルを使用するOffice 365クライアントのセキュリティ保護については、「Office 365クライアントアクセスポリシー」を参照してください。</li>
                                                        <li>
                                                            <p><span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>は、Microsoft Officeシック クライアントのすべてのバージョンでサポートされているわけではない：この<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>ソリューションは、Microsoft Officeシッククライアントバージョン16.13.1および16.15で動作することがテストで確認されています。ただし、Microsoft Officeシッククライアントバージョン16.14（ビルド180610）では動作しません。 </p>
                                                        </li>
                                                        <li>iCloudから他のAppleデバイスにOktaキーチェーンが転送されないようにする：DTでセキュリティ保護されたmacOSデバイスから他のAppleデバイスにiCloudでOktaキーチェーンが転送されないようにするには、Jamf Proで<span class="uicontrol">［Allow iCloud Keychain syncing（iCloudキーチェーンの同期を許可）］</span>を無効にする設定プロファイルを作成することを強く推奨します。（注：同期を無効にすると、すべてのキーチェーンの転送がブロックされますのでご注意ください） 。「<a href="#disable-keychain-syncing">変更したOkta デバイス登録タスクをJamf Proに追加してmacOSデバイスに配布する</a>」を参照してください。</li>
                                                        <li>
                                                            <p>Webビューは、デバイス・キーチェーンにアクセスできる必要がある：マネージドmacOSコンピューターの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>は、Webビューを介した認証をサポートするSAML/WS-Fed対応の任意のアプリで動作します。認証を行うWebビューは、デバイス上のOktaキーチェーンにアクセス可能でなければなりません。認証フローで証明書を使用する際にエンドユーザーが同意を求められるのを防ぐため、Oktaでは次のアプリを許可しています。<a href="#PartG">「デフォルトの許可リストを変更する」</a>を参照してください。</p>
                                                            <ul>
                                                                <li>Box</li>
                                                                <li>Chrome</li>
                                                                <li>Safari</li>
                                                                <li>Microsoft Office</li>
                                                                <li>Skype for Business</li>
                                                                <li>Googleドライブ</li>
                                                                <li>Slack</li>
                                                            </ul>
                                                        </li>
                                                        <li>デバイスごとのバインドされていない証明書の制限：Device Trustで保護されたmacOSデバイスから、Device Trustで保護されたアプリケーションにユーザーが初めてアクセスしたときに、証明書が特定のユーザーに対してバインドされます。未使用の証明書はバインドが解除されます。Oktaでは、登録手続きを行うたびに、1つずつ、アンバウンド証明書を最大5件までデバイスに対して発行することができます。セキュリティ対策として、Oktaでは特定のデバイスに対してアンバウンド証明書を6件以上発行しないようにしています。アンバウンド証明書の上限に達しないようにするには、登録によってさらに証明書を取得しようとする前に、ユーザーがデバイスに既存するアンバウンド証明書を使用していることを確認する必要があります。登録の上限に達すると、Syslogに登録エラーが表示され、JAMFログに<span class="uicontrol">「Maximum enrollment limit of 5 certificates for a device is reached（デバイスの証明書が登録上限の5件に達しました）」</span>というエラー​メッセージが表示されます。</li>
                                                        <li>Orgごとの登録制限：所定のmacOSデバイスは、1つのOkta orgの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>設定によってのみセキュリティ保護することができます。別の言い方をすれば、macOSデバイスを、複数のOkta orgの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>設定によって同時に保護することはできません。これは、デバイスに対して発行されるクライアント証明書が、特定のOrgのCAによって署名されているためです。この制限は、Oktaプレビューと本番環境のOrgに適用されます。</li>
                                                        <li>端末共有のシナリオはサポートされていない：この<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>ソリューションは、複数のOktaエンドユーザーが同じmacOSワークステーションから同じアカウントにログインする共有端末のシナリオをサポートしていません。</li>
                                                        <li>Oktaが読み取り専用モードのときはDevice Trust登録はサポートされない：Okta orgが属するセルが読み取り専用モード の時は、デバイスは<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>に登録されません。</li>
                                                        <li>エンドユーザーは、ブラウザーのキャッシュをクリアする必要があるかもしれない：一部のブラウザー（例：Chrome）では、<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書がキャッシュされます。証明書が自動的に更新された後（1年に1回）、これらのブラウザーは新しい証明書ではなく、期限切れの証明書をOktaに提示し続ける場合があります。その場合、エンドユーザーには<span class="wintitle">セキュリティ要件</span>のメッセージが表示され、<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>で保護されたアプリへのアクセスは拒否されます。Oktaでは、影響を受けるエンドユーザーに対して、ブラウザーを終了して再起動することにより、ブラウザーのキャッシュをクリアするようアドバイスすることを推奨しています (ブラウザーのウィンドウを閉じるだけでは不十分です)。</li>
                                                        <li>
                                                            <p><span style="font-weight: normal;" class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>によって保護されたアプリは、<span style="font-weight: normal;" class="mc-variable okta-feature-names.Okta_End-User_Dashboard variable">Okta End-User Dashboard（Oktaエンドユーザーダッシュボード）</span>にロック済みとして表示されます。次の条件下で<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>によって保護されたアプリの横に、ロックアイコンが表示されます。</p>
                                                            <ul>
                                                                <li>  エンドユーザーがデスクトップまたはモバイルのブラウザー（<span class="mc-variable Mobile.Okta_Mobile variable">Okta Mobile</span>以外）でダッシュボードにアクセスした。 </li>
                                                                <li>Orgで<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>が有効になっている。</li>
                                                                <li>デバイスが信頼されていない。</li>
                                                                <li>エンドユーザーがダッシュボードから<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>で保護されたアプリにアクセスしようとした。 </li>
                                                            </ul>
                                                        </li>
                                                        <li>
                                                            <p>アプリは先進認証に対応している必要がある：この<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>ソリューションでMicrosoft Officeアプリを保護するには、先進認証のサポートを有効にする必要があります。詳しくは、Microsoftの記事<a href="https://docs.microsoft.com/en-us/office365/enterprise/modern-auth-for-office-2013-and-2016" target="_blank">「How modern authentication works for Office 2013 and Office 2016 client apps（Office 2013、Office 2016クライアントアプリでの先進認証の仕組み）」</a>を参照してください。「Office 365クライアントアクセスポリシー」も参照してください。</p>
                                                        </li>
                                                        <li>
                                                            <p>このDevice Trustソリューションの対象となるデバイスのキーチェーンに証明書がインストールされていることを確認します。証明書がインストールされておらず、アプリサインオンポリシーで［Trusted（信頼）］設定が有効な場合、ユーザーはアプリへのアクセスが拒否され、管理者に連絡するように促すセキュリティメッセージにリダイレクトされます（詳細情報への<span class="uicontrol">［Learn more（詳細）］</span>リンクを含めるようにメッセージを設定できます。「<a href="#learn-more-link">ステップ1 - OrgのグローバルDevice Trust設定を有効にする</a>」を参照してください）。 </p>
                                                        </li>
                                                        <li>
                                                            <p>macOSDevice Trust設定を無効にする場合は注意が必要：信頼済みのmacOSデバイスを許可するアプリサインオンポリシーも構成している場合は、<span class="uicontrol">［Security（セキュリティ）］</span><span class="mc-variable okta-feature-names.Device_Trust variable">［Device Trust］</span>ページでmacOSの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>設定を無効にしないでください。無効にすると、<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>の設定に矛盾が生じた状態になります。Orgの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>を無効にするには、まず、<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>の設定を含むアプリのサインオンポリシーをすべて削除し、<span class="menucascade"><span class="uicontrol">［Security（セキュリティ）］</span><span class="uicontrol"><span class="mc-variable okta-feature-names.Device_Trust variable">［Device Trust］</span></span></span>でmacOSの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>を無効にします。</p>
                                                        </li>
                                                        <li> Oktaサポートに<span style="font-weight: bold;" class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>の無効化を依頼する前に：OktaサポートにOrgの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>機能の無効化を依頼する場合は、事前にアプリサインオンポリシールールで<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>の設定を<span class="uicontrol">［Any（任意）］</span>に変更してください（<span class="menucascade"><span class="uicontrol">［Applications（アプリケーション）］</span><span class="uicontrol">［app（アプリ）］</span><span class="uicontrol">［Sign On（サインオン）］</span></span>）。この変更を行わずに後でOktaサポートにOrgの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>機能の再有効化を依頼した場合、アプリサインオンポリシールールの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>設定がすぐに有効になるという予期しない動作が発生します。
					</li>
                                                        <li>クライアントがMTLSハンドシェイクを完了できることを確認する：この<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>フローの相互TLS証明書の交換（ハンドシェイク）は、Okta orgのURLとは別のOktaのURLで行われます（以下の例ではワイルドカード文字（*）で示されています）。エンドポイント保護ソフトウェアを導入する場合は、クライアントがOktaとの証明書交換を完了する際に妨げにならないように設定してください。たとえば、許可リストを使用して送信トラフィックを制限している場合、ワイルドカード文字（*）を含めたこれらの正確なURLを許可リストに追加します。

					<p><span class="code">*.okta.com</span></p><p><span class="code">*.okta-emea.com</span></p><p><span class="code">*.okta-gov.com</span></p></li>
                                                    </ul>
                                                    <h2>手順</h2>
                                                    <h3><span>ステップ1. Orgのグローバル<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>設定を有効にする</span>
                                                    </h3><a name="Task1"></a>
                                                    <ol>
                                                        <li value="1"><span class="mc-variable okta-feature-names.Admin_Console variable">Admin Console</span>で、<span class="menucascade"><span class="uicontrol">［Security（セキュリティ）］</span><span class="uicontrol"><span class="mc-variable okta-feature-names.Device_Trust variable">［Device Trust（Device Trust）］</span></span></span>に移動します。</li>
                                                        <li value="2">macOS <span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>セクションで、<span class="uicontrol">［Edit（編集）］</span>をクリックします。</li>
                                                        <li value="3">起動したウィザードで、<span class="uicontrol">［Enable macOS <span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust（macOS Device Trustを有効にする）］</span></span>を選択します。</li>
                                                        <li value="4"><a name="learn-more-link"></a>任意。<span class="uicontrol">［Learn more（詳細）］</span>フィールドには、非信頼デバイスを使用するエンドユーザーが詳細情報を参照できる、外部からアクセス可能なリダイレクトURLを入力できます。これらのエンドユーザーに表示されるセキュリティメッセージには、指定したURLにリダイレクトされる［Learn more（詳細）］リンクが含まれます。


						<p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt_security_urlspecified_2.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="386" data-mc-height="265" src="../../resources/images/dt_security_urlspecified_2_thumb_220_220.png" tabindex="" /></a></p><p>この任意選択フィールドにURLを指定しないオプションを選択した場合、これらのエンドユーザーには同じメッセージが表示されますが、<span class="uicontrol">［Learn more（詳細）］</span>リンクは表示されません。 </p><p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt_security_nourlspecified_2.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="373" data-mc-height="198" src="../../resources/images/dt_security_nourlspecified_2_thumb_220_220.png" tabindex="" /></a></p></li>
                                                        <li value="5"><span class="uicontrol">［Trust is established by（信頼の確立元）］</span>で、<span class="uicontrol">［Jamf Pro］</span>を選択します。</li>
                                                        <li value="6">Jamf ProのテナントURL（例：API URLではなく、<span class="code">https://example.jamfcloud.com</span>）、資格情報、キーなど、Jamf Pro APIの情報を入力します。                             <p>この情報により、Oktaは証明書の登録時にエンドユーザーのデバイスがJamf Proで管理されていることを確認できます。Jamf Proの場合、デバイスが管理状態にあることをOktaが確認するため、Jamf APIにアクセスするには、少なくともこれらの参照権限が必要です。</p><ul><li><span class="uicontrol">［Computers（コンピューター）</span>：参照</li><li><span class="uicontrol">［Jamf Pro User Accounts &amp; Groups（Jamf Proユーザーアカウントとグループ）］</span>：参照</li><li><span class="uicontrol">［Users（ユーザー）］</span>：参照</li></ul></li>
                                                        <p>
                                                            <div class="noteOkta">
                                                                <p class="noteContent">Oktaでは、APIアクセス用に、OrganizationがJamf Pro管理インターフェイスにアクセスするために使用するユーザーとは別のユーザーを作成することを強く推奨します。</p>
                                                            </div>
                                                        </p>
                                                        <li value="7"><span class="uicontrol">［Test API credentials（API資格情報をテスト）］</span>をクリックします。MDMプロバイダーのAPIと接続できた場合、接続が完了したことを知らせるメッセージが表示されます。</li>
                                                        <li value="8"><span class="uicontrol">［Next（次へ）］</span>をクリックします。</li>
                                                        <li value="9">［Configure MDM Provider（MDMプロバイダーの設定）］画面で、<span class="uicontrol">［Download（ダウンロード）］</span>をクリックし、Pythonスクリプトを入手します。このスクリプトは、<a href="#Task2">「ステップ2. Okta デバイス登録タスクを変更する」</a>で修正します。</li>
                                                        <li value="10">提供された<span class="uicontrol">［Secret Key Value（秘密鍵の値）］</span>と<span class="uicontrol">［Org URL］</span>をクリップボードにコピーするには、フィールドに隣接するコピーアイコンをクリックします。 </li>
                                                        <p>
                                                            <div class="noteOkta">
                                                                <p class="noteContent">表示されている<span class="uicontrol">［Secret Key Value（秘密鍵の値）］</span>と<span class="uicontrol">［Org URL］</span>を書き留めておきます。これはその後Oktaには表示されません。また、後で構成を編集する場合、<span class="uicontrol">［Reset macOS Secret Key（macOSの秘密鍵をリセット）］</span>ボタンを使用して新しい<span class="disableGlossary">秘密鍵</span>を生成するときは、この手順をもう一度実行する必要があります。</p>
                                                            </div>
                                                        </p>
                                                        <li value="11"><span class="uicontrol">［Done（完了）］ </span>をクリックします。</li>
                                                        <li value="12">ダウンロードしたOkta デバイス登録タスクを<a href="#Task2">ステップ2</a>の説明に従って修正します。
                            <p>Oktaデバイス登録タスクの<a href="../settings/version_histories/ver_history_device_trust_macos.htm" rel="noreferrer" target="_blank">最新版</a>は、Okta Admin Consoleの<span class="menucascade"><span class="uicontrol">［Settings（設定）］</span><span class="uicontrol">［Downloads（ダウンロード）］</span></span>ページで入手できます。</p></li>
                                                    </ol>
                                                    <h3><a name="Step"></a>ステップ2. Okta デバイス登録タスクを変更する
        </h3><a name="Task2"></a>
                                                    <div class="noteOkta"><a name="MTLS-handshake"></a>
                                                        <p class="noteContent">このDevice Trustフローの相互TLS証明書の交換（ハンドシェイク）は、Okta orgのURLとは別のOktaのURLで行われます（以下の例ではワイルドカード文字（*）で示されています）。エンドポイント保護ソフトウェアを導入する場合は、クライアントがOktaとの証明書交換を完了する際に妨げにならないように設定してください。たとえば、許可リストを使用して送信トラフィックを制限している場合、ワイルドカード文字（*）を含めたこれらの正確なURLを許可リストに追加します。</p>
                                                        <p><span class="code">*.okta.com</span>
                                                        </p>
                                                        <p><span class="code">*.okta-emea.com</span>
                                                        </p>
                                                        <p><span class="code">*.okta-gov.com</span>
                                                        </p>
                                                    </div>
                                                    <ol>
                                                        <li value="1">管理者のコンピューターで、<span class="uicontrol">［Downloads（ダウンロード）］</span>フォルダに移動し、Oktaからダウンロードしたスクリプトを開きます。</li>
                                                        <li value="2">「<a href="#Task1">ステップ1. OrgのグローバルのDevice Trustの設定を有効化する</a>」で作成した<span class="uicontrol">Secret Key Value（秘密鍵の値）</span>と<span class="uicontrol">Org URL</span>を貼り付けて、スクリプトを修正します。 </li>
                                                        <p>キーとURLを入力する際、単一引用符( ' )はそのままにして、次の例のように、括弧とプレースホルダーのテキストを実際の<span class="uicontrol">Secret Key Value（秘密鍵の値）</span>と<span class="uicontrol">Org URL</span>に置き換えてください。</p>
                                                        <h4>変更されていないスクリプトの例</h4><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-key-url-before.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="523" data-mc-height="81" src="../../resources/images/dt-macos-key-url-before_thumb_220_220.png" tabindex="" /></a>
                                                        <h4>変更されたスクリプトの例。単一引用符はそのままで、括弧は削除します。</h4><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-key-url-after.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="522" data-mc-height="79" src="../../resources/images/dt-macos-key-url-after_thumb_220_220.png" tabindex="" /></a>
                                                        <li value="3">任意。デフォルトのアプリの許可リストを変更します。</li>
                                                        <p>Okta デバイス登録タスクは、エンドユーザーがアクセスしようとするときにキーチェーンパスワードの入力を求められないように、いくつかの人気アプリをデフォルトで許可します。デフォルトの許可リストを変更するには、<a href="#PartG">「アプリの許可リストを変更する」</a>を参照してください。</p>
                                                        <li value="4">スクリプトを保存します。 </li>
                                                        <li value="5">「<a href="#Task4">ステップ4. 変更したOkta デバイス登録タスクをJamf Proに追加してmacOSデバイスに配布する</a>」に進みます。</li>
                                                    </ol>
                                                    <h3><span style="font-size: 14pt;">ステップ3. Python 3とDevice Trustの依存関係をインストールする</span>
                                                    </h3><a name="Task3"></a>
                                                    <ol>
                                                        <li value="1">
                                                            <p>Python 3がすでにインストールされている場合は、ステップ2に進みます。</p>
                                                            <p>Python 3はさまざまな方法でインストールできます。このステップでは、macOSのXcodeコマンドラインツールを使用したインストール手順に従います。Oktaでは、お好みの方法を使用することを推奨しています。</p>
                                                            <p>任意。macOSマシンで以下のスクリプトを実行し、macOS環境をPython 3にアップデートしてください。
</p>
                                                            <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">コピー</a>
                                                                <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="True"><pre><span class="codeSnippetLineNumbers" style="border-right: #AAA 2px solid;" aria-hidden="true">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</span><code>#!/bin/sh<br />echo &quot;Checking for the existence of the Apple Command Line Developer Tools&quot;<br />/usr/bin/xcode-select -r<br />xcodepath='which xcode-select'<br />echo &quot;xcode path is $xcodepath&quot;<br />$xcodepath -r &amp;&gt; /dev/null<br />$xcodepath -p &amp;&gt; /dev/null<br />if [[ $? -ne 0 ]]; then<br />echo &quot;Apple Command Line Developer Tools not found.&quot;<br />touch /tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress;<br />installationPKG=$(/usr/sbin/softwareupdate --list | /usr/bin/grep -B 1 -E 'Command Line Tools' | /usr/bin/tail -2 | /usr/bin/awk -F'*' '/^ \\/ {print $2}' | /usr/bin/sed -e 's/^ *Label: //' -e 's/^ *//' | /usr/bin/tr -d '\n')<br />echo &quot;Installing ${installationPKG}&quot;<br />/usr/sbin/softwareupdate --install &quot;${installationPKG}&quot; --verbose<br />else<br />echo &quot;Apple Command Line Developer Tools are already installed.&quot;/usr/bin/xcode-select -s /Library/Developer/CommandLineTools<br />fi<br />exit</code></pre>
                                                                </div>
                                                            </div>
                                                        </li>
                                                        <li value="2">
                                                            <p>Device Trustの依存関係をインストールします。アップデートされたmacOS デバイス登録タスクでは、デバイス上の&quot;python3&quot;と&quot;pip3&quot;エイリアスが正しいPython 3インストールを指定するようにする必要があります。</p>
                                                            <p>以下のスクリプトを実行し、必要なDevice Trustの依存関係をインストールします。</p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Device Trustの依存関係をインストールします。アップデートされたmacOS デバイス登録タスクでは、デバイス上の&quot;python3&quot;と&quot;pip3&quot;エイリアスが正しいPython 3インストールを指定するようにする必要があります。</p>
                                                            <p>以下のスクリプトを実行し、必要なDevice Trustの依存関係をインストールします。</p>
                                                            <p>
                                                                <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">コピー</a>
                                                                    <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="True"><pre><span class="codeSnippetLineNumbers" style="border-right: #AAA 2px solid;" aria-hidden="true">1
2
3
4
5
6
</span><code>#!/bin/sh<br />echo &quot;Running pip3 install --upgrade pip&quot;<br />sudo pip3 install --upgrade pip<br />echo &quot;Running pip3 install pyobjc-framework-SystemConfiguration&quot;<br />sudo pip3 install pyobjc-framework-SystemConfiguration<br />exit</code></pre>
                                                                    </div>
                                                                </div>
                                                            </p>
                                                        </li>
                                                    </ol>
                                                    <h3><span style="font-size: 14pt;">ステップ4. 変更したOkta デバイス登録タスクをJamf Proに追加してmacOSデバイスに配布する</span>
                                                    </h3><a name="Task4"></a>
                                                    <p>Okta デバイス登録タスクは、この<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>ソリューションのターゲットとなるmacOSデバイスにJamf Proから配布されるスクリプトです。デバイスにデプロイすると、Okta デバイス登録タスクは次のように動作します。</p>
                                                    <ul>
                                                        <li>
                                                            <p>Oktaに登録して、<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書を取得します。Oktaは、Jamf Proを調べて、デバイスが管理されていることを確認します。</p>
                                                        </li>
                                                        <li>
                                                            <p>デバイスのChromeおよびSafariブラウザーとテスト済みのネイティブアプリを、安全なアプリアクセスの際に証明書を自動的に提示するように構成します。</p>
                                                        </li>
                                                        <li>
                                                            <p>1日1回、ユーザーがコンピューターにログインするたびに実行される軽量なタスクをスケジュール設定します。<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書の有効期限を確認し、有効期限の30日前に更新を試みるタスクです。証明書の有効期限は1年間です。</p>
                                                        </li>
                                                        <li>更新時に、Oktaは新しい証明書を発行する前にデバイスが管理されているかを確認するなど、登録時と同様のチェックを行います。</li>
                                                        <li>スクリプトが一度デバイス上で実行されると、Jamf Proはデバイスから自動的にスクリプトを削除します。</li>
                                                        <li>デバイスにインストールされている登録タスクのバージョンを確認するには、以下のクエリを使用します：<span class="codeblock">python3 ~/Library/Okta/okta_device_trust.py version</span><p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-flow.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1256" data-mc-height="817" src="../../resources/images/dt-macos-flow_thumb_220_220.png" tabindex="" /></a></p></li>
                                                    </ul>
                                                    <p>Organizationにとって有意義なワークフローを作成します。スクリプトが少なくとも1回は正常に実行され、Okta証明書が登録されることを確認します。</p>
                                                    <ol>
                                                        <li value="1">Jamf Proで歯車アイコンをクリックし、<span class="uicontrol">［All Settings（すべての設定）］</span>に移動します。</li>
                                                        <li value="2"><span class="menucascade"><span class="uicontrol">［Computer Management（コンピューター管理）］</span><span class="uicontrol">［Scripts（スクリプト）］</span></span>に移動します。</li>
                                                        <li value="3">新しいスクリプトを作成し、「<a href="#Task1">ステップ1. OrgのグローバルのDevice Trustの設定を有効化する</a>」でOktaからダウンロードして「<a href="#Task2">ステップ2. Okta デバイス登録タスクを変更する</a>」で変更したOktaデバイス登録タスクを貼り付けます。</li>
                                                        <li value="4"><span class="uicontrol">［Save（保存）］</span>をクリックします。</li>
                                                        <li value="5">1つまたは複数のターゲット コンピューターおよび/またはターゲットユーザーにスクリプトをデプロイするポリシーを作成します。</li>
                                                        <ol style="list-style-type: lower-alpha;">
                                                            <li value="1"><span class="menucascade"><span class="uicontrol">［Computers（コンピューター）］</span><span class="uicontrol">［Policies（ポリシー）］</span></span>に移動します。</li>
                                                            <li value="2"><span class="uicontrol">［+ New（+新規作成）］</span>をクリックします。</li>
                                                            <li value="3">左ペインの<span class="uicontrol">［General（一般）］</span>をクリックします。</li>
                                                            <li value="4">［Display Name（表示名）］フィールドにポリシーの名前を入力します。</li>
                                                            <li value="5"> ポリシーを開始するトリガーイベントを次のように選択します。
								<ul><li><span class="uicontrol">［Enrollment Complete（登録完了）］</span>：デバイスが登録プロセスを完了した直後にスクリプトが実行されます。</li><li><span class="uicontrol">［Recurring Check-in（定期的なチェックイン）］</span>：Jamf Proで設定された定期的なチェックインの頻度に従ってスクリプトが実行されます。</li></ul></li>
                                                            <li value="6"><span class="uicontrol">［Execution Frequency（実行頻度）］</span>を<span class="uicontrol">［Once per computer per user（コンピューター1台につき1ユーザー）］</span>に設定します。
                                <p>注：Jamf Proでスクリプトのデプロイをトリガーするために実装できるアプローチは他にもあります（たとえば、証明書がデバイス上にあるかどうかを検証し、証明書がない場合はデプロイが可能な拡張属性など）。</p></li>
                                                            <li value="7"><span class="uicontrol">［Save（保存）］</span>をクリックします。</li>
                                                            <li value="8">左ペインの<span class="uicontrol">［Scripts（スクリプト）］</span>をクリックし、<span class="uicontrol">［Configure（設定）］</span>をクリックします。</li>
                                                            <li value="9">ステップ3でこのポリシー用に作成したスクリプトを見つけ、<span class="uicontrol">［Add（追加）］</span>をクリックします。</li>
                                                            <li value="10"><span class="uicontrol">［Scope（スコープ）］</span>をクリックします。</li>
                                                            <li value="11"><span class="uicontrol">［Target Computers（ターゲットコンピューター）］</span>および/または<span class="uicontrol">［Target Users（ターゲットユーザー）］</span>で、ポリシーの適用先となるコンピューターとユーザーを指定します。</li>
                                                            <li value="12"><span class="uicontrol">［Save（保存）］</span>をクリックします。</li>
                                                        </ol>
                                                        <li value="6"><a name="disable-keychain-syncing"></a>推奨。<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>でセキュリティ保護されているmacOSデバイスから他のAppleデバイスにiCloudでOktaキーチェーンが転送されないようにするには、Jamf Proで<span class="uicontrol">［Allo iCloud Keychain syncing（iCloudキーチェーン同期を許可）］</span>を無効にする設定プロファイルを作成する必要があります。


							<p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/disable-icloud-keychaing-sync.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="504" data-mc-height="292" src="../../resources/images/disable-icloud-keychaing-sync_thumb_220_220.png" tabindex="" /></a></p></li>
                                                        <li value="7">Jamf Proのログを確認し、Okta デバイス登録タスクが正常に実行されたことを確認します。
								<ol style="list-style-type: lower-alpha;"><li value="1"><span class="uicontrol">［Policies（ポリシー）］</span>に移動して、自分のポリシーをクリックします。</li><li value="2">画面下部の<span class="uicontrol">［Logs（ログ）］</span>をクリックします。</li></ol></li>
                                                        <li value="8"><a href="#Task5">「ステップ5. Oktaでアプリサインオンポリシールールを構成する」</a>に進みます。</li>
                                                    </ol>
                                                    <h3><span>ステップ5：</span><span> Oktaでアプリサインオンポリシールールを構成する</span>
                                                    </h3><a name="Task5"></a>
                                                    <h4>アプリサインオンポリシールールについて</h4>
                                                    <p>［App Sign On Rule（アプリサインオンルール）］ダイアログボックス内のすべてのクライアント​オプションはデフォルトで事前選択されています。アプリへのアクセスを詳細設定するには、以下を反映させるルールを作成します。</p>
                                                    <ul>
                                                        <li>対象となるユーザー、または対象者が属するグループ</li>
                                                        <li>対象者がネットワークに接続しているか、接続していないか、定義されたネットワークゾーンに属しているか</li>
                                                        <li>対象者のデバイスで実行されているクライアントのタイプ（<span class="mc-variable Mobile.O365 variable">Office 365</span>アプリのみ）</li>
                                                        <li>対象者のモバイルまたはデスクトップ​デバイスのプラットフォーム</li>
                                                        <li>対象者のデバイスが信頼されているかどうか</li>
                                                    </ul>
                                                    <div>
                                                        <h4>サインオンポリシールールへの許可リストによるアプローチ</h4>
                                                        <ul>
                                                            <ol>
                                                                <li value="1">アプリへのアクセスを許可するシナリオをサポートする1つまたは複数の許可ルールを作成し、これらのルールに最高優先度を割り当てます。 </li>
                                                                <li value="2">ステップ1で作成した許可シナリオに一致しないユーザーに適用するキャッチオール拒否ルールを作成します。キャッチオール拒否ルールに、デフォルトルールのすぐ上の最低優先度を割り当てます。ここで説明した許可リストのアプローチでは、デフォルトルールは事実上キャッチオール拒否ルールで否定されるため、これに達することはありません。</li>
                                                            </ol>
                                                            <div class="noteOkta">
                                                                <p class="noteContent">アプリサインオンポリシールールの作成に関する重要なセキュリティ情報については、「<a href="../security/policies/about-app-signon-policies.htm" class="MCXref xref">アプリのサインオンポリシー</a>」を参照してください。</p>
                                                            </div>
                                                        </ul>
                                                    </div>
                                                    <h3><a name="Procedur"></a>手順</h3>
                                                    <ol>
                                                        <li value="1"><span class="mc-variable okta-feature-names.Admin_Console variable">Admin Console</span>で、<span class="menucascade"><span class="uicontrol">［Applications（アプリケーション）］</span><span class="uicontrol">［Applications（アプリケーション）］</span></span>に移動します。<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>で保護するSAMLまたはWS対応のアプリをクリックします。</li>
                                                        <li value="2"><span class="uicontrol">［Sign On（サインオン）］</span>タブをクリックします。</li>
                                                        <li value="3">下にスクロールして<span class="uicontrol">［Sign On Policy（サインオンポリシー）］</span>に移動し、<span class="uicontrol">［Add Rule（ルールを追加）］</span>をクリックします。</li>
                                                        <li value="4">次の例をガイドとして使用して、1つ以上のルールを構成します。</li>
                                                    </ol>
                                                    <div class="noteOkta">
                                                        <p class="noteContent">この例は、Office 365へのアクセスを管理するための<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>ルールを示しています。他のアプリでは、［If the user's client is any of these（ユーザーのクライアントが次のいずれかに該当する場合）］セクションは表示されません。</p>
                                                    </div>
                                                    <h3>許可リストの例 </h3>
                                                    <h4>
            例：Rule 1 – Exchange ActiveSync; All platforms; Any trust; Allow access
        </h4><a name="WL-Rule1"></a>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-rules-2-1.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="608" data-mc-height="958" src="../../resources/images/dt-macos-rules-2-1_thumb_220_220.png" tabindex="" /></a>
                                                    </p>
                                                    <ol>
                                                        <li value="1">ルールにわかりやすい名前を付けて入力します。</li>
                                                    </ol>
                                                    <p><span class="uicontrol">［Conditions（条件）］</span>
                                                    </p>
                                                    <ol data-mc-continue="true">
                                                        <li value="2"><span class="uicontrol">［PEOPLE（ユーザー）］</span>で、ルールを個人のみに適用するか、個人とグループに適用するかを指定します。このオプションは、この例で作成するすべてのルールで同じでなければなりません。</li>
                                                        <li value="3"><span class="uicontrol">［LOCATION（ロケーション）］</span>で、ルールを適用するユーザーのロケーションを指定します。このオプションは、この例で作成するすべてのルールで同じでなければなりません。</li>
                                                        <li value="4"><span class="uicontrol">［CLIENT（クライアント）］</span>で、次の設定を構成します。</li>
                                                        <p><span class="uicontrol">［Web browser（Webブラウザー）］</span>の選択を解除します。</p>
                                                        <p><span class="uicontrol">［Modern Auth client（Modern Authクライアント）］</span>の選択を解除します。</p>
                                                        <p><span class="uicontrol">［Exchange ActiveSync client or Legacy Auth client（Exchange ActiveSyncクライアントまたはレガシー認証クライアント）］</span>を選択します。</p>
                                                        <p>モバイル									</p>
                                                        <p><span class="uicontrol">［iOS］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Android］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Other mobile（他のモバイル）］</span>を選択します。</p>
                                                        <p>デスクトップ</p>
                                                        <p><span class="uicontrol">［Windows］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［macOS］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Other desktop（他のデスクトップ）］</span>を選択します。</p>
                                                        <li value="5"><span class="uicontrol">［Device Trust］</span>で以下を構成します。</li>
                                                        <li value="6">
                                                            <div>
                                                                <p><span class="wintitle"><span class="mc-variable okta-feature-names.Device_Trust variable">［Device Trust（Device Trust）］</span></span>セクションの<span class="uicontrol">［Trusted（信頼）］</span>および<span class="uicontrol">［Not trusted（非信頼）］</span>オプションは、［Client（クライアント）］セクションの以下のオプションがどれも選択されていない場合にのみ選択可能です。</p>
                                                                <ul>
                                                                    <li>［Exchange ActiveSync or Legacy Auth client（Exchange ActiveSyncまたはレガシー認証クライアント）］</li>
                                                                    <li>［Other mobile (for example, BlackBerry)（他のモバイル（BlackBerryなど））］</li>
                                                                    <li>［Other desktop (for example, Linux)（他のデスクトップ（Linuxなど））］</li>
                                                                </ul>
                                                            </div>
                                                        </li>
                                                        <p><span class="uicontrol">［Any（すべて）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Trusted（信頼）］</span>を選択解除します。</p>
                                                        <p><span class="uicontrol"> ［Not trusted（非信頼）］</span>を選択解除します。</p>
                                                    </ol>
                                                    <p>［ACTIONS（アクション）］</p>
                                                    <ol data-mc-continue="true">
                                                        <li value="7"><span class="uicontrol">［Access（アクセス）］</span>を構成します。</li>
                                                        <p><span class="uicontrol">［Allowed（許可）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Prompt for factor（要素をプロンプト）］</span>を選択解除します。</p>
                                                        <li value="8"><span class="uicontrol">［Save（保存）］</span>をクリックします。</li>
                                                        <li value="9">［Rule 2（ルール2）］を作成します。</li>
                                                    </ol>
                                                    <h4>
           例：Rule 2 – Web browser or Modern Auth; macOS; Trusted; Allow access
        </h4><a name="WL-Rule2"></a>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-rules-2-2.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="603" data-mc-height="730" src="../../resources/images/dt-macos-rules-2-2_thumb_220_220.png" tabindex="" /></a>
                                                    </p>
                                                    <ol>
                                                        <li value="1">ルールにわかりやすい名前を付けて入力します。</li>
                                                    </ol>
                                                    <p>条件</p>
                                                    <ol data-mc-continue="true">
                                                        <li value="2">
									<span class="uicontrol">［PEOPLE（ユーザー）］</span>で、<a href="#WL-Rule1">［Rule 1（ルール1）］</a>で選択したものと同じ［People（ユーザー）］オプションを選択します。このオプションは、この例で作成するすべてのルールで同じでなければなりません。</li>
                                                        <li value="3"><span class="uicontrol">［LOCATION（ロケーション）］</span>で、<a href="#WL-Rule1">［Rule 1（ルール1）］</a>で選択したものと同じ［Location（ロケーション）］オプションを選択します。このオプションは、この例で作成するすべてのルールで同じでなければなりません。</li>
                                                        <li value="4"><span class="uicontrol">［CLIENT（クライアント）］</span>で、次の設定を構成します。</li>
                                                        <p><span class="uicontrol">［Web browser（Webブラウザー）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Modern Auth client（Modern Authクライアント）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Exchange ActiveSync client（Exchange ActiveSyncクライアント）］</span>を選択解除します。</p>
                                                        <p>モバイル									</p>
                                                        <p><span class="uicontrol">［iOS］</span>を選択解除します。</p>
                                                        <p><span class="uicontrol">［Android］</span>を選択解除します。</p>
                                                        <p> ［Other mobile（他のモバイル）］を選択解除します。</p>
                                                        <p>デスクトップ</p>
                                                        <p><span class="uicontrol"> ［Windows］</span>を選択解除します。</p>
                                                        <p><span class="uicontrol">［macOS］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Other desktop（他のデスクトップ）］</span>を選択解除します。</p>
                                                        <li value="5"><span class="uicontrol">［Device Trust（Device Trust）］</span>で以下を構成します。</li>
                                                        <li value="6">
                                                            <div>
                                                                <p><span class="wintitle"><span class="mc-variable okta-feature-names.Device_Trust variable">［Device Trust（Device Trust）］</span></span>セクションの<span class="uicontrol">［Trusted（信頼）］</span>および<span class="uicontrol">［Not trusted（非信頼）］</span>オプションは、［Client（クライアント）］セクションの以下のオプションがどれも選択されていない場合にのみ選択可能です。</p>
                                                                <ul>
                                                                    <li>［Exchange ActiveSync or Legacy Auth client（Exchange ActiveSyncまたはレガシー認証クライアント）］</li>
                                                                    <li>［Other mobile (for example, BlackBerry)（他のモバイル（BlackBerryなど））］</li>
                                                                    <li>［Other desktop (for example, Linux)（他のデスクトップ（Linuxなど））］</li>
                                                                </ul>
                                                            </div>
                                                        </li>
                                                        <p><span class="uicontrol">［Any（すべて）］</span>を選択解除します。</p>
                                                        <p><span class="uicontrol">［Trusted（信頼）］</span> を選択します。</p>
                                                        <p><span class="uicontrol"> ［Not trusted（非信頼）］</span>を選択解除します。</p>
                                                    </ol>
                                                    <p><span class="wintitle">アクション</span>
                                                    </p>
                                                    <ol data-mc-continue="true">
                                                        <li value="7"><span class="uicontrol">［Access（アクセス）］</span>を構成します。</li>
                                                        <p><span class="uicontrol">［Allowed（許可）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Prompt for factor（要素をプロンプト）］</span>を選択解除します。</p>
                                                        <li value="8"><span class="uicontrol">［Save（保存）］</span>をクリックします。</li>
                                                        <li value="9">［Rule 3（ルール3）］を作成します。</li>
                                                    </ol>
                                                    <h4>
          例：Rule 3 – Web browser or Modern Auth; All platforms except macOS; Any Trust; Allow access + MFA
        </h4><a name="WL-Rule3"></a>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-rules-2-3.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="610" data-mc-height="1110" src="../../resources/images/dt-macos-rules-2-3_thumb_220_220.png" tabindex="" /></a>
                                                    </p>
                                                    <ol>
                                                        <li value="1">ルールにわかりやすい名前を付けて入力します。</li>
                                                    </ol>
                                                    <p><span class="wintitle">［Conditions（条件）］</span>
                                                    </p>
                                                    <ol data-mc-continue="true">
                                                        <li value="2">
									<span class="wintitle">［PEOPLE（ユーザー）］</span>で、<a href="#WL-Rule1">［Rule 1（ルール1）］</a>で選択したものと同じ［People（ユーザー）］オプションを選択します。このオプションは、この例で作成するすべてのルールで同じでなければなりません。</li>
                                                        <li value="3"><span class="wintitle">［LOCATION（ロケーション）］</span>で、<a href="#WL-Rule1">［Rule 1（ルール1）］</a>で選択したものと同じ［Location（ロケーション）］オプションを選択します。このオプションは、この例で作成するすべてのルールで同じでなければなりません。</li>
                                                        <li value="4"><span class="wintitle">［CLIENT（クライアント）］</span>で、次の設定を構成します。</li>
                                                        <p><span class="uicontrol">［Web browser（Webブラウザー）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Modern Auth client（Modern Authクライアント）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Exchange ActiveSync client（Exchange ActiveSyncクライアント）］</span>を選択解除します。</p>
                                                        <p>モバイル									</p>
                                                        <p><span class="uicontrol">［iOS］</span>を選択解除します。</p>
                                                        <p><span class="uicontrol">［Android］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Other mobile（他のモバイル）］</span>を選択します。</p>
                                                        <p>デスクトップ</p>
                                                        <p><span class="uicontrol">［Windows］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［macOS］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Other desktop（他のデスクトップ）］</span>を選択します。</p>
                                                        <li value="5"><span class="wintitle">［Device Trust］</span>で以下を構成します。</li>
                                                        <li value="6">
                                                            <div>
                                                                <p><span class="wintitle"><span class="mc-variable okta-feature-names.Device_Trust variable">［Device Trust（Device Trust）］</span></span>セクションの<span class="uicontrol">［Trusted（信頼）］</span>および<span class="uicontrol">［Not trusted（非信頼）］</span>オプションは、［Client（クライアント）］セクションの以下のオプションがどれも選択されていない場合にのみ選択可能です。</p>
                                                                <ul>
                                                                    <li>［Exchange ActiveSync or Legacy Auth client（Exchange ActiveSyncまたはレガシー認証クライアント）］</li>
                                                                    <li>［Other mobile (for example, BlackBerry)（他のモバイル（BlackBerryなど））］</li>
                                                                    <li>［Other desktop (for example, Linux)（他のデスクトップ（Linuxなど））］</li>
                                                                </ul>
                                                            </div>
                                                        </li>
                                                        <p><span class="uicontrol">［Any（すべて）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Trusted（信頼）］</span>を選択解除します。</p>
                                                        <p><span class="uicontrol"> ［Not trusted（非信頼）］</span>を選択解除します。</p>
                                                    </ol>
                                                    <p><span class="wintitle">アクション</span>
                                                    </p>
                                                    <ol data-mc-continue="true">
                                                        <li value="7"><span class="uicontrol">［Access（アクセス）］</span>を構成します。</li>
                                                        <p><span class="uicontrol">［Allowed（許可）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Prompt for factor（要素をプロンプト）］</span>を選択します。</p>
                                                        <li value="8"><span class="uicontrol">［Save（保存）］</span>をクリックします。</li>
                                                        <li value="9">［Rule 4（ルール4）］を作成します。</li>
                                                    </ol>
                                                    <h4>
            例：Rule 4 – Any client type; All platforms; Any Trust; Deny access
        </h4><a name="WL-Rule4"></a>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-rules-2-4.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="611" data-mc-height="842" src="../../resources/images/dt-macos-rules-2-4_thumb_220_220.png" tabindex="" /></a>
                                                    </p>
                                                    <ol>
                                                        <li value="1">ルールにわかりやすい名前を付けて入力します。</li>
                                                    </ol>
                                                    <p>条件</p>
                                                    <ol data-mc-continue="true">
                                                        <li value="2">
									<span class="wintitle">［PEOPLE（ユーザー）］</span>で、<a href="#WL-Rule1">［Rule 1（ルール1）］</a>で選択したものと同じ［People（ユーザー）］オプションを選択します。このオプションは、この例で作成するすべてのルールで同じでなければなりません。</li>
                                                        <li value="3"><span class="wintitle">［LOCATION（ロケーション）］</span>で、<a href="#WL-Rule1">［Rule 1（ルール1）］</a>で選択したものと同じ［Location（ロケーション）］オプションを選択します。このオプションは、この例で作成するすべてのルールで同じでなければなりません。</li>
                                                        <li value="4"><span class="wintitle">［CLIENT（クライアント）］</span>で、次の設定を構成します。</li>
                                                        <p><span class="uicontrol">［Web browser（Webブラウザー）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Modern Auth client（Modern Authクライアント）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Exchange ActiveSync client（Exchange ActiveSyncクライアント）］</span>を選択します。</p>
                                                        <p>モバイル									</p>
                                                        <p><span class="uicontrol">［iOS］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Android］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Other mobile（他のモバイル）］</span>を選択します。</p>
                                                        <p>デスクトップ</p>
                                                        <p><span class="uicontrol">［Windows］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［macOS］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Other desktop（他のデスクトップ）］</span>を選択します。</p>
                                                        <li value="5"><span class="wintitle">［Device Trust］</span>で以下を構成します。</li>
                                                        <li value="6">
                                                            <div>
                                                                <p><span class="wintitle"><span class="mc-variable okta-feature-names.Device_Trust variable">［Device Trust（Device Trust）］</span></span>セクションの<span class="uicontrol">［Trusted（信頼）］</span>および<span class="uicontrol">［Not trusted（非信頼）］</span>オプションは、［Client（クライアント）］セクションの以下のオプションがどれも選択されていない場合にのみ選択可能です。</p>
                                                                <ul>
                                                                    <li>［Exchange ActiveSync or Legacy Auth client（Exchange ActiveSyncまたはレガシー認証クライアント）］</li>
                                                                    <li>［Other mobile (for example, BlackBerry)（他のモバイル（BlackBerryなど））］</li>
                                                                    <li>［Other desktop (for example, Linux)（他のデスクトップ（Linuxなど））］</li>
                                                                </ul>
                                                            </div>
                                                        </li>
                                                        <p><span class="uicontrol">［Any（すべて）］</span>を選択します。</p>
                                                        <p><span class="uicontrol">［Trusted（信頼）］</span>を選択解除します。</p>
                                                        <p><span class="uicontrol"> ［Not trusted（非信頼）］</span>を選択解除します。</p>
                                                    </ol>
                                                    <p><span class="wintitle">アクション</span>
                                                    </p>
                                                    <ol data-mc-continue="true">
                                                        <li value="7"><span class="uicontrol">［Access（アクセス）］</span>を構成します。</li>
                                                        <p><span class="uicontrol">［Denied（拒否）］</span>を選択します。</p>
                                                        <li value="8"><span class="uicontrol">［Save（保存）］</span>をクリックします。</li>
                                                    </ol>
                                                    <h4>例：Rule 5, Default sign on rule – Any client, All platforms; Any Trust; Allow access</h4>
                                                    <p>デフォルトサインオンルールは作成済みであり、編集できません。この例では、デフォルトルールがルール4により実質的に無効化されているため、デフォルトルールに到達することはありません。 </p>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-rules-default.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="609" data-mc-height="961" src="../../resources/images/dt-macos-rules-default_thumb_220_220.png" tabindex="" /></a>
                                                    </p>
                                                    <h2><span style="font-size: 14pt;"><span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書の失効と削除 </span>
                                                    </h2><a name="Task3"></a>
                                                    <p>Okta認証局からエンドユーザーの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書を撤回する必要がある場合があります。コンピューターを紛失、盗難した場合や、エンドユーザーがディアクティベートされた場合などに推奨されます。<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書を撤回した後で、エンドユーザーのコンピューターを<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>で再度保護するには、新しい証明書を登録する前に、撤回した証明書をコンピューターから削除する必要があります。</p>
                                                    <div>
                                                        <ul>
                                                            <li>この手順のステップ1～4では、Okta認証局からエンドユーザーに発行されたすべての<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書が失効になります。証明書の失効は、macOSコンピューターから既存の証明書を削除するものではありません。証明書を取り消した後にmacOSコンピューターを<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>で再び保護するには、まず既存のDevice Trust証明書をコンピューターから削除してから、<a href="#remove-cert">ステップ5</a>に従い新しい証明書を使用してコンピューターを再登録する必要があります。デバイス登録タスクでは、コンピューターに別の証明書が存在する場合（失効したかどうかにかかわらず）、新しい証明書は登録されません。</li>
                                                            <li>エンドユーザーがディアクティベートされると、Okta認証局からの<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書も自動的に失効します（ただし、コンピューターから証明書が削除されるわけではありません）。証明書をコンピューターから削除する場合は、手順5のいずれかの方法で削除してください。</li>
                                                        </ul>
                                                        <ol>
                                                            <li value="1">
                                                                <p><span class="mc-variable okta-feature-names.Admin_Console variable">Admin Console</span>で、<span class="menucascade"><span class="uicontrol">［Directory（ディレクトリ）］</span><span class="uicontrol">［PEOPLE（ユーザー）］</span></span>に進みます。</p>
                                                            </li>
                                                            <li value="2">
                                                                <p><span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書を失効させるエンドユーザーをクリックします。</p>
                                                            </li>
                                                            <li value="3">
							<span class="wintitle">［More Actions（その他のアクション）］</span>メニューで、<span class="uicontrol">［Revoke Trust Certificate（信頼証明書を取り消す）］</span>をクリックします。


					<p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt_revoketrustcert_80per.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="818" data-mc-height="634" src="../../resources/images/dt_revoketrustcert_80per_thumb_220_220.png" tabindex="" /></a></p></li>
                                                            <li value="4">
                                                                <p>表示されるメッセージを確認し、<span class="uicontrol">［Revoke Trust Certificate（信頼証明書を取り消す）］</span>をクリックします。</p>
                                                            </li>
                                                            <li value="5"><a name="remove-cert"></a>何らかの理由で<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書を削除する場合は（コンピューターを<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>で再び保護する前など）、まず既存の<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書をコンピューターから削除します。Jamf Proでは、コマンドラインを使用するか、アンインストール・スクリプトを作成することができます。どちらのアンインストール方法でも、macOSデバイスから<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>に関連するすべてのアーチファクトが削除されます。</li>
                                                            <div class="noteOkta">
                                                                <p class="noteContent">「<a href="#Step" class="MCXref xref">ステップ2：Okta デバイス登録タスクを変更する</a>」でダウンロードして変更したスクリプトを再利用する場合は、使用する前にOrgのトークンを削除してください。また、アンインストール操作にはトークンは必要ありません。</p>
                                                            </div>
                                                            <ul>
                                                                <li>コマンドラインを使用して削除：ターゲットコンピューターでターミナルを開き、<span class="code">python &lt;fileName&gt;.py uninstall</span>コマンドを発行します。ここで<span class="code">&lt;fileName&gt;</span>はOkta デバイス登録タスクの名前です。たとえば、Okta Registration Taskの名前が<span class="code">MacOktaDeviceRegistrationTaskSetup.1.0.2.py</span>の場合、以下のコマンドを発行します。
                                    <p><span class="code">python MacOktaDeviceRegistrationTaskSetup.1.0.2.py uninstall</span></p></li>
                                                                <li>アンインストールスクリプトで削除：<span class="code">uninstall</span>パラメーターを渡すように構成したアンインストール・スクリプトをJamf Proで作成します。詳細については、Jamf Proのドキュメントの<a href="http://docs.jamf.com/10.6.0/jamf-pro/administrator-guide/Managing_Scripts.html#src-18787582_id-.ManagingScriptsv10.6.0-AddingaScripttoJamfPro" target="_blank">「Adding a Script to Jamf Pro」</a>の手順を参照してください。</li>
                                                            </ul>
                                                        </ol>
                                                    </div>
                                                    <h2><a name="PartF"></a><span style="font-size: 14pt;">証明書登録のログを表示する </span>
                                                    </h2>
                                                    <h3><a name="View"></a>Jamf Proでログを表示する</h3>
                                                    <p>デプロイ中、Okta デバイス登録タスクは、3つのログレベル（INFO、WARN、ERROR）でJamfにログを公開します。Jamfの管理者はデプロイに関する問題を診断する手段として、ポリシー単位またはコンピューター単位でデプロイ・ログを確認することができます。より詳細なログを生成するには、Jamf Proの［Parameter Value（パラメーター値）］として<span class="code">［verbose（詳細）］</span>オプションを使用します。 </p>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-jamf-policy-logs-verbose.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="825" data-mc-height="323" src="../../resources/images/dt-macos-jamf-policy-logs-verbose_thumb_220_220.png" tabindex="" /></a>
                                                    </p>
                                                    <p>また、エンドユーザーは、自分のコンピューターでスクリプトを実行中にコンソール・アプリを開くことで、ローカルのmacOSコンピューターでログ・メッセージを表示することができます。</p>
                                                    <h3>macOSコンピューターでログを表示する</h3>
                                                    <p>証明書の登録中にOkta関連のログ・メッセージを監視・モニタリングすることができます。その方法は、デバイスで動作しているオペレーティングシステムによって異なります。
								</p>
                                                    <h4>バージョン10.11.6（OS X El Capitan）を実行している場合：</h4>
                                                    <ol>
                                                        <li value="1"><span class="menucascade"><span class="uicontrol">［Utilities（ユーティリティ）］</span><span class="uicontrol">［Console（コンソール）］</span></span>を開きます。</li>
                                                        <li value="2"><span class="uicontrol">［All Messages（すべてのメッセージ）］</span>をクリックします。</li>
                                                        <li value="3">［Search（検索）］フィールドにOktaと入力し、Enterキーを押すと、Okta関連のメッセージがすべてフィルタリングされます。
									</li>
                                                    </ol>
                                                    <h4>以下のオペレーティングシステムのいずれかを実行している場合：</h4>
                                                    <ul>
                                                        <li>macOS 10.12.6 (Sierra)</li>
                                                        <li>macOS 10.13.4 (High Sierra)</li>
                                                    </ul>
                                                    <ol>
                                                        <li value="1"><span class="menucascade"><span class="uicontrol">［Utilities（ユーティリティ）］</span><span class="uicontrol">［Console（コンソール）］</span></span>を開きます。</li>
                                                        <li value="2">左ペインの<span class="uicontrol">［Devices（デバイス）］</span>の下で、自分のデバイスをクリックします。</li>
                                                        <li value="3">［Search（検索）］フィールドにOktaと入力し、Enterキーを押すと、Okta関連のメッセージがすべてフィルタリングされます。</li>
                                                    </ol>
                                                    <h4>サポートされているすべてのオペレーティングシステムの過去ログを表示するには、次のようにします。</h4>
                                                    <ol>
                                                        <li value="1"><span class="menucascade"><span class="uicontrol">［Utilities（ユーティリティ）］</span><span class="uicontrol">［Console（コンソール）］</span></span>を開きます。</li>
                                                        <li value="2">左ペインの<span class="filepath">/var/log &gt; asl</span>に移動します。</li>
                                                        <li value="3">検索したい日付を選択します。</li>
                                                        <li value="4">［Search（検索）］フィールドにOktaと入力し、Enterキーを押すと、Okta関連のメッセージがすべてフィルタリングされます。</li>
                                                    </ol>
                                                    <h4>デバイス上で実行されたシステム呼び出しを確認するには、以下のコマンドを実行した後、デバイス登録タスクを実行します。</h4>
                                                    <p><span class="code">log stream --predicate 'eventMessage contains &quot;okta&quot;'</span>
                                                    </p>
                                                    <h2><span style="font-size: 14pt;">デフォルトのアプリの許可リストを変更する</span>
                                                    </h2><a name="PartG"></a>
                                                    <p>Okta デバイス登録タスクは、エンドユーザーがアクセスしようとするときにキーチェーンパスワードの入力を求められないように、いくつかの人気アプリをデフォルトで許可します。この手順で説明するように、デフォルトの許可リストをカスタマイズすることができます。 </p>
                                                    <p>以下の点に注意してください。 </p>
                                                    <ul>
                                                        <li>優先する許可リストのコピーを取っておいてください。変更した許可リストは、ターゲットのmacOSコンピューターに新しいOkta デバイス登録タスクをプッシュするたびに上書きされるため、作成し直す必要があります。 </li>
                                                        <li>Oktaが定義した元の許可リストにアプリを追加する場合、変更した許可リストをすべてのユーザーに展開する前に、サブセットのユーザーでテストすることを検討してください。
                                        </li>
                                                        <li>他の許可されたアプリのTeamIdentifierとは異なり、SafariのTeamIdentifierは単純に<span class="code">apple:</span>となります（コロンに注目）。<span class="code">teamid:</span>のプレフィックスはありません。 </li>
                                                        <li> SAML/WS-Fedに対応したアプリで、Webビューによる認証をサポートしているものであれば、許可することができます。認証を行うWebビューは、デバイス上のOktaキーチェーンにアクセス可能でなければなりません。現在、Oktaが提供するオリジナルの許可リストには、以下のアプリが含まれています。

										<ul><li>Box</li><li>Chrome</li><li>Safari</li><li>Microsoft Office</li><li>Skype for Business</li><li>Googleドライブ</li><li>Slack</li></ul></li>
                                                    </ul>
                                                    <ol>
                                                        <li value="1">許可するアプリのTeamIdentifierを見つけます。</li>
                                                        <ol style="list-style-type: lower-alpha;">
                                                            <li value="1">許可したいアプリがあるmacOSデバイスで、コマンドラインを開き、［Applications（アプリケーション）］フォルダ内のアプリをリストアップします。 </li>
                                                            <p><span class="code">ls /Applications</span>
                                                            </p>
                                                            <li value="2">アプリのTeamIdentifier「<span class="code">codesign -dv --verbose=4 /Applications/exampleapp.app</span>」を見つけます。</li>
                                                            <p><span class="code">exampleapp</span>は調査対象のアプリとなります。
                                        </p>
                                                            <li value="3">出力されたTeamIdentifierの値を特定し、メモしておいてください。 </li>
                                                            <p>たとえば、RingCentralのチームのTeamIdentifierを見つける方法は以下のとおりです。</p>
                                                            <p><span class="code">codesign -dv --verbose=4/App /Applications/RingCentral\ Meetings.app</span>
                                                            </p>
                                                            <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-teamid-ring-central.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="696" data-mc-height="341" src="../../resources/images/dt-teamid-ring-central_thumb_220_220.png" tabindex="" /></a>
                                                            </p>
                                                        </ol>
                                                        <li value="2">Okta デバイス登録タスクの許可リストを修正します。</li>
                                                        <h4>修正前の例 </h4>
                                                        <p>許可リストには、Oktaが定義したオリジナルの許可リストが含まれます。</p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-allowlist-before-mod.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1161" data-mc-height="105" src="../../resources/images/dt-macos-allowlist-before-mod_thumb_220_220.png" tabindex="" /></a>
                                                        <h4>修正後の例</h4>
                                                        <p> RingCentralを追加した許可リスト：</p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-allowlist-after-mod.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1162" data-mc-height="106" src="../../resources/images/dt-macos-allowlist-after-mod_thumb_220_220.png" tabindex="" /></a>
                                                        <li value="3">変更を保存します。</li>
                                                        <li value="4"> 必要に応じて、Okta デバイス登録タスクをプッシュします。<a href="#Task4">「ステップ4. 変更したOkta デバイス登録タスクをJamf Proに追加してmacOSデバイスに配布する」</a>を参照してください。</li>
                                                    </ol>
                                                    <div class="noteOkta">
                                                        <p class="noteContent">優先する許可リストのコピーを取っておいてください。変更した許可リストは、ターゲットのmacOSコンピューターに新しいOkta デバイス登録タスクをプッシュするたびに上書きされるため、作成し直す必要があります。</p>
                                                    </div>
                                                    <div>
                                                        <h2><a name="Troubleshooting_dt-macOS"></a><span style="font-size: 14pt;">トラブルシューティング</span>
                                                        </h2>
                                                        <p>Oktaデバイス登録タスクは、Oktaから入手したPythonスクリプトであり、これを修正してJamf Proにアップロードし、この<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>ソリューションのターゲットとなるmacOSデバイスに配布します。</p>
                                                        <h4>Okta デバイス登録タスクについて</h4>
                                                        <p>デバイスにデプロイすると、Okta デバイス登録タスクは次のように動作します。</p>
                                                        <ul>
                                                            <li>
                                                                <p>Oktaに登録して、<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書を取得します。Oktaは、Jamf Proを調べて、デバイスが管理されていることを確認します。</p>
                                                            </li>
                                                            <li>
                                                                <p>デバイスのChromeおよびSafariブラウザーとテスト済みのネイティブアプリを、安全なアプリアクセスの際に証明書を自動的に提示するように構成します。</p>
                                                            </li>
                                                            <li>
                                                                <p>1日1回、ユーザーがコンピューターにログインするたびに実行される軽量なタスクをスケジュール設定します。<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>証明書の有効期限を確認し、有効期限の30日前に更新を試みるタスクです。証明書の有効期限は1年間です。</p>
                                                            </li>
                                                            <li>更新時に、Oktaは新しい証明書を発行する前にデバイスが管理されているかを確認するなど、登録時と同様のチェックを行います。</li>
                                                            <li>スクリプトが一度デバイス上で実行されると、Jamf Proはデバイスから自動的にスクリプトを削除します。</li>
                                                            <li>デバイスにインストールされている登録タスクのバージョンを確認するには、以下のクエリを使用します：<span class="codeblock">python3 ~/Library/Okta/okta_device_trust.py version</span><p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-flow.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1256" data-mc-height="817" src="../../resources/images/dt-macos-flow_thumb_220_220.png" tabindex="" /></a></p></li>
                                                        </ul>
                                                        <h4>基本的なトラブルシューティングと高度なトラブルシューティング</h4>
                                                        <p> 次の2つが最も遭遇しやすい問題です。</p>
                                                        <ul>
                                                            <li>信頼済みのデバイスが、<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>でセキュリティ保護されたアプリにアクセスできない。</li>
                                                            <li>非信頼デバイスが、<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>でセキュリティ保護されたアプリにアクセスできてしまう。</li>
                                                        </ul>
                                                        <p>いずれかの問題が発生した場合は、「基本的なトラブルシューティング」を実行して修正を試みてください。問題が解決しない場合は、「高度なトラブルシューティング」を実行してください。</p>
                                                        <h3><a name="BasicTroubleshooting_dt-macOS"></a>基本的なトラブルシューティング</h3>
                                                        <p>基本的なトラブルシューティングを行うには、次の領域を確認します。</p>
                                                        <h4>有効化</h4>
                                                        <p>以下を確認します：</p>
                                                        <ul>
                                                            <li>このデバイス信頼機能が、OrgのOktaのバージョン（SKU）に含まれている。 </li>
                                                            <li><span class="menucascade"><span class="uicontrol">［Security（セキュリティ）］</span><span class="uicontrol">［Device Trust（Device Trust）］</span><span class="uicontrol">［</span><span class="uicontrol"><span class="mc-variable okta-feature-names.Device_Trust variable">Enable macOS Device Trust（macOSのDevice Trustを有効にする）］</span></span></span>で<a href="#Task1">グローバルな<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>設定を有効</a>にしている。
            </li>
                                                        </ul>
                                                        <h4>Registration Task</h4>
                                                        <ul>
                                                            <p>
                                                                <li>
                                                                    <p><a href="#Task4">パートC</a>で説明したように、Jamf ProがターゲットとなるmacOSデバイスにデバイス登録タスクを配布するよう正しく設定されていることを確認します。</p>
                                                                </li>
                                                            </p>
                                                            <p>以下のクエリを使用して、デバイス上で実行されているRegistration Taskのバージョンを確認することができます。


									<p><span class="code">python ~/Library/Okta/okta_device_trust.py version</span></p><li><p>Python 3スクリプトをデプロイする前に、アプリのTeamIDを追加したことを確認してください。</p></li></p>
                                                            <p>アプリのTeamIDがスクリプトから欠落している場合、お使いの環境で以前にDevice Trustと連携していたサードパーティ・アプリからサインオンしようとすると、アクセス・プロンプトが表示されます。<p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/devices_dt_troubleshoot_teamid_1.png" data-mc-popup-alt="Access prompt example"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="426" data-mc-height="160" src="../../resources/images/devices_dt_troubleshoot_teamid_1_thumb_220_220.png" alt="アクセス・プロンプトの例" title="サードパーティ・アプリからのアクセスプ・ロンプトの例" tabindex="" /></a></p></p>
                                                            <p>Python 3スクリプトにアプリのTeamIDを追加し、ポリシーを再デプロイします。この画像は、許可リストに登録するアプリを指定するにあたってクリプトを編集するセクションを示しています。
				<p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/devices_dt_troubleshoot_teamid_2.png" data-mc-popup-alt="Python 3 script section"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1059" data-mc-height="229" src="../../resources/images/devices_dt_troubleshoot_teamid_2_thumb_220_220.png" alt="Python 3スクリプトのセクション" title="編集するPython 3スクリプトのセクションで、許可リストに登録するアプリを指定します。" tabindex="" /></a></p></p>
                                                        </ul>
                                                        <h4>Python 3の依存関係パッケージ</h4>
                                                        <p>Python 3の依存関係パッケージは正しくインストールされていますか？</p>
                                                        <p>「Module NotFoundError: No module named 'Systemconfiguration'」などのモジュールが見つからないエラーが発生した場合は、［link to 'install Device Trust dependencies'］の依存関係が正しく設定されていることを確認してください。 </p>
                                                        <p>コンピューターでJamfから以下のスクリプトを実行します。</p>
                                                        <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">コピー</a>
                                                            <div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="True"><pre><span class="codeSnippetLineNumbers" style="border-right: #AAA 2px solid;" aria-hidden="true">1
2
3
4
5
6
7
8
9
</span><code>#!/bin/sh<br />echo &quot;Python location&quot;<br />python3 -c &quot;import sys; print(sys.executable)&quot;<br />echo &quot;Python version&quot;<br />python3 --version<br />echo &quot;Python3 Dependency version&quot;<br />echo &quot;********************&quot;<br />python3 -m pip show pyobjc-framework-SystemConfiguration<br />echo &quot;********************&quot;</code></pre>
                                                            </div>
                                                        </div>
                                                        <h3>証明書</h3>
                                                        <div>
                                                            <h4>証明書がインストールされていることを確認します。</h4>
                                                            <p>このDevice Trustソリューションの対象となるデバイスのキーチェーンに証明書がインストールされていることを確認します。証明書がインストールされておらず、アプリサインオンポリシーで［Trusted（信頼）］設定が有効な場合、ユーザーはアプリへのアクセスが拒否され、管理者に連絡するように促すセキュリティメッセージにリダイレクトされます（詳細情報への<span class="uicontrol">［Learn more（詳細）］</span>リンクを含めるようにメッセージを設定できます。<a href="#learn-more-link">「ステップ1 - OrgのグローバルDevice Trust設定を有効にする」</a>を参照してください）。 </p>
                                                            <h5>ターミナルからインストールを確認するには、以下のようにします。</h5>
                                                            <h4>キーチェーン情報を表示する</h4>
                                                            <p><span class="code">security show-keychain-info okta.keychain</span>
                                                            </p>
                                                            <h4>証明書を表示する</h4>
                                                            <p><span class="code">security find-certificate -a -c 'Okta MTLS' -Z -p okta.keychain</span>
                                                            </p>
                                                            <h4>パスワードを表示する</h4>
                                                            <p><span class="code">security find-generic-password -l device_trust -w</span>
                                                            </p>
                                                            <h4>ターゲットとなるデバイスのGUIでインストールを確認する場合は、以下のようにします。</h4>
                                                            <div>
                                                                <ol>
                                                                    <li value="1">macOSデバイスで、「キーチェーンアクセス」を検索します。</li>
                                                                    <li value="2">ダブルクリックすると、キーチェーンアクセスアプリが起動します。</li>
                                                                    <li value="3">Oktaキーチェーンが存在し、Okta MTLS認証が含まれていることを確認します。</li>
                                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-keychain-troubleshooting.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="877" data-mc-height="357" src="../../resources/images/dt-macos-keychain-troubleshooting_thumb_220_220.png" tabindex="" /></a>
                                                                    </p>
                                                                    <p>Oktaキーチェーン、証明書、または秘密鍵がない場合、登録タスクは正常に完了しませんでした。<a href="#View">Jamf Proでログを表示</a>します。 </p>
                                                                    <li value="4"><span class="uicontrol">［login（ログイン）］</span>キーチェーンに、device_trustパスワードとID環境設定が表示されることを確認します。 </li>
                                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-keychain-pw-troubleshooting.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="984" data-mc-height="762" src="../../resources/images/dt-macos-keychain-pw-troubleshooting_thumb_220_220.png" tabindex="" /></a>
                                                                    </p>
                                                                    <p><span class="varname">device_trust</span>パスワードが存在しない場合、Device Trustをセキュリティ保護したアプリはOktaキーチェーンにアクセスすることができません。これを解決するには、証明書をアンインストールします。「<a href="#Task3">Device Trust証明書の取り消しと削除</a>」を参照してください。デバイスを再登録します。<a href="#Task4">「ステップ4. 変更したOkta デバイス登録タスクをJamf Proに追加してmacOSデバイスに配布する」</a>を参照してください。</p>
                                                                </ol>
                                                            </div>
                                                        </div>
                                                        <div>
                                                            <h3>証明書の最大登録数</h3>
                                                            <p> Device Trustで保護されたmacOSデバイスから、信頼が保護されたアプリケーションにユーザーが初めてアクセスしたときに証明書は特定のユーザーにバインドされます。未使用の証明書はバインドが解除されます。Oktaでは、登録手続きを行うたびに、1つずつ、アンバウンド証明書を最大5件までデバイスに対して発行することができます。セキュリティ対策として、Oktaでは特定のデバイスに対してアンバウンド証明書を6件以上発行しないようにしています。アンバウンド証明書の上限に達しないようにするには、登録によってさらに証明書を取得しようとする前に、ユーザーがデバイスに既存するアンバウンド証明書を使用していることを確認する必要があります。登録の上限に達すると、Syslogに登録エラーが表示され、JAMFログに<span class="uicontrol">「Maximum enrollment limit of 5 certificates for a device is reached（デバイスの証明書が登録上限の5件に達しました）」</span>というエラー​メッセージが表示されます。</p>
                                                        </div>
                                                        <div>
                                                            <h3><a name="MTLS-handshake"></a>相互のTLS証明書交換のブロックによる認証失敗の防止
</h3>
                                                            <div>
                                                                <p data-mc-conditions="SnippetConditionsForDevices.macOS Only">この<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>フローの相互TLS証明書の交換（ハンドシェイク）は、Okta orgのURLとは別のOktaのURLで行われます（以下の例ではワイルドカード文字（*）で示されています）。エンドポイント保護ソフトウェアをOrgで実装している場合は、この<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>フローで行われる相互のTLS証明書交換（ハンドシェイク）をブロックしない方法で設定してください。たとえば、許可リストを使用して送信トラフィックを制限している場合、ワイルドカード文字（*）を含めたこれらの正確なURLを許可リストに追加します。</p>
                                                                <p><span class="code">*.okta.com</span>
                                                                </p>
                                                                <p><span class="code">*.okta-emea.com</span>
                                                                </p>
                                                                <p><span class="code">*.okta-gov.com</span>
                                                                </p>
                                                            </div>
                                                        </div>
                                                        <h5>サインオンポリシー</h5>
                                                        <p>次のようなサインオンポリシーが設定されていることを確認します。</p>
                                                        <ul>
                                                            <li><span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>で保護したいWS-FedまたはSAMLアプリ（複数可）に適用されている。</li>
                                                            <li>正しいユーザーおよび/またはグループに適用されている。</li>
                                                            <li>最低限、非信頼デバイスへのアクセスを拒否するアクティブなルールが含まれている。</li>
                                                        </ul>
                                                        <h4><a name="DT_macOS_SysLog"></a>システムログ</h4>
                                                        <div>
                                                            <h3><span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>イベントの検証</h3>
                                                            <p><a href="../reports/reports_syslog.htm" rel="noreferrer" target="_blank">システムログ</a>を確認し、以下の<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>システムログイベントを検証します。
</p>
                                                            <h4>認証</h4>
                                                            <ul>
                                                                <li>DisplayMessage：証明書によるデバイスの認証</li>
                                                                <li>EventType: <span class="code">user.authentication.authenticate</span></li>
                                                            </ul>
                                                            <h4>登録</h4>
                                                            <ul>
                                                                <li><span class="mc-variable okta-feature-names.Device_Trust variable">DisplayMessage</span>：Device Trust証明書の登録</li>
                                                                <li>EventType: <span class="code">user.credential.enroll</span></li>
                                                            </ul>
                                                            <h4>発行	</h4>
                                                            <ul>
                                                                <li><span class="mc-variable okta-feature-names.Device_Trust variable">DisplayMessage</span>：Device Trust証明書の発行</li>
                                                                <li>EventType: <span class="code">pki.cert.issue</span></li>
                                                            </ul>
                                                            <h4>撤回</h4>
                                                            <ul>
                                                                <li><span class="mc-variable okta-feature-names.Device_Trust variable">DisplayMessage</span>：Device Trust証明書の撤回</li>
                                                                <li>EventType: <span class="code">pki.cert.revoke</span></li>
                                                            </ul>
                                                            <h4>更新</h4>
                                                            <ul>
                                                                <li><span class="mc-variable okta-feature-names.Device_Trust variable">DisplayMessage</span>：Device Trust証明書の更新</li>
                                                                <li>EventType: <span class="code">pki.cert.renew</span></li>
                                                            </ul>
                                                        </div>
                                                        <div>
                                                            <h3>DebugContextで一意のデバイスIDを表示する</h3>
                                                            <p>DebugDataは、<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>イベントに関連したデバイスの一意のIDを示します。これはデバッグ目的で有用です。またこの情報は、デバイスインベントリ内のデバイスに<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>が適用されていることを確認するのに役立ちます。この確認は、大きなユーザーグループに機能を展開する前に有用となりえます。</p>
                                                            <div class="noteOkta">
                                                                <p class="noteContent">debugContext.debugDataに含まれる情報は、お客様のプラットフォームの問題をトラブルシューティングする際に、コンテキストを追加するためのものです。キー名や値は予告なく変更されることがありますので、データ契約としてではなく、主にデバッグの補助に使用するようにしてください。Okta開発者用ドキュメントの「<a href="https://developer.okta.com/docs/reference/api/system-log/#debugcontext-object" target="_blank">DebugContextオブジェクト</a>」を参照してください。</p>
                                                            </div>
                                                            <ol>
                                                                <li value="1"><span class="mc-variable okta-feature-names.Admin_Console variable">Admin Console</span>で、<span class="menucascade"><span class="uicontrol">［Reports（レポート）］</span><span class="uicontrol">［System Log］</span></span>に移動します。</li>
                                                                <li value="2">関心のある<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>イベント（日付）を検索し、<span class="menucascade"><span class="uicontrol">［Event（イベント）］</span><span class="uicontrol">［AuthenticationContext］</span><span class="uicontrol">［System（システム）］</span><span class="uicontrol">［DebugContext］</span><span class="uicontrol">［DebugData］</span></span>に移動します。</li>
                                                            </ol>
                                                        </div>
                                                        <p>Jamf Proの設定の確認</p>
                                                        <ul>
                                                            <li>Okta Admin Consoleで、Okta デバイス登録タスクに秘密鍵の値とOrg URLが正しく入力されていますか（<a href="#Task2">「ステップ2. Okta デバイス登録タスクを変更する」</a>を参照）？</li>
                                                            <li>Jamf Proに修正・追加したOkta デバイス登録タスクは、最新版ですか？（<a href="../settings/settings_downloads.htm#Device" rel="noreferrer" target="_blank">「バージョン履歴」</a>を参照。）</li>
                                                            <li>Jamf Proポリシーのトリガーイベントには、<span class="wintitle">［Enrollment Complete（登録完了）］</span>と<span class="wintitle">［Recurring Check-in（定期的なチェックイン）］</span>が含まれていますか？（<a href="#Task4">「ステップ4. 変更したOkta デバイス登録タスクをJamf Proに追加してmacOSデバイスに配布する」</a>を参照してください。）</li>
                                                            <li>

											デプロイメント・ログは確認しましたか？（<a href="#PartF">「証明書登録のログを表示する」</a>を参照。）
										</li>
                                                            <li>Jamf Proのポリシー・ログには、スクリプトの実行状態が<span class="wintitle">［Completed（完了）］</span>と表示されていますか？ </li>
                                                            <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-jamf-policy-logs-troubleshooting.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="664" data-mc-height="347" src="../../resources/images/dt-macos-jamf-policy-logs-troubleshooting_thumb_220_220.png" tabindex="" /></a>
                                                            </p>
                                                        </ul>
                                                        <h3><a name="AdvancedTroubleshooting_dt-macOS"></a>高度なトラブルシューティング</h3>
                                                        <p>基本的なトラブルシューティングで問題が解決されず、証明書がmacOSデバイスにインストールされていない場合は、以下を確認してください。</p>
                                                        <h3>Okta管理者アプリで次を確認します。</h3>
                                                        <p>macOSデバイスのエンドユーザーが<span class="menucascade"><span class="uicontrol">［Directory（ディレクトリ）］</span><span class="uicontrol">［People（ユーザー）］</span></span>に存在し、アクティベートされていることを確認します。</p>
                                                        <h3>macOSデバイスで次を確認します。</h3>
                                                        <h4>Chromeで自動証明書の設定がされていることを確認します。</h4>
                                                        <ol>
                                                            <li value="1">Chromeのアドレスバーに「chrome://policy」と入力し、Enterキーを押します。</li>
                                                            <li value="2"><span class="uicontrol">［Show value（値を表示）］</span>をクリックし、<span class="wintitle">AutoSelectCertificateForUrls</span>というポリシーに次の値のいずれかが表示されていることを確認します。

					<p><span class="code">{&quot;pattern&quot;:&quot;https://[cell]-devicetrust.okta.com&quot;,&quot;filter&quot;:{&quot;ISSUER&quot;:{&quot;CN&quot;:&quot;MTLS Certificate Authority&quot;}}}</span></p><p><span class="code">{&quot;pattern&quot;:&quot;https://[cell]-devicetrust.okta-emea.com&quot;,&quot;filter&quot;:{&quot;ISSUER&quot;:{&quot;CN&quot;:&quot;MTLS Certificate Authority&quot;}}}</span></p></li>
                                                            <p><span class="code">[cell]</span>は、Okta Admin Consoleのフッターに表示されておりOkta orgが存在するセルです。</p>
                                                        </ol>
                                                        <h4>キーチェーンでネイティブアプリが許可されていることを確認する</h4>
                                                        <p>次のコマンドを実行して、許可されたアプリが証明書にアクセスできることを確認します。「<a href="#PartG">デフォルトのアプリの許可リストを変更する</a>」を参照してください。 </p>
                                                        <p><span class="code">security dump-keychain -a okta.keychain</span>
                                                        </p>
                                                        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt-macos-dump-keychain-troubleshooting.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1084" data-mc-height="217" src="../../resources/images/dt-macos-dump-keychain-troubleshooting_thumb_220_220.png" tabindex="" /></a>
                                                        </p>
                                                        <h4>改善策の検証</h4>
                                                        <p>ブラウザーやシッククライアントから、<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>でセキュリティ保護されたアプリにアクセスしてみてください。アプリにアクセスしようとしてエラーが表示された場合は、ブラウザー（ChromeまたはSafari）を<span class="uicontrol">［Quit（終了）］</span>して<span class="uicontrol">［Close（閉じ）］</span>、ブラウザーを再起動してから、再度アプリにアクセスしてみてください。</p>
                                                    </div>
                                                    <h2>既知の問題</h2>
                                                    <ul>
                                                        <li>O365ネイティブアプリへのアクセス時にセキュリティ要件ページが表示されない：管理されていないmacOSデバイスを持つエンドユーザーが、この<span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span>ソリューションによって保護されたOffice O365ネイティブアプリにアクセスしようとすると、<span class="wintitle">［Security requirements（セキュリティ要件）］</span>ページが表示されません。（この問題はOfficeのネイティブアプリでのみ発生し、ChromeやSafariなどのデスクトップブラウザーからO365アプリにアクセスしようとする場合には発生しません）。 <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/dt_security_urlspecified_2.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="386" data-mc-height="265" src="../../resources/images/dt_security_urlspecified_2_thumb_220_220.png" tabindex="" /></a></p></li>
                                                        <li>Googleのバックアップと同期アプリへのアクセスに問題がある：バックアップと同期アプリ（Googleドライブの一部）にサインインすると、認証フローがアプリに進まず、Googleアカウントのページで停止します。Googleはこの問題を認識しています。サインインを完了するには、ページ下部の<span class="uicontrol">［Sign in with your browser instead（代わりにブラウザーでログイン）］</span>リンクをクリックします。</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- div class="toolbar-main">
            <MadCap:topicToolbarProxy data-mc-skin="/Project/Skins/okta-toolbar-no-expand.flskn" style="mc-topic-toolbar-items: ;" />
                </div -->
                                    <!-- *********************** Footer rows ********************************* -->
                                    <div class="footer2" data-test="footer">
                                        <div>
                                            <p class="copyright" data-test="copyrightNotice">&copy;  <span class="mc-variable okta-variables.Year variable">2024</span> <span class="mc-variable okta-variables.CompanyName variable">Okta, Inc</span>. All Rights Reserved. それぞれの商標は、それぞれの商標所有者に帰属します。
	</p>
                                        </div>
                                    </div>
                                    <!-- ********************** Scripts ************************************* -->
                                    <script src="../../resources/scripts/js/ignore-dompurify.js">
                                    </script>
                                    <script src="../../resources/scripts/js/app.js">
                                    </script>
                                    <script src="../../resources/scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/coveo.madcapflare.requirejs.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/coveo.madcapflare.okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                    <!-- Feedback tab for Qualtrics survey -->
                                    <div id="feedback-tab" data-mc-conditions="Primary.live-site-only"><a id="feedback-link" href="#" onclick="openSurvey();  return false" target="_blank" title="フィードバックを送信"><div id="feedback-container"><p id="feedback-text" translate="no">Feedback</p></div></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
