<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:fileTags="Tags/okta-authors.Nikita Apraj">
   <head>
      <link href="../../Resources/TableStyles/standard-horizonal-borders-only.css"
            rel="stylesheet"
            MadCap:stylesheetType="table"/>
   </head>
   <body>
      <h1>Configure and use telephony</h1>
      <p>You can configure SMS messages or voice calls as part of authentication policies or account recovery. This topic describes how to enable SMS messages or voice calls, customize SMS messages, and monitor usage using the System Log and reports.</p>
      <ul>
         <li>
            <p>
               <MadCap:xref href="#Enable">Enable SMS or voice for account recovery</MadCap:xref>
            </p>
         </li>
         <li>
            <p>
               <MadCap:xref href="#Configur">Configure SMS or voice for multifactor authentication</MadCap:xref>
            </p>
         </li>
         <li>
            <p>
               <MadCap:xref href="#Customiz">Customize SMS templates</MadCap:xref>
            </p>
         </li>
         <li>
            <p>
               <MadCap:xref href="#ViewSysLog">View or query SMS or voice call events</MadCap:xref>
            </p>
         </li>
         <li>
            <p>
               <MadCap:xref href="#ViewSMS">View the SMS usage report</MadCap:xref>
            </p>
         </li>
         <li MadCap:conditions="Primary.do-not-publish">
            <p>
               <MadCap:xref href="#ViewTelephony">View delivery status in the Telephony Usage report</MadCap:xref>
            </p>
         </li>
         <li>
            <p>
               <MadCap:xref href="#Select">Select a language for voice-based authentication</MadCap:xref>
            </p>
         </li>
      </ul>
      <h2>
         <a name="Enable"/>Enable SMS messages or voice for account recovery
</h2>
      <p>The default password policy enables <MadCap:variable name="okta-variables.ProductName"/> users to reset their account password or unlock their account using an email link. You can modify this policy to enable users to receive an SMS messages or a voice call to reset their password or unlock their account. <MadCap:variable name="okta-variables.ProductName"/> recommends adding another password policy to the same effect and place it at a higher priority. </p>
      <p MadCap:conditions="MultiProdPublish.OIE">For information about adding a password authenticator with a default policy rule, see <MadCap:xref href="../identity-engine/authenticators/configure-password.htm">Configure password policies</MadCap:xref>.
        </p>
      <p MadCap:conditions="MultiProdPublish.Classic">For information about adding a password policy, see <MadCap:xref href="../Security/policies/configure-password-policies.htm">Configure a password policy</MadCap:xref>.
        </p>
      <h2>
         <a name="Configur"/>Configure SMS messages or voice for multifactor authentication</h2>
      <p>You can configure a phone as an authenticator to use SMS messages or voice messages for multifactor authentication, device enrollment, and recovery. Or you can only allow the use of SMS messages or voice for account recovery. When you configure the phone as an authenticator,  you can choose to enable only SMS messages text codes, only voice calls, or to allow both.</p>
      <div class="noteOkta">
         <p class="noteContent">Toll-free, premium, and invalid phone numbers can't be used for multifactor authentication or device enrollment. If you attempt to use a toll-free, premium, or unrecognized phone number format, the phone number is rejected as an invalid phone number. </p>
      </div>
      <h3>Costs and availability</h3>
      <p>If you enable SMS messages or voice for account recovery, be aware that the costs can vary widely depending on the telecommunication services available in the countries where calls are placed.</p>
      <h3>Service protection and reliability</h3>
      <p>If you enable SMS messages for multifactor authentication, users authenticate by entering a security token that is sent to their mobile device. The sender ID or phone number that appears on the devices can be a short code, a long code, or a toll free number. The sender ID can change without notice to ensure service protection and might change from one sign-in attempt to another. Changes to the sender ID allow Okta to maintain service reliability, adjust the routing of messages to telecommunication providers, and provide a more consistent delivery rate for different destinations.</p>
      <p MadCap:conditions="MultiProdPublish.Classic">For information about configuring SMS messages or voice for multifactor authentication, see <MadCap:xref href="../Security/mfa/mfa-factors.htm">MFA factor configuration</MadCap:xref>.
        </p>
      <p MadCap:conditions="MultiProdPublish.OIE">To set up multifactor authentication to use SMS messages or voice calls:</p>
      <ol MadCap:conditions="MultiProdPublish.OIE">
         <li>In the Admin Console, go to <span class="menucascade">
               <span class="uicontrol">Security</span>
               <span class="uicontrol">Authenticators</span>
            </span>.</li>
         <li>
            <p>If Phone is listed as an authenticator on the Setup tab, continue to the next step.</p>
            <p>If Phone isn't listed as an authenticator, click <span class="uicontrol">Add Authenticator</span> and follow the steps in <MadCap:xref href="../identity-engine/authenticators/configure-authenticators.htm">About MFA authenticators</MadCap:xref> to add it.</p>
         </li>
         <li>
            <p>Under <span class="uicontrol">Actions</span>, click <span class="uicontrol">Edit</span>.</p>
         </li>
         <li>
            <p>Configure the settings for phone-based authentication as described in <MadCap:xref href="../identity-engine/authenticators/configure-phone.htm">Configure phone authenticator</MadCap:xref>.</p>
         </li>
         <li>
            <p>Configure one or more Okta sign-on policy rules to include primary and secondary factors for authentication as described in <MadCap:xref href="../identity-engine/policies/add-okta-sign-on-policy-rule.htm">Add an Okta sign-on policy rule</MadCap:xref> and <MadCap:xref href="../identity-engine/policies/create-mfa-policy.htm">Create an MFA enrollment policy</MadCap:xref>.</p>
         </li>
      </ol>
      <p MadCap:conditions="MultiProdPublish.OIE">For more information about adding authenticators and configuring sign-on policy rules, see the following topics:</p>
      <ul MadCap:conditions="MultiProdPublish.OIE">
         <li>
            <p>
               <MadCap:xref href="../identity-engine/policies/about-policies.htm">Sign-on policies and rules</MadCap:xref>
            </p>
         </li>
         <li>
            <p>
               <MadCap:xref href="../identity-engine/authenticators/about-authenticators.htm">Multifactor Authentication</MadCap:xref>
            </p>
         </li>
         <li>
            <p>
               <MadCap:xref href="../identity-engine/policies/create-mfa-policy.htm">Create an MFA enrollment policy</MadCap:xref>
            </p>
         </li>
      </ul>
      <h2>
         <a name="Customiz"/>Customize SMS messages templates</h2>
      <p>You can customize the SMS messages  by modifying the default message template or by localizing the message.  In addition, some countries require that the SMS messages include branding information or comply with specific regulatory requirements. See <MadCap:xref href="../Settings/Settings_SMS.htm">Customize SMS messages</MadCap:xref>.</p>
      <p> Before you customize the default SMS messages template, consider the following:</p>
      <ul>
         <li>
            <p>The languages you need to support</p>
         </li>
         <li>
            <p>The character set required for the languages that you support</p>
         </li>
         <li>
            <p>The maximum number of characters allowed for a single SMS messages</p>
         </li>
      </ul>
      <h3>
         <a name="Characte"/>Character set limitations</h3>
      <p>Most telecommunication providers encode SMS messages using the GSM-7 character set. The GSM-7 character set supports the most commonly used letters and symbols in many languages that use the Latin-based alphabet, such as English, Spanish, and French. Because the SMS messages is transmitted 140 8-bit octets at a time, messages that are encoded using the GSM-7 character set can contain a maximum of 160 characters. If a message can't be encoded using the GSM-7 character set, it's typically encoded using UCS-2. Examples include messages in a non-Latin-based alphabet language such as Arabic, Chinese, or Cyrillic. With UCS-2 encoding, the maximum message length is 70 characters.</p>
      <h3>Message segments and delivery</h3>
      <p>Okta supports sending SMS messages that use GSM and non-GSM character sets. However, the character set you use affects both the maximum number of characters you can use per message and how messages are broken down into segments and delivered. For example, if you send SMS messages using the standard GSM character set, the character limit for a single SMS message segment is 160 characters. If the SMS message is over 160 characters, the message is split into segments with a maximum of 153 characters. The segments are sent individually and then assembled by the recipient endpoint. If your message consists of 161 characters, it's sent as two separate messages. The first with 153 characters and the second with 8 characters. It's counted as two 160-character messages.</p>
      <p>Messages that have non-GSM characters are limited to 70 characters for a single SMS message segment. Not all phones or mobile networks support non-GSM characters. Only a few carriers support concatenation of the 70 character segments, with a maximum of 67 characters that can be used for SMS messages. If the SMS message segment exceeds the 70 character limit, it's treated as multiple messages.</p>
      <h3>Validation for custom message templates</h3>
      <p>For a customized SMS message template, <MadCap:variable name="okta-variables.ProductName"/> checks the message to determine whether it contains GSM or non-GSM characters and enforces  the corresponding character limit before saving it. This check ensures that your custom SMS messages follow the character limit for message segments. </p>
      <p>The character set validation isn't performed for custom SMS message templates that you might have previously created.  However, if you change existing custom templates, the new restrictions are enforced if your messages contain non-GSM characters.</p>
      <p>If you have existing SMS message templates that you aren't planning to update, it can be difficult to determine whether they contain non-GSM characters. Try entering such texts in an online tool that can evaluate the characters used.</p>
      <h2>
         <a name="ViewSysLog"/>View or query SMS messages or voice call events</h2>
      <p>You can use the System Log to view or query for SMS messages or voice call events.</p>
      <p>For example, you can use the System Log to view details about when an SMS message was sent to verify a phone as an authenticator or if verification was successful:</p>
      <p>
         <img src="../../Resources/Images/telephony/system-log-events.png"
              alt="SMS events displayed in the System Log."
              class="thumbnail"/>
      </p>
      <p>You can expand these events to view additional details about the activity. For example, if an SMS message was successfully delivered to its destination, you can see details similar to the following:</p>
      <p>
         <img src="../../Resources/Images/telephony/SMS-delivery-status.png"
              class="thumbnail"/>
      </p>
      <p>You can also use the System Log to filter and query for a specific provider status. For example:</p>
      <p>
         <img src="../../Resources/Images/telephony/SMS-search-example.png"
              class="thumbnail"/>
      </p>
      <p>There are several scenarios that can cause SMS messages or voice calls to fail.</p>
      <p>For example, authentication requests might fail for any of the following reasons:</p>
      <ul>
         <li>
                A telephony provider can't be reached
            </li>
         <li>
                The phone number used is incorrect or inactive
            </li>
         <li>
                The service requested isn't available in the country where the request was made
            </li>
         <li>
               A request for verification has timed out
            </li>
         <li>
               A number has been blocked because of suspicious activity
            </li>
      </ul>
      <h3>SMS event types</h3>
      <p>The System Log records the following events for SMS messages:</p>
      <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/standard-horizonal-borders-only.css');"
             class="TableStyle-standard-horizonal-borders-only"
             cellspacing="14">
         <col class="TableStyle-standard-horizonal-borders-only-Column-Column1"
              style="width: 683px;"/>
         <col class="TableStyle-standard-horizonal-borders-only-Column-Column1"/>
         <thead>
            <tr class="TableStyle-standard-horizonal-borders-only-Head-Header1">
               <th class="TableStyle-standard-horizonal-borders-only-HeadE-Column1-Header1">Event</th>
               <th class="TableStyle-standard-horizonal-borders-only-HeadD-Column1-Header1">Description</th>
            </tr>
         </thead>
         <tbody>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyE-Column1-Body1">
                  <span class="code">system.sms.receive_status</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyD-Column1-Body1">Recorded when a status update for an SMS message has been received from a service provider. You can use this event  to identify users who aren't getting one-time passcodes delivered successfully. For any <span class="code">system.sms.send_</span>* event, there should be exactly one corresponding <span class="code">system.sms.receive_status</span> event.</td>
            </tr>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyE-Column1-Body1">
                  <span class="code">system.sms.send_account_unlock_message</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyD-Column1-Body1">Recorded when a self-service account unlock SMS message has been sent.</td>
            </tr>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyE-Column1-Body1">
                  <span class="code">system.sms.send_factor_verify_message</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyD-Column1-Body1">Recorded when a second factor authentication has been sent as an SMS message.</td>
            </tr>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyE-Column1-Body1">
                  <span class="code">system.sms.send_okta_push_verify_message</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyD-Column1-Body1">Recorded when a request to activate Okta Verify Push for mobile SMS message has been sent.</td>
            </tr>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyE-Column1-Body1">
                  <span class="code">system.sms.send_password_reset_message</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyD-Column1-Body1">Recorded when a  self-service password reset SMS message has been sent.</td>
            </tr>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyB-Column1-Body1">
                  <span class="code">system.sms.send_phone_verification_message</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyA-Column1-Body1">Recorded when a phone verification SMS message has been sent.</td>
            </tr>
         </tbody>
      </table>
      <p>For additional information about the System Log API and SMS event types, see <a href="https://developer.okta.com/docs/reference/api/event-types/#catalog"
            target="_blank">Event Types</a> in the Okta developer documentation and type <span class="code">sms</span> in the search field.</p>
      <h3>Voice event types</h3>
      <p>The System Log records the following events for voice messages:</p>
      <table style="width: 100%;margin-left: 0;margin-right: auto;mc-table-style: url('../../Resources/TableStyles/standard-horizonal-borders-only.css');"
             class="TableStyle-standard-horizonal-borders-only"
             cellspacing="14">
         <col class="TableStyle-standard-horizonal-borders-only-Column-Column1"
              style="width: 682px;"/>
         <col class="TableStyle-standard-horizonal-borders-only-Column-Column1"/>
         <thead>
            <tr class="TableStyle-standard-horizonal-borders-only-Head-Header1">
               <th class="TableStyle-standard-horizonal-borders-only-HeadE-Column1-Header1">Event</th>
               <th class="TableStyle-standard-horizonal-borders-only-HeadD-Column1-Header1">Description</th>
            </tr>
         </thead>
         <tbody>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyE-Column1-Body1">
                  <span class="code">system.voice.receive_status</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyD-Column1-Body1">Recorded when a status update for a voice message has been received from a service provider. You can use this event  to identify users who aren't getting one-time passcodes delivered successfully. For any <span class="code">system.voice.send_</span>* event, there should be exactly one corresponding <span class="code">system.voice.receive_status</span> event.</td>
            </tr>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyE-Column1-Body1">
                  <span class="code">system.voice.send_account_unlock_call</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyD-Column1-Body1">Recorded when a self-service account unlock voice call has been sent.</td>
            </tr>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyE-Column1-Body1">
                  <span class="code">system.voice.send_call</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyD-Column1-Body1">Recorded when a voice call has been sent.</td>
            </tr>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyE-Column1-Body1">
                  <span class="code">system.voice.send_mfa_challenge_call
</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyD-Column1-Body1">Recorded when a second factor authentication has been sent as a voice call.</td>
            </tr>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyE-Column1-Body1">
                  <span class="code">system.voice.send_password_reset_call
</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyD-Column1-Body1">Recorded when a voice call for self-service password reset has been sent.</td>
            </tr>
            <tr class="TableStyle-standard-horizonal-borders-only-Body-Body1">
               <td class="TableStyle-standard-horizonal-borders-only-BodyB-Column1-Body1">
                  <span class="code">system.voice.send_phone_verification_call
</span>
               </td>
               <td class="TableStyle-standard-horizonal-borders-only-BodyA-Column1-Body1">Recorded when a voice call for phone verification has been sent.</td>
            </tr>
         </tbody>
      </table>
      <p>For additional information about the System Log API and voice event types, see <a href="https://developer.okta.com/docs/reference/api/event-types/#catalog"
            target="_blank">Event Types</a> in the Okta developer documentation and type <span class="code">voice</span> in the search field.</p>
      <h2>
         <a name="ViewSMS"/>View the SMS usage report</h2>
      <p>You can see details about the domestic and international SMS messages sent in a month for users in your organization. Use this report to identify patterns of user behavior and whether the SMS message is for enrollment, sign-in requests, password resets, or unlocking accounts.</p>
      <h2 MadCap:conditions="Primary.do-not-publish">
         <a name="ViewTelephony"/>View delivery status in the Telephony Usage report</h2>
      <p MadCap:conditions="Primary.do-not-publish">You can see details about the SMS messages and voice calls, including whether messages were delivered, resent, or failed in the Telephony Usage report. The report provides visual clues to help you to detect unusual activity and service outages, and to understand what users are experiencing.</p>
      <p>
         <img src="../../Resources/Images/telephony/SMS-usage.png" class="thumbnail"/>
      </p>
      <h2>
         <a name="Select"/>Select a language for voice-based authentication</h2>
      <p>Individual users can select the language used for the voice message they receive to verify their identity. To select a language, users click <span class="uicontrol">Settings</span> in the  End-User Dashboard. After they click <span class="uicontrol">Edit Profile</span> to validate their credentials, they can edit the <span class="uicontrol">Display Language</span> setting to select the language used for voice-based authentication and recovery. If they authenticate using a phone call after changing the language setting, they hear the voice message in their selected language.</p>
      <p MadCap:conditions="MultiProdPublish.Classic">For more information about modifying user settings, direct your user community to <a href="https://help.okta.com/eu/en-us/Content/Topics/end-user/dashboard-set-language.htm">Select your display language</a>.</p>
      <p MadCap:conditions="MultiProdPublish.OIE">For more information about modifying user settings, see <a href="../identity-engine/enduser/eu-settings.htm">End-user settings</a> or direct your user community to <a href="https://help.okta.com/eu/en-us/Content/Topics/end-user/dashboard-set-language.htm">Select your display language</a>.</p>
      <h2>Related topics </h2>
      <p>
         <MadCap:xref href="about-telephony.htm">Telephony</MadCap:xref>
      </p>
      <p>
         <MadCap:xref href="telephony-inline-hook.htm">Customize your telephony service provider</MadCap:xref>
      </p>
      <p>
         <a href="telephony-how-to-tasks.htm">
            <MadCap:xref href="telephony-compliance.htm">Regulatory compliance</MadCap:xref>
         </a>
      </p>
      <p>
         <MadCap:xref href="telephony-mitigate-tf.htm">How to mitigate toll fraud for an Okta organization</MadCap:xref>
      </p>
   </body>
</html>
