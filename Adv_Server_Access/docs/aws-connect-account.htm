<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:onlyLocalStylesheets="False" MadCap:searchable="True" MadCap:fileTags="Tags/okta-authors.Arshabhi Rai">
    <head>
        <link href="../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link rel="canonical" href="https://help.okta.com/asa/en-us/Content/Topics/Adv_Server_Access/docs/ad-sync-activate.htm" /><title>[%=Heading.Level1%] | Okta</title>
        <link href="" rel="stylesheet" type="text/css" />
        <meta name="description" content="Learn how to activate an server sync job to add servers from an AD domain." />
    </head>
    <body>
        <div MadCap:conditions="MultiProdPublish.PYPContent">
            <h1>Connect an AWS account</h1>
            <MadCap:snippetBlock src="../../../Resources/Snippets/ea-banner.flsnp" />
            <p>AWS Server Discovery connects one or more AWS accounts to a project so <MadCap:variable name="okta-feature-names.ScaleFT" /> can automatically add or remove AWS servers. A project can connect to multiple AWS accounts, but an AWS account can only be associated with a single project across all <MadCap:variable name="okta-feature-names.ScaleFT" /> teams.</p>
            <p><MadCap:variable name="okta-feature-names.ScaleFT" /> also uses an Okta-managed service account (referred to as an External ID) to interrogate your AWS accounts. These service accounts are unique to each connected cloud account and are used to discover active EC2 instances and any associated metadata. These accounts require minimal read permissions granted via an AWS IAM role. For more information on IAM roles, see the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html" target="_blank">AWS documentation</a>.</p>
            <div class="noteOkta">
                <p class="noteContent">An AWS IAM role is required for Server Discovery and Cloud Auto-enrollment to work correctly.</p>
            </div>
            <ol>
                <li>Identify your AWS account ID.
				<ol style="list-style-type: lower-alpha;"><li>Go to the Amazon Web Services management console</li><li>At the top of the page, select the dropdown menu next to your profile name and click <span class="uicontrol">My Account</span>.</li><li>Under Account Settings, note your account ID number.</li></ol></li>
                <li>Configure the project.
				<ol style="list-style-type: lower-alpha;"><li>Go to the Advanced Server Access admin console.</li><li>Go to the Projects page and select a project for your server.</li><li>Open the Enrollment tab.</li><li>Click <span class="uicontrol">Link Cloud Account</span>.<br /></li><li>From the Create Cloud Account window, configure the cloud account settings.<br /><table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0"><col class="TableStyle-standard-Column-Column1" /><col class="TableStyle-standard-Column-Column1" /><thead><tr class="TableStyle-standard-Head-Header1"><th class="TableStyle-standard-HeadF-Column1-Header1">Setting</th><th class="TableStyle-standard-HeadD-Column1-Header1">Action</th></tr></thead><tbody><tr class="TableStyle-standard-Body-Body1"><td class="TableStyle-standard-BodyF-Column1-Body1">Cloud Provider</td><td class="TableStyle-standard-BodyD-Column1-Body1">Select <span class="uicontrol">Amazon Web Services</span>.</td></tr><tr class="TableStyle-standard-Body-Body2"><td class="TableStyle-standard-BodyF-Column1-Body2">Account ID</td><td class="TableStyle-standard-BodyD-Column1-Body2">Enter the account ID you noted earlier.</td></tr><tr class="TableStyle-standard-Body-Body1"><td class="TableStyle-standard-BodyF-Column1-Body1">Description</td><td class="TableStyle-standard-BodyD-Column1-Body1">Enter a description to help identify the connection.</td></tr><tr class="TableStyle-standard-Body-Body2"><td class="TableStyle-standard-BodyC-Column1-Body2">AWS ASA Account ID &amp; External ID</td><td class="TableStyle-standard-BodyA-Column1-Body2">Note these values for use in the next step. These are related to an Okta-managed AWS service account and differ from your AWS Account ID.<br />For details on using an External ID, see the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" target="_blank">AWS documentation</a>.</td></tr></tbody></table></li></ol></li>
                <li>Identify your AWS account ID.
				<ol style="list-style-type: lower-alpha;"><li>In a new browser window, access the Amazon Web Services management console and open the IAM console.<br />Note: Do not close the Create Cloud Account window.</li><li>Go to the Roles page and click <span class="uicontrol">Create role</span>.<br /></li><li>From the Create Role window, choose the <span class="uicontrol">Another AWS account</span> role type.</li><li>Under Account ID, enter the <span class="uicontrol">AWS ASA Account ID</span> you noted from the previous step.</li><li>Select <span class="uicontrol">Require external ID</span> and enter the <span class="uicontrol">External ID</span> you noted from the previous step.</li><li>Click <span class="uicontrol">Next: Permissions</span>.</li><li>Grant <code>AmazonEC2ReadOnlyAccess</code> permissions to the role.<br />Note: You can alternatively click <span class="uicontrol">Create Policy</span> to create a new custom policy. Your custom policy must include the following: <code>{"Effect": "Allow", "Action": "ec2:Describe*", "Resource": "*"}</code><br />For details, see the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_create-console.html#access_policies_create-start" target="_blank">AWS&#160;documentation</a>.</li><li>Click <span class="uicontrol">Next: Tags</span>.</li><li>Click <span class="uicontrol">Next: Review</span>.</li><li>Review the settings and click <span class="uicontrol">Create role</span>.<br /></li><li>Note the Amazon Resource Name (ARN) for later use.</li></ol></li>
                <li>
					Return to the <MadCap:variable name="okta-feature-names.ScaleFT" /> <span class="uicontrol">Create Cloud Account</span> window.
				</li>
                <li>
					In the Role field, enter the ARN.
				</li>
                <li>
					Click <span class="uicontrol">Submit</span>.
				</li>
            </ol>
            <p><MadCap:variable name="okta-feature-names.ScaleFT" /> connects the cloud account to the project and discovers any active EC2 instances. The discovery process runs daily at roughly the same time the cloud account was originally connected. This continues until the cloud account is disconnected from the project.</p>
            <p>You must  install the <MadCap:variable name="okta-feature-names.ScaleFT" /> server agent on an instance to actually enroll it in a project. Until the server is enrolled, users cannot connect to the server through <MadCap:variable name="okta-feature-names.ScaleFT" /> and some server details may not sync correctly.</p>
            <p>You can use an enrollment token from a different project, to redeploy the server from the AWS-connected project. This is sometimes done in situations where a server administrator for a discovered AWS server is part of an <MadCap:variable name="okta-feature-names.ScaleFT" /> group associated with another project.</p>
            <h2>Next steps</h2>
            <p>
                <MadCap:xref href="aws-ubuntu-userdata-token.htm">Deploy an&#160;Ubuntu or Debian Amazon Web Services server with user data and an enrollment token</MadCap:xref>
            </p>
        </div>
    </body>
</html>