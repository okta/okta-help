<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:onlyLocalStylesheets="False" MadCap:searchable="True" MadCap:fileTags="Tags/okta-authors.Arshabhi Rai">
    <head>
        <link href="../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link rel="canonical" href="https://help.okta.com/asa/en-us/Content/Topics/Adv_Server_Access/docs/ad-sync-activate.htm" /><title>[%=Heading.Level1%] | Okta</title>
        <link href="" rel="stylesheet" type="text/css" />
        <meta name="description" content="Learn how to activate an server sync job to add servers from an AD domain." />
    </head>
    <body>
        <div MadCap:conditions="MultiProdPublish.PYPContent">
            <h1>Configure real-time sync with AWS</h1>
            <MadCap:snippetBlock src="../../../Resources/Snippets/ea-banner.flsnp" />
            <p>Real-time sync allows <MadCap:variable name="okta-feature-names.ScaleFT" /> to subscribe to compute instance events generated by AWS. Normally, server discovery happens daily, but this feature allows <MadCap:variable name="okta-feature-names.ScaleFT" /> to add or remove servers immediately after receiving a notification. Real-time sync works by enabling AWS EventBridge to send webhook events to an endpoint associated with a specific cloud account within a project.</p>
            <p>Events are usually generated when a compute instance is launched or terminated. For launch events, <MadCap:variable name="okta-feature-names.ScaleFT" /> automatically adds servers to the associated project. You must install the <MadCap:variable name="okta-feature-names.ScaleFT" /> server agent on discovered servers before users can connect. For terminate events, <MadCap:variable name="okta-feature-names.ScaleFT" /> automatically removes the server from the project inventory.</p>
            <div class="noteOkta">
                <ul>
                    <li>It may take up to ten minutes before server changes are synchronized with <MadCap:variable name="okta-feature-names.ScaleFT" />.</li>
                    <li>You must configure separate rules for each AWS region containing servers, unless you use Event bridge cross-region events to centralize events into a single region.</li>
                </ul>
            </div>
            <ol>
                <li>Identify the project details.<ol style="list-style-type: lower-alpha;"><li>Go to the Advanced Server Access admin console.</li><li>Go to the Projects page and select a project.</li><li>Go to the Enrollment tab and select the AWS account.<br /></li><li>Under Instance Lifecycle Monitoring, click <span class="uicontrol">Create Client ID &amp; Secret</span>.<br /></li><li>From the <span class="uicontrol">Client Secret Created</span> window, store the client ID &amp; secret.<br />Note: You cannot retrieve this information after closing the window. If you lose this information, you must generate a new client ID &amp; secret.</li><li>Click <span class="uicontrol">OK</span>.<br /></li><li>Note the <span class="uicontrol">Webhook URL</span> for later use.</li></ol></li>
                <li>Create a connection.<ol style="list-style-type: lower-alpha;"><li>Go to the Amazon EventBridge console.</li><li>Go to the <span class="uicontrol">API destinations</span> page.</li><li>Go to the Connections tab and click <span class="uicontrol">Create connection</span>.<br /></li><li>From the Create connection window, enter a name and description.</li><li>For Authorization type, select OAuth Client Credentials.</li><li>Configure the credentials.<br /><table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0"><col class="TableStyle-standard-Column-Column1" /><col class="TableStyle-standard-Column-Column1" /><thead><tr class="TableStyle-standard-Head-Header1"><th class="TableStyle-standard-HeadF-Column1-Header1">Field</th><th class="TableStyle-standard-HeadD-Column1-Header1">Action</th></tr></thead><tbody><tr class="TableStyle-standard-Body-Body1"><td class="TableStyle-standard-BodyF-Column1-Body1">
Authorization endpoint

</td><td class="TableStyle-standard-BodyD-Column1-Body1">
Enter <code>https://app.scaleft.com/v1/oauth_token</code>.
</td></tr><tr class="TableStyle-standard-Body-Body2"><td class="TableStyle-standard-BodyF-Column1-Body2">
HTTP method

</td><td class="TableStyle-standard-BodyD-Column1-Body2">
Select <span class="uicontrol">Post</span>.

</td></tr><tr class="TableStyle-standard-Body-Body1"><td class="TableStyle-standard-BodyF-Column1-Body1"><p>OAuth HTTP Parameters</p></td><td class="TableStyle-standard-BodyD-Column1-Body1"><ol style="list-style-type: lower-roman;"><li>Under Parameter, select <span class="uicontrol">Body field</span>.</li><li>Under Key, enter <code>grant_type</code>.</li><li>Under Value, enter <code>client_credentials</code>.</li></ol></td></tr><tr class="TableStyle-standard-Body-Body2"><td class="TableStyle-standard-BodyF-Column1-Body2">
Client ID

</td><td class="TableStyle-standard-BodyD-Column1-Body2">
Enter the Client ID you noted from the <MadCap:variable name="okta-feature-names.ScaleFT" /> console.

</td></tr><tr class="TableStyle-standard-Body-Body1"><td class="TableStyle-standard-BodyC-Column1-Body1">
Client secret

</td><td class="TableStyle-standard-BodyA-Column1-Body1">Enter the Client secret you noted from the <MadCap:variable name="okta-feature-names.ScaleFT" /> console.</td></tr></tbody></table></li><li>Click <span class="uicontrol">Create</span>.</li></ol></li>
                <li>
                    <p>Create a target.<br />For more information, see the <a href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-api-destinations.html" target="_blank">AWS documentation</a>.</p>
                    <ol style="list-style-type: lower-alpha;">
                        <li>Go to the API destinations page and click <span class="uicontrol">Create API destination</span>.<br /></li>
                        <li>From the Create API destination window, enter a name and description.</li>
                        <li>For API destination endpoint, enter the <span class="uicontrol">Webhook URL</span> you noted from the <MadCap:variable name="okta-feature-names.ScaleFT" /> console.</li>
                        <li>For HTTP method, select <span class="uicontrol">Post</span>.</li>
                        <li>Click <span class="uicontrol">Use an existing connection</span> and select the connection you created previously.</li>
                        <li>Click <span class="uicontrol">Create</span>.</li>
                    </ol>
                </li>
                <li>Create a rule.<br />For more information, see the <a href="https://docs.aws.amazon.com/eventbridge/latest/userguide/eb-create-rule.html" target="_blank">AWS documentation</a>.<ol style="list-style-type: lower-alpha;"><li>Go to the Rules page and click <span class="uicontrol">Create rule</span>.</li><li>Enter a name for the rule.</li><li>Under Define pattern, select <span class="uicontrol">Event pattern</span>, and then select <span class="uicontrol">Custom pattern</span>.</li><li>Next to Event pattern, click <span class="uicontrol">Edit</span>.</li><li>Enter the following JSON pattern.<br /><table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0"><col class="TableStyle-standard-Column-Column1" /><col class="TableStyle-standard-Column-Column1" /><thead><tr class="TableStyle-standard-Head-Header1"><th class="TableStyle-standard-HeadF-Column1-Header1">Pattern</th><th class="TableStyle-standard-HeadD-Column1-Header1">Description</th></tr></thead><tbody><tr class="TableStyle-standard-Body-Body1"><td class="TableStyle-standard-BodyF-Column1-Body1"><code>{ "source": ["aws.ec2"], "detail-type": ["EC2 Instance State-change Notification"], "detail": { "state": ["pending", "terminated"] } }
</code></td><td class="TableStyle-standard-BodyD-Column1-Body1">
Sends a notification when an EC2 instance changes to the <code>pending</code> or <code>terminated</code> states.

</td></tr><tr class="TableStyle-standard-Body-Body2" MadCap:conditions="Primary.do-not-publish"><td class="TableStyle-standard-BodyC-Column1-Body2"><code>{"source":["aws.tag"],"detail-type":["Tag Change on Resource"],"detail":{"service":["ec2"],"resource-type":["instance"]}}</code></td><td class="TableStyle-standard-BodyA-Column1-Body2">
Sends a notification when tags change on an EC2 resource.

</td></tr></tbody></table></li><li>For Target, select the target API destination you created previously.</li><li>Click <span class="uicontrol">Create</span>.</li></ol></li>
            </ol>
            <p>After creating a rule, AWS sends a notification to <MadCap:variable name="okta-feature-names.ScaleFT" /> when a matching event occurs. <MadCap:variable name="okta-feature-names.ScaleFT" /> uses these notifications to update the server inventory within the associated project.</p>
        </div>
    </body>
</html>