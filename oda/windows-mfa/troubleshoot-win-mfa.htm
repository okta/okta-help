<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:onlyLocalStylesheets="False" MadCap:searchable="True" MadCap:fileTags="Tags/okta-authors.Kimli Welsh">
    <head><title>[%=Heading.Level1%] | Okta</title>
        <link href="" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>Troubleshoot <MadCap:variable name="okta-feature-names.Desktop MFA" /> for Windows</h1>
        <p>To troubleshoot <MadCap:variable name="okta-feature-names.Desktop MFA" /> for Windows, ensure you meet the <MadCap:xref href="configure-win-mfa.htm#winmfa-prereq" target="_blank">Prerequisites</MadCap:xref>.</p>
        <h2>Sign-in issues</h2>
        <p>If a user exceeds the sign-in limit (default limit: 50) for setting up an offline sign-in method, the user can no longer sign in to Windows. The user receives a message stating <span class="msgblock">"Your organization requires an offline method to verify your identity. You don't have an offline method set up. An administrator must update your machine."</span> You can add a message with administrator contact details by editing the <span class="code">AdminContactInfo</span> registry key. See <MadCap:xref href="configure-win-mfa-policies.htm">Configure Desktop MFA policies</MadCap:xref>.</p>
        <p>To resolve the problem, consider these options:</p>
        <ul>
            <li>
                <p>Change the <span class="code">MfaRequiredList</span> policy using your MDM solution or Group Policy:</p>
                <ul>
                    <li>
                        <p>Remove the user from the list, or set the list to <span class="code">empty</span>.</p>
                    </li>
                    <li>
                        <p>Push the setting to the user’s computer.</p>
                    </li>
                    <li>
                        <p>Ask the user to reboot for the new group policy to take effect and to update the registry.</p>
                    </li>
                </ul>
            </li>
            <li>
                <p>Reset the counters, or remove the entry for the affected user. Users' sign-in attempts are tracked in <span class="code">HKLM\Software\Okta\Okta Device Access\User Policies\&lt;upn username&gt;</span>. The User Principal Name (UPN) doesn't include the domain suffix. If the UPN is <span class="code">user@domain.com</span>, the registry key path is <span class="code">HKLM\Software\Okta\Okta Device Access\User Policies\user@domain</span>. In the user-specific registry key, there are sign-in counters: <span class="code">LoginsWithOfflineFactorCounter</span> and <span class="code">LoginsWithoutEnrolledFactorsCounter</span>. Remove the registry key for the affected user (in the current example, <span class="code">HKLM\Software\Okta\Okta Device Access\User Policies\user@domain</span>, or set the sign-in counters to zero, or both. After a user has successfully signed in with an online authentication method, the <span class="code">LoginsWithOfflineFactorCounter</span> is reset to 0.</p>
            </li>
            <li>
                <p>When a user’s <span class="code">LoginsWithOfflineFactorCounter</span> number is greater than the value set in <span class="code">MaxLoginsWithOfflineFactor</span>, the user can't sign in with an offline method. Reset this value to 0 to allow the user to log in with an offline authentication method.</p>
            </li>
            <li>
                <p>If a user has surpassed all sign-in limits, reset the user's <span class="code">LoginsWithoutEnrolledFactorsCounter</span> to zero. This allows the user to sign in without an enrolled authentication method and create the required offline authentication method. </p>
            </li>
            <li>
                <p>To remove all offline enrollments, delete the <span class="code">OktaDeviceAccessData.dat.db</span> file from <span class="filepath">C:\Windows\System32\config\systemprofile\appdata\local\Okta Device Access</span>. This deletes all offline registrations, and prompts users to enroll their offline authentication methods again.</p>
            </li>
        </ul>
        <h2>Device issues</h2>
        <p>If a user loses their phone or YubiKey and has not yet set up an online method (<MadCap:variable name="okta-feature-names.Okta Verify" /> push or OTP), the user can't access their computer even if they're within the sign-in limit. To resolve the problem, consider these options:</p>
        <ul>
            <li>
                <p>Change the <span class="code">MfaRequiredList</span> policy using your MDM solution or Group Policy:</p>
                <ol style="list-style-type: lower-alpha;">
                    <li>
                        <p>Remove the user from the list, or set the list to <span class="code">empty</span>.</p>
                    </li>
                    <li>
                        <p>Push the setting to the user’s computer.</p>
                    </li>
                    <li>
                        <p>Ask the user to reboot for the new group policy to take effect and to update the registry.</p>
                    </li>
                </ol>
            </li>
            <li>
                <p>Reset the user’s online authentication method, then ask the user to enroll a new online method.</p>
            </li>
        </ul>
        <p>If the username associated with a user changes, <MadCap:variable name="okta-feature-names.Okta Verify" /> considers it a new user and the existing offline factors don't work. Have the user enroll their offline methods again to gain offline access using <MadCap:variable name="okta-feature-names.Desktop MFA" />.</p>
        <h2>Other issues</h2>
        <ul>
            <li>
                <p><MadCap:variable name="okta-feature-names.Okta FastPass" /> and&#160;<MadCap:variable name="3rd Party Integrations.WebAuthn" />&#160;sign-in methods aren’t supported. <MadCap:variable name="okta-feature-names.Desktop MFA" /> supports the following authenticators:</p>
                <ul>
                    <li>
                        <p>Online:&#160;<MadCap:variable name="okta-feature-names.Okta Verify" /> push and <MadCap:variable name="okta-feature-names.Okta Verify" /> one-time password.</p>
                    </li>
                    <li>
                        <p>Offline:&#160;<MadCap:variable name="okta-feature-names.Okta Verify" /> one-time password and <MadCap:variable name="3rd Party Integrations.YubiKey company name" /> versions 5.0 and up with&#160;OATH support. </p>
                    </li>
                </ul>
            </li>
            <li>
                <p><MadCap:variable name="3rd Party Integrations.YubiKey company name" /> isn't supported for offline authentication with Windows&#160;Server. </p>
            </li>
            <li>
                <p>Number challenge doesn't work with <MadCap:variable name="okta-feature-names.Desktop MFA" />.</p>
            </li>
            <li>
                <p>Desktop MFA logs are stored locally on the user's desktop computer at <span class="filepath">C:\Windows\System32\config\systemprofile\AppData\Local\Okta Device Access\Logs</span></p>
            </li>
            <li>
                <p>After installation, users may see two instances of <MadCap:variable name="okta-feature-names.Okta Verify" /> in the installed programs list. </p>
            </li>
            <li>
                <p>It's not possible to downgrade <MadCap:variable name="okta-feature-names.Okta Verify" /> at this time. </p>
            </li>
            <li>
                <p>Running the <MadCap:variable name="okta-feature-names.Okta Verify" /> installer a second time with command-line parameters doesn't change the registry key parameters. To change <MadCap:variable name="okta-feature-names.Okta Verify" /> parameters, use PowerShell to update key values.</p>
            </li>
        </ul>
    </body>
</html>