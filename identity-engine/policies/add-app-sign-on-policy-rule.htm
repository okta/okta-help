<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:onlyLocalStylesheets="False" MadCap:searchable="True" MadCap:fileTags="Tags/okta-authors.Graham Smith">
    <head>
        <link href="../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" />
        <link href="../../../Resources/TableStyles/standard.css" rel="stylesheet" MadCap:stylesheetType="table" /><title>[%=Heading.Level1%] | Okta</title>
        <link href="" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>Add an <MadCap:variable name="okta-feature-names.app sign-on policy" /> rule</h1>
        <p><MadCap:variable name="okta-feature-names.App sign-on policies" /> are built on rules. When you create an <MadCap:variable name="okta-feature-names.app sign-on policy" />, it starts with a single catch-all rule that allows access to all requests with any two factor types. Configure your  authenticator requirements by adding  rules and prioritizing them over the catch-all. </p>
        <p>For example, you can add one rule that prompts all users for a password. Then you can add a second rule that prompts users in a specific group for email and password authenticators. </p>
        <h2>Before you begin</h2>
        <p><a href="../authenticators/about-authenticators.htm">Set up authenticators</a>
        </p>
        <p>
            <MadCap:xref href="create-auth-policy.htm">Create an authentication policy</MadCap:xref>
        </p>
        <h2>Add a rule to a policy</h2>
        <ol start="1">
            <li>
                <MadCap:snippetBlock src="../../../Resources/Snippets/task steps/Security_Authentication_Policy.flsnp" />
            </li>
            <li>Select the policy where you want to add a rule.</li>
            <li>On the <span class="wintitle">Rules</span> tab, click <span class="uicontrol">Add Rule</span>.</li>
            <li>Enter a <span class="uicontrol">Rule Name</span>.</li>
        </ol>
        <MadCap:snippetBlock src="../snippets/asop-rule-if-table.flsnp" />
        <ol MadCap:continue="true">
            <li>
                <p>Configure THEN&#160;conditions. These conditions specify how authentication is enforced.	</p>
                <table style="width: 100%;mc-table-style: url('../../../Resources/TableStyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                    <col style="width: 37%;" class="TableStyle-standard-Column-Column1" />
                    <col class="TableStyle-standard-Column-Column1" />
                    <col class="TableStyle-standard-Column-Column1" />
                    <thead>
                        <tr class="TableStyle-standard-Head-Header1">
                            <th class="TableStyle-standard-HeadF-Column1-Header1">THEN</th>
                            <th class="TableStyle-standard-HeadF-Column1-Header1">Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="TableStyle-standard-Body-Body1">
                            <td class="TableStyle-standard-BodyF-Column1-Body1"><span class="uicontrol"><span class="code">THEN</span>&#160;Access is</span>
                            </td>
                            <td class="TableStyle-standard-BodyF-Column1-Body1">
                                <p>Deny the user’s access or allow it after successful authentication. If you deny access, skip to the last step to save your rule.</p>
                                <ul>
                                    <li><span class="uicontrol">Denied</span>: If the user satisfies the conditions that you configured, deny access. If you choose to deny access, skip to the last step to save your rule.</li>
                                    <li><span class="uicontrol">Allowed after successful authentication</span>: If the user satisfies the conditions that you configured, allow access.</li>
                                </ul>
                            </td>
                        </tr>
                        <tr class="TableStyle-standard-Body-Body2" MadCap:conditions="">
                            <td class="TableStyle-standard-BodyF-Column1-Body2">
                                <p><span class="uicontrol"><span class="code">AND</span>&#160;User must provide</span>
                                </p>
                            </td>
                            <td class="TableStyle-standard-BodyF-Column1-Body2">
                                <p>This item displays the rule's settings in JSON code. It appears when you've selected these options:</p>
                                <ul>
                                    <li><span class="uicontrol">Allowed after successful authentication</span> for <span class="uicontrol"><span class="code">THEN</span>&#160;Access is</span></li>
                                    <li><span class="uicontrol">Any 1 factor type</span> or <span class="uicontrol">Any 1 factor type / IdP</span> for <span class="uicontrol"><span class="code">AND</span>&#160;User must authenticate with</span></li>
                                    <li>Any possession constraint for <span class="uicontrol"><span class="code">AND</span>&#160;Factor restraints are</span></li>
                                </ul>
                            </td>
                            <td class="TableStyle-standard-BodyD-Column1-Body2">
                                <p>&#160;</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-standard-Body-Body1">
                            <td class="TableStyle-standard-BodyF-Column1-Body1"><span class="uicontrol"><span class="code">AND</span>&#160;User must authenticate with</span>
                            </td>
                            <td class="TableStyle-standard-BodyF-Column1-Body1">
                                <p>Choose the authentication requirements that you want to enforce for app access. For a description of factor types, see <MadCap:xref href="../authenticators/configure-authenticators.htm">Authenticator configuration</MadCap:xref>.</p>
                                <p>Note: If <span class="h3">IdP</span> appears next to these authentication options, your <MadCap:variable name="okta-feature-names.Okta sign-on policy" /> has specified an Identity Provider that can satisfy the password requirement. Users who authenticate through the specified IdP don’t need to also provide a password.</p>
                                <p><span class="uicontrol">1 factor type</span>: To enable one-factor authentication, choose one of these options.</p>
                                <ul>
                                    <li><span class="uicontrol">Password</span> or <span class="uicontrol">Password / IdP</span> requires users to enter their password every time the rule requires re-authentication. If you select this option, the <span class="wintitle">Factor restraints are</span> options aren't available.</li>
                                    <li><span class="uicontrol">Possession factor</span> requires users to provide a possession factor such as <MadCap:variable name="okta-feature-names.Okta Verify" /> or email to access the app.</li>
                                    <li><span class="uicontrol">Any 1 factor type</span> or <span class="uicontrol">Any 1 factor type / IdP</span> allows users to provide any single factor to access the app. If you select this option, the <span class="wintitle">Factor restraints are</span> options aren't available.</li>
                                </ul>
                                <p>For one-factor passwordless authentication options, see <MadCap:xref href="../password-optional/password-optional-disabled.htm"> Set up passwordless sign-in experience</MadCap:xref>.</p>
                                <p><span class="uicontrol">2 factor types</span>: To require users to provide two distinct factor types, choose one of these options.</p>
                                <ul>
                                    <li><span class="uicontrol">Password +&#160;Another factor</span> or <span class="uicontrol">Password / IdP&#160;+&#160;Another factor</span></li>
                                    <li><span class="uicontrol">Any 2 factor types</span>
                                    </li>
                                </ul>
                                <p>For two-factor passwordless authentication options, see <MadCap:xref href="../devices/fp/fp-configure.htm">Configure [%=okta-feature-names.Okta FastPass%]</MadCap:xref>.</p>
                            </td>
                        </tr>
                        <tr class="TableStyle-standard-Body-Body2">
                            <td class="TableStyle-standard-BodyF-Column1-Body2"><span class="uicontrol"><span class="code">AND</span>&#160;Possession factor constraints are</span>
                            </td>
                            <td class="TableStyle-standard-BodyF-Column1-Body2">These options aren't available if you selected <span class="uicontrol">Password</span>, <span class="uicontrol">Any 1 factor type</span>, or <span class="uicontrol">Any 1 factor type / IdP</span> in <span class="uicontrol">User must authenticate with</span>. Use these settings to specify possession factor characteristics.<ul><li><span class="uicontrol">Phishing-resistant</span>: Requires users to provide possession factors  that cryptographically verify the sign-in server (the origin). FIDO&#160;2 (WebAuthn) and the <MadCap:variable name="okta-feature-names.Okta FastPass" /> option in <MadCap:variable name="okta-feature-names.Okta Verify" /> satisfy this requirement. For details, see <MadCap:xref href="../authenticators/configure-authenticators.htm">About MFA authenticators</MadCap:xref>. Because phishing resistance implies <span class="uicontrol">Device bound</span>, that constraint is selected automatically when <span class="uicontrol">Phishing-resistant</span> is selected. </li><li><span class="uicontrol">Hardware protection</span>: Requires that keys  used to authenticate are stored in secure hardware (TPM, Secure Enclave) on the device. <MadCap:variable name="okta-feature-names.Okta Verify" /> meets this constraint. Because hardware protection implies <span class="uicontrol">Device bound</span>, that constraint is selected automatically when <span class="uicontrol">Hardware protection</span> is selected.
			<p>Note: If Okta Verify is unable to store keys on the secure hardware of the device, it uses software storage. For example, TPM for Windows and Android devices, or Secure Enclave for macOS and iOS devices. In these cases, Okta Verify doesn't satisfy the <span class="uicontrol">Hardware protection</span> requirement.</p><p>To identify how <MadCap:variable name="okta-feature-names.Okta Verify" style="font-weight: normal;" /> keys are stored for a device, view the <code>secureHardwarePresent</code> device attribute in the Admin Console. You can also use an <MadCap:variable name="okta-variables.ProductName" /> Expression Language (EL) expression to determine the value of <code>device.profile.secureHardwarePresentview</code>. If this value is <span class="code">true</span>, secure hardware is used.</p><p>See <a href="https://help.okta.com/oie/en-us/Content/Topics/identity-engine/devices/fp/fp-policy_custom_expression.htm">Custom Expressions</a>, and <a href="https://help.okta.com/oie/en-us/Content/Topics/identity-engine/devices/view-device-state.htm.">View device state</a>.</p><p>Some <MadCap:variable name="3rd Party Integrations.WebAuthn" /> authenticators are hardware-protected. Okta uses the FIDO Alliance Metadata Service (MDS) to determine whether a <MadCap:variable name="3rd Party Integrations.WebAuthn" /> authenticator is hardware-protected. An authenticator is considered hardware-protected when one of its <span class="code">keyProtection</span> values is <span class="code">hardware</span>.</p><p>Hardware-protected <MadCap:variable name="3rd Party Integrations.WebAuthn" /> authenticators have several limitations:</p><MadCap:snippetBlock src="../authenticators/snippets/security-key-limitations.flsnp" /></li><li><span class="uicontrol">Exclude phone and email authenticators</span>: Requires that the factor's keys are stored securely on the device and aren't transferable to another device without re-enrolling the factor. Email and SMS are the only possession factors that aren't device bound. This constraint is selected automatically if you select either of the other constraints.</li></ul></td>
                        </tr>
                        <tr class="TableStyle-standard-Body-Body1">
                            <td class="TableStyle-standard-BodyF-Column1-Body1"><span class="uicontrol"><span class="code">AND</span>&#160;Access with <MadCap:variable name="okta-feature-names.Okta FastPass" /> is granted</span>
                            </td>
                            <td class="TableStyle-standard-BodyF-Column1-Body1">These options allow you to choose whether to require end users to prove that they're physically present when using <MadCap:variable name="okta-feature-names.Okta FastPass" /> to authenticate.<ul><li><span class="uicontrol">If the user approves a prompt in <MadCap:variable name="okta-feature-names.Okta Verify" /></span><span class="uicontrol"> or provides biometrics (meets NIST&#160;AAL2 requirements)</span></li></ul><blockquote>This option requires users to prove that they’re physically present.</blockquote><ul><li><span class="uicontrol">Without the user approving a prompt in Okta Verify or providing biometrics</span></li></ul><blockquote> If you select this option and the authentication policy requires a possession factor, <MadCap:variable name="okta-feature-names.Okta Verify" /> may perform certificate-based authentication. This allows users to access the resource  without proving that they're physically present. This option doesn’t meet NIST AAL2 requirements. Also, if you select this option, you can't use a Security Question as an additional factor.</blockquote></td>
                        </tr>
                        <tr class="TableStyle-standard-Body-Body2">
                            <td class="TableStyle-standard-BodyF-Column1-Body2"><span class="uicontrol">Re-authentication frequency is</span>
                            </td>
                            <td class="TableStyle-standard-BodyF-Column1-Body2">
                                <p>This setting allows you to specify how often end users must re-authenticate.</p>
                                <ul>
                                    <li><span class="uicontrol">Every sign-in attempt</span>: Users must re-authenticate every time they try to access the app.</li>
                                    <li><span class="uicontrol">Never re-authenticate if the session is active</span>: After users authenticate from their device, they aren’t prompted to authenticate again until either the maximum session lifetime is reached or they sign out of Okta.</li>
                                    <li><span class="uicontrol">Re-authenticate after</span>: Specify how often end users are required to re-authenticate. Users are prompted to re-authenticate only if they try to access the app and haven’t re-authenticated within the time interval you specified and their session hasn't expired.</li>
                                </ul>
                                <div class="noteOkta">
                                    <p class="noteContent">Note:&#160;A&#160;10-second grace period applies after a user authenticates with their password. During this grace period, users aren't prompted for their password again if you selected <span class="uicontrol">Every sign-in attempt</span>.</p>
                                </div>
                            </td>
                        </tr>
                        <tr class="TableStyle-standard-Body-Body1">
                            <td class="TableStyle-standard-BodyF-Column1-Body1"><span class="uicontrol">Password re-authentication frequency is</span>
                            </td>
                            <td class="TableStyle-standard-BodyF-Column1-Body1" rowspan="2">These two options appear only when you select <span class="uicontrol">Password + Another Factor</span> or <span class="uicontrol">Password / IdP +&#160;Another factor</span>. They allow you to specify a different re-authentication interval for the password and the other factor. For example, you might want to require users to re-authenticate with a possession factor every time they access the app, but require a password if more than eight hours have passed since they last authenticated.&#160;</td>
                        </tr>
                        <tr class="TableStyle-standard-Body-Body2">
                            <td class="TableStyle-standard-BodyC-Column1-Body2"><span class="uicontrol">Re-authentication frequency for all other factors is</span>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </li>
            <li>Click <span class="uicontrol">Save</span>.
</li>
        </ol>
        <p>The next step after you add rules to a policy is to apply that policy to one or more apps. There's no limit to the number of apps that can share a policy. </p>
        <h2><a name="Security"></a>Security Questions in an <MadCap:variable name="okta-feature-names.app sign-on policy" /></h2>
        <p>The <MadCap:variable name="okta-feature-names.Security Question" /> authenticator  prompts end users to enter a correct response to a  question that they've selected from a list of possible questions.</p>
        <ul>
            <li>
                The <MadCap:variable name="okta-feature-names.Security Question" /> authenticator supports  authentication (MFA/SSO) and password recovery scenarios. If disabled for MFA/SSO, it's included as part of <MadCap:variable name="okta-feature-names.app sign-on policy" /> or global session policy evaluation.
            </li>
            <li>
                The <MadCap:variable name="okta-feature-names.Security Question" /> authenticator can be used as step-up or additional verification when password is used as the primary factor, specifically, if the primary factor in the user's  global session policy is <span class="uicontrol">A password</span>. <MadCap:variable name="okta-variables.ProductName" /> recommends against using Security Questions in any authentication flow.
            </li>
        </ul>
        <MadCap:snippetBlock src="../snippets/authenticators-restrict.flsnp" />
        <p>For example, if you want to enable <MadCap:variable name="okta-feature-names.Okta FastPass" /> for your users so that they can access the resource  without proving that they're physically present, you can't use a Security Question as an additional factor. If you want end users to use Security Questions, you must use the <span class="uicontrol">A password</span>  option in the <MadCap:variable name="okta-feature-names.Okta sign-on policy" />.</p>
        <h2>Limitations</h2>
        <ul>
            <li>
                <p>Authentication rules don't recognize ChromeBook as a ChromeOS&#160;platform if users access their resources in a Firefox or Opera browser. </p>
            </li>
            <li>
                <p>Because <MadCap:variable name="okta-feature-names.Okta Verify" /> isn’t available for ChromeOS,  <MadCap:variable name="okta-feature-names.Okta FastPass" /> isn’t supported. The <span class="uicontrol">Access with Okta FastPass is granted</span> condition has no effect in the rules that check for ChromeOS. 
                </p>
            </li>
            <li>
                <p>If users sign in from a ChromeOS device, a device record isn't created.
</p>
            </li>
            <li>
                <p>You can’t use ChromeOS in custom expressions.
</p>
            </li>
        </ul>
        <h2>Next steps</h2>
        <p>
            <MadCap:xref href="share-auth-policies.htm">Add apps to an authentication policy</MadCap:xref>
        </p>
        <p>
            <MadCap:xref href="manage-auth-policies.htm">Update an authentication policy</MadCap:xref>
        </p>
    </body>
</html>