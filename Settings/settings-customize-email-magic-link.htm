<?xml version="1.0" encoding="utf-8"?>
<html MadCap:onlyLocalStylesheets="False" MadCap:searchable="True" MadCap:conditions="MultiProdPublish.OIE" MadCap:fileTags="Tags/okta-authors.Ian Hakes" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title>[%=Heading.Level1%]</title>
        <link href="" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1>Customize a forgotten password recovery email</h1>
        <p><MadCap:variable name="okta-variables.ProductName" /> can send an email notification to an end user who has forgotten their password. They must follow the provided link to complete the forgot password process. </p>
        <p>If you’re using an <a href="https://developer.okta.com/docs/concepts/redirect-vs-embedded/" target="_blank">embedded authentication</a> deployment model for your application's sign-in flow, you can create a customized email magic link for your <span class="uicontrol">Forgot Password</span> email template.</p>
        <p>The option to send a  forgotten password recovery email with a custom link is available only to OIDC applications on <MadCap:variable name="okta-feature-names.Identity Engine" /> organizations.</p>
        <p>You can customize any default email template. However, when you edit a default template, <MadCap:variable name="okta-variables.ProductName" /> stops sending the default message in other languages. Adding translations of your customized message is your responsibility. </p>
        <p>The custom  link for forgotten passwords has several required elements:</p>
        <ul>
            <li><span class="varname">&lt;app endpoint&gt;</span>: The <span class="uicontrol">Sign-in redirect URI</span> for your app integration where users reset their password. This value depends on the app integration but is generally of the form:&#160;<span class="url">https://example.com/login/callback</span> </li>
            <li><span class="varname">otp</span>: This value is generated by a macro called <span class="code">${oneTimePassword}</span></li>
            <li><span class="varname">state</span>:  This value  is generated by a macro named <span class="code">${request.relayState}</span>. It contains the OAuth state parameter defined by the client in the original call to the <span class="varname">interact</span> endpoint.</li>
        </ul>
        <p>You can also include any relevant macro from the <MadCap:xref href="velocity-variables.htm">Velocity Template Language.</MadCap:xref></p>
        <p>For example, in an <MadCap:variable name="okta-feature-names.Identity Engine" /> org, you could compose the <span class="code">${resetPasswordLink}</span> statement for the forgot password email template as:</p>
        <MadCap:codeSnippet>
            <MadCap:codeSnippetCopyButton />
            <MadCap:codeSnippetBody MadCap:useLineNumbers="True" MadCap:lineNumberStart="1" MadCap:continue="False" xml:space="preserve" style="mc-code-lang: HTML;">https://example.com/login/callback?otp=${oneTimePassword}&amp;state=${request.relayState}&amp;location=
	${request.location}&amp;ip=${request.ipAddress}&amp;browser=${request.browser}</MadCap:codeSnippetBody>
        </MadCap:codeSnippet>
        <p>After you create your custom statement for the forgot password link, you need to modify the <span class="uicontrol">Forgot Password</span> email template:</p>
        <ol>
            <li style="font-weight: normal;">
                <MadCap:snippetText src="../../Resources/Snippets/task steps/Customizations_Brands.flsnp" />
            </li>
            <li style="font-weight: normal;">Select a brand.</li>
            <li style="font-weight: normal;">Click <span class="wintitle">Emails</span>.</li>
            <li>Click <span class="uicontrol">Forgot Password</span> in the list of email templates.</li>
            <li>Click <span class="uicontrol">Edit</span> to open the message in  HTML.&#160;If you see <span class="uicontrol">Add Translation</span> instead of <span class="uicontrol">Edit</span> then the template has already been customized. You must edit the default language copy.</li>
            <li>Locate the following code:&#160;<span class="code">id="reset-password-link" href="${resetPasswordLink}"</span>. Replace <span class="code">${resetPasswordLink}</span> with your custom statement.</li>
            <li>
                <MadCap:snippetText src="../../Resources/Snippets/task steps/Click_Save.flsnp" /> The default language copy of your edited message appears in the <span class="uicontrol">Custom Email</span> table. You also need to edit any templates outside of the default language copy. See the <span class="wintitle">Add translations</span> section inside the <MadCap:xref href="Settings_Email.htm">Customize an email template</MadCap:xref> topic.</li>
        </ol>
    </body>
</html>