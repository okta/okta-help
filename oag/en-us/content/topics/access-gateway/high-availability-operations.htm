<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_nav_poc" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedHeader%]|[%=System.LinkedHeader%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="Okta Access Gateway" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, height=device-height" /><title>High Availability configuration operations | Okta</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Pendo Script (Per Chris Bank) -->
        <!-- End Pendo Script -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../resources/stylesheets/okta-main-new-nav.css" rel="stylesheet" type="text/css" />
        <link rel="canonical" href="https://help.okta.com/oag/en-us/Content/Topics/Access-Gateway/high-availability-operations.htm" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-NMZZV4P');
			/* ]]> */
		</script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KXMLV58');
			/* ]]> */
		</script>
        <script>
		/* <![CDATA[ */
		(function(apiKey){
			(function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
			v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
			o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
			y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
			z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id:              'VISITOR-UNIQUE-ID'
            },
            account: {
                id:           'ACCOUNT-UNIQUE-ID'
            }
        });
		})('a9bd3885-93ae-46ab-700b-dd29e613c19d');
		/* ]]> */
        function openSurvey() {
            window.open('https://surveys.okta.com/jfe/form/SV_e4L0iW8a3tz8Yol?source=' + encodeURIComponent(document.location.href), '_blank');
        }
		</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1024px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMZZV4P" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.OrgId variable">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="mc-variable okta-coveo-config.PlatformRestUri variable">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchPageUrl variable">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchTokenServiceUrl variable">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <div id="coveo_dev_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.DevOrgId variable">oktanonproduction1il1gtac7</span>
                                    </div>
                                    <div id="coveo_dev_token" style="Display:None"><span class="mc-variable okta-coveo-config.DevSearchToken variable">xxf1de37f5-c8aa-42db-a8ef-0cbf06dfa5e3</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************** Coveo Search bar ************************************* -->
                                    <!-- set margin and size in /Content/Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css to make room for replacing Flare-generated top-nav with HTML code (see below)-->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper" data-mc-conditions="MultiProdPublish.SearchBar">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="replace_top_nav">
                                        <div class="navbar" data-mc-conditions="Primary.live-site-only">
                                            <div class="dropdown" data-test="menuBarCategory" id="documentationMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">Documentation <em class="fa fa-caret-down"></em></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=oie-index" data-test="menuBarLink">Identity Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?id=index-admin" data-test="menuBarLink">Classic Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oag&amp;id=ext_oag_main" data-test="menuBarLink">Access Gateway</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=asa&amp;id=csh-asa-overview" data-test="menuBarLink">Advanced Server Access</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=wf&amp;id=ext-Okta-workflows" data-test="menuBarLink">Workflows</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="relnotesMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">Release notes <em class="fa fa-caret-down"></em></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=csh-oie-release-notes" data-test="menuBarLink">Identity Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?id=ext_okta_relnotes" data-test="menuBarLink">Classic Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oag&amp;id=ext_oag_releasenotes" data-test="menuBarLink">Access Gateway</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=asa&amp;id=ext-asa-releasenotes" data-test="menuBarLink">Advanced Server Access</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=wf&amp;id=ext-workflows-releasenotes" data-test="menuBarLink">Workflows</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="oktaDevDocsMenu"><a href="https://developer.okta.com/" target="_blank" data-test="menuBarLink">Okta Developer</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="auth0Menu"><a href="https://auth0.com/docs" target="_blank" data-test="menuBarLink">Auth0</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="trainingMenu"><a href="https://www.okta.com/services/training/" target="_blank" data-test="menuBarLink">Training</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="supportMenu"><a href="https://support.okta.com/help/s/?language=en_US" target="_blank" data-test="menuBarLink">Support</a>
                                            </div>
                                        </div>
                                        <div class="logo_container" id="OktaBanner" data-mc-conditions="Primary.live-site-only"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" data-test="OktaBanner"><img src="../../resources/images/okta-assets/logo.png" alt="Okta Docs" title="Okta Docs" data-test="OktaBannerImg" /></a>
                                        </div>
                                        <div class="toolbar-main" data-test="toolBar" data-mc-conditions="Primary.live-site-only">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_no_expand mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie select-language-button" title="Change language">
                                                        <div>
                                                            <div role="img" class="button-icon-wrapper" aria-label="Change language">
                                                                <div class="button-icon"> </div>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics" data-test="bodyWrapper">
                                        <!-- *** Col1: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                                <div class="nocontent">
                                                    <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider="  &gt;  " data-mc-breadcrumbs-count="3" data-mc-toc="True">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main" data-test="bodyContent">
                                                <!-- Main content body -->
                                                <div role="main" id="mc-main-content">
                                                    <h1>High Availability configuration operations</h1>
                                                    <div>
                                                        <div>
                                                            <div>
                                                                <p>The <span class="uicontrol">High Availability</span> menu displays the current role of an <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> node:</p>
                                                                <p>
                                                                    <ul>
                                                                        <li>Single: The node hasn't been configured as either a worker or an admin.</li>
                                                                        <li>Admin: The node has been configured as an administrator for High Availability.</li>
                                                                        <li>Worker: The node has been configured as a worker for High Availability.</li>
                                                                    </ul>
                                                                </p>
		The <span class="wintitle">High Availability</span> menu includes these options:<ol><li value="1"><span class="uicontrol">Reset</span>: Reset the node keys.						</li><li value="2"><span class="uicontrol">Prepare Admin</span>: Prepare an administration node to connect to a new worker node.</li><li value="3"><span class="uicontrol">Prepare Worker</span>: Prepare a node to become a worker node. </li><li value="4"><span class="uicontrol">List Nodes</span>: List all worker nodes. This option only appears on the admin node.</li><li value="5"><span class="uicontrol">Remove Node</span>: Remove a known worker node. This option only appears on the admin node.</li><li value="6"><span class="uicontrol">Check Status</span>: Check high-availability status.</li><li value="7"><span class="uicontrol">Cluster Manager</span>: Perform a rolling upgrade of a worker node to an admin node using the Cluster Manager. </li></ol><p>You can perform the following high availability management operations:</p><ol><li value="1"><a href="#ResetKey" class="MCXref xref">Reset the key associated with an Access Gateway node</a></li><li value="2"><a href="#AddWorker" class="MCXref xref">Add a worker node to an Access Gateway cluster</a></li><li value="3"><a href="#ListWorkers" class="MCXref xref">List all worker nodes in an Access Gateway cluster</a></li><li value="4"><a href="#RemoveWorker" class="MCXref xref">Remove a worker node from an Access Gateway cluster</a></li><li value="5"><a href="#CheckCluster" class="MCXref xref">Check the cluster configuration</a></li><li value="6"><a href="#Rollingupgrade" class="MCXref xref">Perform a rolling upgrade of a worker node to an admin node</a></li><li value="7"><a href="#Resynch" class="MCXref xref">Sync a worker node with an admin node</a></li></ol></div>
                                                            <div class="noteOkta">
                                                                <p class="noteContent">When you initially configure a high availability cluster, cluster members communicate using HTTPS over port 443. Use caution when configuring high availability where proxies are in use.  See <a href="command-line-console-reference.htm#Proxy">Proxy configuration</a> in the <a href="command-line-console-reference.htm#Network">Network</a> section of <a href="command-line-console-reference.htm" class="MCXref xref"> Command Line Management Console reference</a> for information on configuring proxies and proxy bypass lists. </p>
                                                            </div>
                                                            <div>
                                                                <h3><a name="ResetKey"></a>Reset the key associated with an <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> node</h3>
                                                                <p><span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> nodes use various keys to intercommunicate. You must regenerate keys if you want to use an instance  as a part of an <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> high availability cluster. You only need to regenerate keys once per instance. <br /></p>
                                                                <ol>
                                                                    <li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<br /><span class="codeblock">ssh oag-mgmt@[admin or worker]</span></li>
                                                                    <li value="2">Select <span class="uicontrol">5 - System</span>.</li>
                                                                    <li value="3">Select <span class="uicontrol">8 - High Availability</span>.<br /></li>
                                                                    <li value="4">Select <span class="uicontrol">1 - Reset Key</span>.</li>
                                                                    <li value="5">Enter <span class="uicontrol">y</span> to reset the keys being used by the high availability sync process or <span class="uicontrol">N</span> to end the reset process.<br /></li>
                                                                    <li value="6">Enter <span class="uicontrol">x</span> to exit or any other menu item to continue.<br /></li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="AddWorker"></a>Add a worker node to an <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> cluster</h3>
                                                                <div class="noteOkta">
                                                                    <p class="noteContent">When you add a worker node, both the administration and the worker node must meet the following conditions:<ul><li>The nodes have already been provisioned. </li><li>The nodes are reachable using Secure Socket Shell (SSH).</li><li>The nodes have had their keys reset. See <a href="#ResetKey" class="MCXref xref">Reset the key associated with an Access Gateway node</a></li></ul></p>
                                                                </div>
                                                                <div class="note_cautionOkta">
                                                                    <p class="noteContent">When you prepare workers, ensure that you're connected to a worker node and not an admin. Running the prepare worker operation on the cluster admin renders the <span class="mc-variable okta-feature-names.Access_Gateway_UI variable">Access Gateway Admin UI console</span> inoperable. <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> version  2021.11.2 and later prohibit this operation. Reset nodes previously used as admins before you reuse them as workers. See <a href="deploy-post-install-reset-commandline.htm" class="MCXref xref">Reset Access Gateway command line</a></p>
                                                                </div>
                                                                <ol>
                                                                    <li value="1">
                                                                        <p>Perform these tasks on the admin node:</p>
                                                                        <ol style="list-style-type: lower-alpha;">
                                                                            <li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<span class="codeblock">ssh oag-mgmt@[admin.tld]</span></li>
                                                                            <li value="2">Select <span class="uicontrol">5 - System</span>.</li>
                                                                            <li value="3">Select <span class="uicontrol">8 - High Availability</span>.</li>
                                                                            <li value="4">Select <span class="uicontrol">2 - Prepare Admin</span>.<div class="noteOkta"><p class="noteContent">When you configure an admin node for high availability for the first time, select <span class="uicontrol">1 - Reset Keys</span> to reset the instance's SSH keys. You only need to reset keys once per instance. See <a href="command-line-console-reference.htm" class="MCXref xref"> Command Line Management Console reference</a>.</p></div><div class="noteOkta"><p class="noteContent"><span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> Replication uses the hostname setting from the command line console. Ensure that you update the hostname for both the admin and worker nodes using the menu items <span class="menucascade"><span class="uicontrol">System (5)</span><span class="uicontrol">Change Hostname (1)</span></span>.</p></div></li>
                                                                            <li value="5">The admin node generates and displays an authorization token, which you provide to the worker node. Copy the authorization token to a secure location, such as a secure notes app. </li>
                                                                            <li value="6">The admin node waits for connections from worker nodes. Leave the window open until all worker nodes have been added. Entering <span class="uicontrol">X</span> prematurely cause the admin node to end the process and stop listing worker node additions. Enter <span class="uicontrol">X</span> only after all worker nodes have appeared in the window.</li>
                                                                        </ol>
                                                                        <ol style="list-style-type: lower-alpha;">
                                                                            <li value="1">Return to the command prompt on the worker node that you're attaching.</li>
                                                                        </ol>
                                                                    </li>
                                                                    <li value="2">Perform these tasks on each worker node:
						<ol style="list-style-type: lower-alpha;"><li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<span class="codeblock">ssh oag-mgmt@[worker.tld]</span></li><li value="2">Select <span class="uicontrol">5 - System</span>.</li><li value="3">Select <span class="uicontrol">8 - High Availability</span>.</li><li value="4">Select <span class="uicontrol">3 - Prepare Worker</span>.
							<div class="noteOkta"><p class="noteContent">When you configure a worker node for high availability for the first time, select <span class="uicontrol">1 - Reset Keys</span> to reset the instance's SSH keys. You only need to reset keys once per instance. See <a href="command-line-console-reference.htm" class="MCXref xref"> Command Line Management Console reference</a>.</p></div></li><li value="5">Paste the token into the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span> window. The worker node connects to the admin node and completes the authorization.</li><li value="6">Press any key to continue. The worker instance is ready for use.</li><li value="7">Enter <span class="uicontrol">x</span> to exit or any other menu item to continue.</li></ol></li>
                                                                </ol>
                                                                <ol start="3">
                                                                    <li value="3">Perform these tasks on the admin node:
				
					<ol style="list-style-type: lower-alpha;"><li value="1">Return to the admin instance <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span> and view the results of adding the new worker node.<li>Enter <span class="uicontrol">x</span> to exit or any other menu item to continue.</li></li></ol></li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="ListWorkers"></a>List all worker nodes in an Access Gateway cluster</h3>
                                                                <ol>
                                                                    <li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<span class="codeblock">ssh oag-mgmt@[admin.tld]</span></li>
                                                                    <li value="2">Select <span class="uicontrol">8 - High Availability</span>.</li>
                                                                    <li value="3">Select <span class="uicontrol">4 - List Nodes</span>. A list of all currently enabled worker nodes appears.
</li>
                                                                    <li value="4">Enter <span class="uicontrol">x</span> to exit or any other menu item to continue.</li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="RemoveWorker"></a>Remove a worker node from an Access Gateway cluster</h3>
                                                                <p class="noteContent">When you remove a worker node from an Access Gateway cluster, the node still exists but no longer receives updates from the admin instance. In addition, the Access Gateway UI is disabled. Be sure to remove these nodes from any load balancer as well. </p>
                                                                <ol>
                                                                    <li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<br /><span class="codeblock">ssh oag-mgmt@[admin.tld]</span></li>
                                                                    <li value="2">Select <span class="uicontrol">5 - System</span>.</li>
                                                                    <li value="3">Select <span class="uicontrol">8 - High Availability</span>.</li>
                                                                    <li value="4">Select <span class="uicontrol">5 - Remove</span>.</li>
                                                                    <li value="5">Enter the name of the worker node that you want to remove and press <span class="wintitle">Enter</span>.</li>
                                                                    <li value="6">Confirm the removal of the node.</li>
                                                                    <li value="7">Enter <span class="uicontrol">x</span> to exit or any other menu item to continue.</li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="CheckCluster"></a>Check the cluster configuration</h3>
                                                                <ol>
                                                                    <li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<span class="codeblock">ssh oag-mgmt@[admin or worker]</span></li>
                                                                    <li value="2">Select <span class="uicontrol">5 - System</span>.</li>
                                                                    <li value="3">Select <span class="uicontrol">8 - High Availability</span>.<br /></li>
                                                                    <li value="4">Select <span class="uicontrol">6 - Check Status</span>. This option shows the latest status of the cluster only after there's a configuration change or when the NGINX engine is restarted. If newly added nodes don't appear, perform any <span class="mc-variable okta-feature-names.Access_Gateway_UI variable">Access Gateway Admin UI console</span> function or restart the NGINX engine. See the <a href="command-line-console-reference-service.htm#NGIX">NGINX</a> sub-menu in the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span><a href="command-line-console-reference-service.htm" class="MCXref xref">Services</a> section. A list of cluster instances appears.
Pass indicates that the node is reachable and functioning. Fail indicates that the node is non-functional. See the node log for more information.</li>
                                                                    <li value="5">Enter <span class="uicontrol">x</span> to exit.</li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="Rollingupgrade"></a>Perform a rolling upgrade of a worker node to an admin node</h3>
                                                                <p>You can perform a rolling upgrade of a node from worker to admin using the Cluster Manager. See <a href="high-availability-manage-configure.htm" class="MCXref xref">Configure and manage high availability</a> for information on high-availability configurations.</p>
                                                                <ol>
                                                                    <li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<span class="codeblock">ssh oag-mgmt@[admin or worker]</span></li>
                                                                    <li value="2">Verify that you're in a worker node.</li>
                                                                    <li value="3">Select <span class="uicontrol">5 - System</span>.</li>
                                                                    <li value="4">Select <span class="uicontrol">8 - High Availability</span>.</li>
                                                                    <li value="5">Press <span class="uicontrol">7 - Cluster Manager</span>.</li>
                                                                    <li value="6">Press <span class="uicontrol">2 - Authorize Node as Admin node</span>. You can't select this option from an admin node or when another authorization process is in progress.</li>
                                                                    <li value="7">Press <span class="uicontrol">Y</span> to continue or <span class="uicontrol">N</span> to stop in the confirmation dialog.</li>
                                                                    <li value="8">The worker node generates an authorization code. Copy this code to a secure place, such as a secure note app.<div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">Copy</a><div class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><br />The authorization token required to initiate setup for nominated admin node: worker-c:8ba1c123-715d-4b70-ab5d-0e41493bef73<br />Copy the token and paste it on the admin node when prompted.<br />Press enter to continue</code></pre></div></div></li>
                                                                    <li value="9">Press <span class="wintitle">Enter</span> to continue.</li>
                                                                    <li value="10">Switch to an admin node.</li>
                                                                    <li value="11">Press <span class="uicontrol">1 - Authorize Node Nomination</span>. You can't select this option from a worker node or when another authorization process is in progress.</li>
                                                                    <li value="12">Copy and paste the authorization code from your secure note app into the terminal, and then press <span class="wintitle">Enter</span>. The renomination process starts. See <a href="admin-renomination-perform.htm" class="MCXref xref">Perform admin renomination</a>.</li>
                                                                    <li value="13">Delete the authorization code from your note app.</li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="Resynch"></a>Sync a worker node with an admin node</h3>
                                                                <p>If a worker node is out of sync because of downtime or network issues, you can synchronize the changes from an admin node to a specific worker node.</p>
                                                                <div class="noteOkta">
                                                                    <p class="noteContent">This option is only available on worker instances.</p>
                                                                </div>
                                                                <ol>
                                                                    <li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span> on the worker that you want to sync.<span class="codeblock">ssh oag-mgmt@[&lt;worker&gt;]</span></li>
                                                                    <li value="2">Select <span class="uicontrol">5 - System</span>.</li>
                                                                    <li value="3">Select <span class="uicontrol">8 - High Availability</span>.</li>
                                                                    <li value="4">Select <span class="uicontrol">8 - Synch from admin</span>.
</li>
                                                                    <li value="5">Press <span class="wintitle">Enter</span> to continue.</li>
                                                                    <li value="6">Enter <span class="uicontrol">x</span> to exit.</li>
                                                                </ol>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- div class="toolbar-main">
            <MadCap:topicToolbarProxy data-mc-skin="/Project/Skins/okta-toolbar-no-expand.flskn" style="mc-topic-toolbar-items: ;" />
                </div -->
                                    <!-- *********************** Footer rows ********************************* -->
                                    <div class="footer2" data-test="footer">
                                        <div>
                                            <p class="copyright" data-test="copyrightNotice">  <span class="mc-variable okta-variables.Year variable">2024</span> <span class="mc-variable okta-variables.CompanyName variable">Okta, Inc</span>. All Rights Reserved. Various trademarks held by their respective owners.
	</p>
                                        </div>
                                    </div>
                                    <!-- ********************** Scripts ************************************* -->
                                    <script src="../../resources/scripts/js/ignore-dompurify.js">
                                    </script>
                                    <script src="../../resources/scripts/js/app.js">
                                    </script>
                                    <script src="../../resources/scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/coveo.madcapflare.requirejs.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/coveo.madcapflare.okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                    <!-- Feedback tab for Qualtrics survey -->
                                    <div id="feedback-tab" data-mc-conditions="Primary.live-site-only"><a id="feedback-link" href="#" onclick="openSurvey();  return false" target="_blank" title="Submit feedback"><div id="feedback-container"><p id="feedback-text" translate="no">Feedback</p></div></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
