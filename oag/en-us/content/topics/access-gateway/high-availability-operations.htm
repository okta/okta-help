<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_nav_poc" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-toc-path="[%=System.LinkedHeader%]|[%=System.LinkedHeader%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="Okta Access Gateway" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>High Availability configuration operations | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Pendo Script (Per Chris Bank) -->
        <!-- End Pendo Script -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../resources/stylesheets/okta-main-new-nav.css" rel="stylesheet" type="text/css" />
        <link rel="canonical" href="https://help.okta.com/oag/en-us/Content/Topics/Access-Gateway/high-availability-operations.htm" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-NMZZV4P');
			/* ]]> */
		</script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KXMLV58');
			/* ]]> */
		</script>
        <script>
		/* <![CDATA[ */
		(function(apiKey){
			(function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
			v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
			o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
			y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
			z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id:              'VISITOR-UNIQUE-ID'
            },
            account: {
                id:           'ACCOUNT-UNIQUE-ID'
            }
        });
		})('a9bd3885-93ae-46ab-700b-dd29e613c19d');
		/* ]]> */
        function openSurvey() {
            window.open('https://surveys.okta.com/jfe/form/SV_e4L0iW8a3tz8Yol?source=' + encodeURIComponent(document.location.href), '_blank');
        }
		</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1024px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMZZV4P" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.OrgId variable">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="mc-variable okta-coveo-config.PlatformRestUri variable">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchPageUrl variable">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchTokenServiceUrl variable">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <div id="coveo_dev_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.DevOrgId variable">oktanonproduction1il1gtac7</span>
                                    </div>
                                    <div id="coveo_dev_token" style="Display:None"><span class="mc-variable okta-coveo-config.DevSearchToken variable">xxb48840fe-d60d-4e40-b1d3-522d5a35c384</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************** Coveo Search bar ************************************* -->
                                    <!-- set margin and size in /Content/Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css to make room for replacing Flare-generated top-nav with HTML code (see below)-->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper" data-mc-conditions="MultiProdPublish.SearchBar">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="replace_top_nav">
                                        <div class="navbar" data-mc-conditions="Primary.live-site-only">
                                            <div class="dropdown" data-test="menuBarCategory" id="documentationMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">Documentation <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/en-us/Content/index.htm" data-test="menuBarLink">Product documentation</a>
                                                    </div>
                                                    <div><a href="https://developer.okta.com" target="_blank" data-test="menuBarLink">Developer documentation</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="knowledgebaseMenu"><a href="https://support.okta.com/help/s/knowledge?language=en_US" data-test="menuBarLink">Knowledge base</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="communityMenu">
                                                <button class="dropbtn">Community <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://support.okta.com/help/s/community?language=en_US" data-test="menuBarLink">Home</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/group/CollaborationGroup/Recent?language=en_US" data-test="menuBarLink">Discussions</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/questions?language=en_US" data-test="menuBarLink">Questions</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/ideas?language=en_US" target="_blank" data-test="menuBarLink">Ideas</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/events?language=en_US" data-test="menuBarLink">Webinars</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/blogs?language=en_US" data-test="menuBarLink">Blogs</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="productMenu">
                                                <button class="dropbtn">Product <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://support.okta.com/help/s/productroadmap?language=en_US" data-test="menuBarLink">Roadmap</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/product-hub?language=en_US" data-test="menuBarLink">Product hub</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/mysuccesshub/get-started?language=en_US" data-test="menuBarLink">Customer success hub</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="trainingMenu"><a href="https://www.okta.com/services/education-services/" target="_blank" data-test="menuBarLink">Training</a>
                                            </div>
                                        </div>
                                        <div class="logo_container" id="OktaBanner" data-mc-conditions="Primary.live-site-only"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" data-test="OktaBanner"><img src="../../resources/images/okta-assets/logo.png" alt="Okta product documentation" title="Okta product documentation" data-test="OktaBannerImg" /></a>
                                        </div>
                                        <div class="toolbar-main" data-test="toolBar" data-mc-conditions="Primary.live-site-only">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_no_expand mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie select-language-button" title="Change language">
                                                        <div>
                                                            <div role="img" class="button-icon-wrapper" aria-label="Change language">
                                                                <div class="button-icon"> </div>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics" data-test="bodyWrapper">
                                        <!-- *** Col1: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                                <div class="nocontent">
                                                    <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider="  &gt;  " data-mc-breadcrumbs-count="3" data-mc-toc="True">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main" data-test="bodyContent">
                                                <!-- Main content body -->
                                                <div role="main" id="mc-main-content">
                                                    <h1>High Availability configuration operations</h1>
                                                    <div>
                                                        <div>
                                                            <div>
                                                                <p>The following high availability management operations are supported:</p>
                                                                <ol>
                                                                    <li value="1"><a href="#AddWorker" class="MCXref xref">Add a worker node to an Access Gateway cluster</a>
                                                                    </li>
                                                                    <li value="2"><a href="#ListWorkers" class="MCXref xref">List all worker nodes in an Access Gateway Cluster</a>
                                                                    </li>
                                                                    <li value="3"><a href="#RemoveWorker" class="MCXref xref">Remove a worker node from an Access Gateway cluster</a>
                                                                    </li>
                                                                    <li value="4"><a href="#ResetKey" class="MCXref xref">Reset the key associated with an Access Gateway node</a>
                                                                    </li>
                                                                    <li value="5"><a href="#CheckCluster" class="MCXref xref">Check the cluster configuration</a>
                                                                    </li>
                                                                    <li value="6"><a href="#Resynch" class="MCXref xref">Synch worker with Admin</a>
                                                                    </li>
                                                                </ol>
                                                            </div>
                                                            <div class="noteOkta">
                                                                <p class="noteContent">When initially configuring a high availability cluster, cluster members communicate using HTTPS over port 443. Caution should be exercised when configuring high availability where proxies are in use.  See <a href="command-line-console-reference.htm#Proxy">Proxy configuration</a> in the <a href="command-line-console-reference.htm#Network">Network</a> section of <a href="command-line-console-reference.htm" class="MCXref xref"> Command Line Management Console reference</a> for information on configuring proxies and proxy bypass lists. </p>
                                                            </div>
                                                            <div>
                                                                <h3><a name="AddWorker"></a>Add a worker node to an <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> cluster</h3>
                                                                <div class="noteOkta">
                                                                    <p class="noteContent">When adding a worker node, both the administration and the worker node must:<ul><li>Have been previously provisioned. </li><li>Be reachable using SSH.</li><li>Have had their keys reset. See <a href="#ResetKey" class="MCXref xref">Reset the key associated with an Access Gateway node</a></li></ul></p>
                                                                </div>
                                                                <div class="note_cautionOkta">
                                                                    <p class="noteContent">When preparing workers, ensure that you're connected to a worker node and not an admin. Running the prepare worker operation on the cluster admin renders the <span class="mc-variable okta-feature-names.Access Gateway_UI variable">Access Gateway Admin UI console</span> inoperable. <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> version <span class="mc-variable oag-versions.2021-11 variable">2021.11.2</span> and later prohibit this operation. Nodes previously used as admins should be reset before reuse as workers. See <a href="deploy-post-install-reset-commandline.htm" class="MCXref xref">Reset Access Gateway command line</a></p>
                                                                </div>
                                                                <ol>
                                                                    <li value="1">
                                                                        <p>On the Admin node:</p>
                                                                        <ol style="list-style-type: lower-alpha;">
                                                                            <li value="1">Connect to the instance <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<span class="codeblock">ssh oag-mgmt@[admin.tld]</span></li>
                                                                            <li value="2">Select <span class="uicontrol">5 - System</span>.</li>
                                                                            <li value="3">Select <span class="uicontrol">8- High Availability Configuration</span>. The High Availability Configuration menu appears:<span class="codeblock">Access Gateway High Availability Setup (role)
1 - Reset Key
2 - Prepare Admin
3 - Prepare Worker
4 - List Nodes
5 - Remove Node
6 - Check Status

X- Exit
Choice:</span><div class="noteOkta"><p class="noteContent">The High Availability menu displays the current role of a <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> node.</p><p class="noteContent">Roles can be:<ul><li>Single - The node hasn't yet been configured as either a worker or an admin.</li><li>Admin - The node has been configured as an administrator for High Availability.</li><li>Worker - The node has been configured as a worker for High Availability.</li></ul></p></div></li>
                                                                            <li value="4">Select <span class="uicontrol">2 - Prepare Admin</span>.<div class="noteOkta"><p class="noteContent">When you configure an admin node for high availability for the first time, select and execute the <span class="uicontrol">1 - Reset Keys</span> option to reset the instance's SSH keys. </p><p class="noteContent">You only need to reset keys once per instance. See <a href="command-line-console-reference.htm" class="MCXref xref"> Command Line Management Console reference</a>.</p></div><div class="noteOkta"><p class="noteContent"><span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> Replication uses the hostname setting from the command line console.  </p><p class="noteContent">Ensure that you update the hostname for both admin and worker nodes using the command line console <span class="menucascade"><span class="uicontrol">System (5)</span><span class="uicontrol">Change Hostname (1)</span></span>.</p></div></li>
                                                                            <li value="5">The admin node generates and displays an authorization token (for example, oag.okta.com:8ba1c123-715d-4b70-ab5d-0e41493bef73), which must be provided to the worker node. Copy the provided authorization token:<span class="codeblock">
Authorization token required to initiate setup from worker nodes is given
below. Copy the following text below this line and paste it on worker node when prompted.
oag.okta.com:8ba1c123-715d-4b70-ab5d-0e41493bef73
Worker nodes available so far:
. . . 			
</span>The admin node then waits for worker nodes.</li>
                                                                        </ol>
                                                                        <div class="noteOkta">
                                                                            <p class="noteContent">At this point, the admin node waits for connections from worker nodes. Leave the window open until all workers nodes have been added. Entering X prematurely will cause the admin node to assume the process is complete and stop listing for worker node additions. Enter <span class="userinput">X</span> only after adding all worker nodes </p>
                                                                        </div>
                                                                        <ol style="list-style-type: lower-alpha;">
                                                                            <li value="1">Return to the command prompt on the instance, which is being attached as a worker node.</li>
                                                                        </ol>
                                                                    </li>
                                                                    <li value="2">On each worker node,<ol style="list-style-type: lower-alpha;"><li value="1">Connect to the instance <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<span class="codeblock">ssh oag-mgmt@[worker.tld]</span></li><li value="2">Select <span class="uicontrol">5 - System</span>.</li><li value="3">Select <span class="uicontrol">8- High Availability Configuration.</span></li><li value="4">Select <span class="uicontrol">3 - Prepare Worker</span>.<div class="noteOkta"><p class="noteContent">When you configure a worker node for high availability for the first time, select and execute the <span class="uicontrol">1 - Reset Keys</span> option to reset the instance's SSH keys. You only need to reset keys once per instance. See <a href="command-line-console-reference.htm" class="MCXref xref"> Command Line Management Console reference</a>..</p></div></li><li value="5">The worker displays:<span class="codeblock" xml:space="preserve">Checking HA readiness for host worker. . .   

Note: Please ensure that admin node is ready for setup and you have the
authorization token displayed on admin node.

Enter the authorization token displayed on admin node: &lt;admin...com&gt;:927da506-7efb-4520-bd32-dd03b86f2a9b</span>After it's entered, the worker node connects to the admin node and exchanges authorization and confirmation information similar to the following:<span class="codeblock" xml:space="preserve">Requesting admin node &lt;admin...com&gt; to allow connection  
Node &lt;worker...com&gt; successfully added on admin node
Synchronizing current configuration  
 
Press enter to continue ....
</span></li><li value="6">When prompted, press any key to continue.</li><li value="7">Enter <span class="userinput">X</span> to exit or any other menu item to continue.</li></ol><p>The worker instance is now configured and ready for use.</p></li>
                                                                </ol>
                                                                <p>On the admin node:</p>
                                                                <ol>
                                                                    <li value="1">Return to the admin instance <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>. View the results of adding the new worker node, similar to:<span class="codeblock" xml:space="preserve">
Authorization token required to initiate setup from worker nodes is given
below. Copy the text below this line and paste it on worker node when prompted.

&lt;admin...com&gt;:927da506-7efb-4520-bd32-dd03b86f2a9b
Worker nodes available so far:
&lt;worker1...com&gt;
&lt;worker2...com&gt;
&lt;worker3...com&gt;</span></li>
                                                                    <li value="2">Enter <span class="userinput">X</span> to exit or any other menu item to continue.</li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="ListWorkers"></a>List all worker nodes in an Access Gateway Cluster</h3>
                                                                <ol>
                                                                    <li value="1">Connect to the instance <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<span class="codeblock">ssh oag-mgmt@[admin.tld]</span></li>
                                                                    <li value="2">Select <span class="uicontrol">8- HA Configuration</span>.</li>
                                                                    <li value="3">Select <span class="uicontrol">4 - List</span> nodes.</li>
                                                                    <li value="4">A list of all currently enabled Worker nodes are displayed, which should resemble:
<span class="codeblock">Admin Node:
admin. . .com

Worker Nodes:
worker1. . .com
. . . 
workern. . .com
Press enter to continue ....
</span></li>
                                                                    <li value="5">Enter <span class="userinput">X</span> to exit or any other menu item to continue.</li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="RemoveWorker"></a>Remove a worker node from an Access Gateway cluster</h3>
                                                                <p>To remove an existing worker node from an Access Gateway cluster:</p>
                                                                <div class="noteOkta">
                                                                    <p class="noteContent">When a worker node is removed from an Access Gateway cluster, the node still exists but no longer receives updates from the Admin instance. In addition, the Access Gateway UI continues to be disabled. </p>
                                                                    <p class="noteContent">Nodes removed from the Access Gateway High availability cluster should be removed from any load balancer and otherwise decommissioned. </p>
                                                                    <p class="noteContent">After being removed, a worker node is no longer considered viable.</p>
                                                                </div>
                                                                <ol>
                                                                    <li value="1">Connect to the instance.<br /><span class="codeblock">ssh oag-mgmt@[admin.tld]</span></li>
                                                                    <li value="2">Select <span class="uicontrol">5 - System</span>.</li>
                                                                    <li value="3">Select <span class="uicontrol">8- High Availability Configuration</span>.<span class="codeblock">Access Gateway Services...
1 - Reset Key
2 - Prepare Admin
3 - Prepare Worker
4 - List Nodes
5 - Remove Node

X- Exit
Choice: </span></li>
                                                                    <li value="4">Select <span class="uicontrol">5 - Remove</span> node.</li>
                                                                    <li value="5">From the list of known nodes, enter the name of the worker node to be removed and press enter.</li>
                                                                    <li value="6">Confirm the removal of the node.</li>
                                                                    <li value="7">Enter <span class="userinput">X</span> to exit or any other menu item to continue.</li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="ResetKey"></a>Reset the key associated with an <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> node</h3>
                                                                <p><span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> nodes use various keys to intercommunicate. You must regenerate keys if you want to use an instance  as a part of an <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> High Availability cluster. <br />You only need to regenerate keys once per instance. <br /></p>
                                                                <ol>
                                                                    <li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<br /><span class="codeblock">ssh oag-mgmt@[admin or worker]</span></li>
                                                                    <li value="2">Select <span class="uicontrol">5 - System</span>.</li>
                                                                    <li value="3">Select <span class="uicontrol">8- High Availability Configuration</span>.<br /></li>
                                                                    <li value="4">Select <span class="uicontrol">1 - Reset Key</span> node.</li>
                                                                    <li value="5">Enter <span class="userinput">y</span> to reset the keys being used by the high availability sync process or <span class="userinput">N</span> to abort the reset process.<br /></li>
                                                                    <li value="6">Enter <span class="userinput">x</span> to exit or any other menu item to continue.<br /></li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="CheckCluster"></a>Check the cluster configuration</h3>
                                                                <p>To review or check the status of an <span class="mc-variable okta-feature-names.Access_Gateway variable">Access Gateway</span> High Availability Cluster:</p>
                                                                <ol>
                                                                    <li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span>.<span class="codeblock">ssh oag-mgmt@[admin or worker]</span></li>
                                                                    <li value="2">Select <span class="uicontrol">5 - System</span>.</li>
                                                                    <li value="3">Select <span class="uicontrol">8- High Availability Configuration</span>.<br /></li>
                                                                    <li value="4">Select <span class="uicontrol">6 -Check Status</span>.	<div class="noteOkta"><p class="noteContent"><span class="uicontrol">Check Status</span> will show the latest status of the cluster only after there is a configuration change or when the NGINX engine is restarted. </p><p class="noteContent">If newly added nodes are not displayed, perform any <span class="mc-variable okta-feature-names.Access Gateway_UI variable">Access Gateway Admin UI console</span> function which causes an underlying engine status change. Or restart the NGINX engine.  See the <a href="command-line-console-reference-service.htm#NGIX">NGINX</a> sub-menu in the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span> <a href="command-line-console-reference-service.htm" class="MCXref xref">Service</a> section. </p></div></li>
                                                                    <li value="5">A list of cluster instances is displayed with their associated status, similar to the following:<span class="codeblock">HA Synch Status    Up/Down/Page Up/Page Down/Home/End - Scroll    x-exit
worker1.yourdoman.tld:    Pass
worker2.yourdoman.tld:    Pass
. . . 
workern.yourdoman.tld:    Fail</span>
					Where:
<ul><li>Pass: Reachable, functioning worker node.</li><li>Fail: Non-functional worker.  See the node log for details.</li></ul></li>
                                                                    <li value="6">Enter <span class="uicontrol">x</span> to exit.</li>
                                                                </ol>
                                                            </div>
                                                            <div>
                                                                <h3><a name="Resynch"></a>Synch worker with Admin</h3>
                                                                <p>If a worker node is out of synch because of downtime or network issues, this option can be used to synchronize the changes from an admin to a specific worker on demand.</p>
                                                                <div class="noteOkta">
                                                                    <p class="noteContent">This option is only available on worker instances.</p>
                                                                </div>
                                                                <ol>
                                                                    <li value="1">Connect to the <span class="mc-variable okta-feature-names.Access_Gateway_CMD variable">Access Gateway Management console</span> on the worker being synchronized.<span class="codeblock">ssh oag-mgmt@[&lt;worker&gt;]</span></li>
                                                                    <li value="2">Select <span class="uicontrol">5 - System</span>.</li>
                                                                    <li value="3">Select <span class="uicontrol">8- High Availability Configuration</span>.</li>
                                                                    <li value="4">Select <span class="uicontrol">8 - Synch from admin</span>, which displays a message similar to:
<span class="codeblock" xml:space="preserve">Requesting admin  node &lt;admin. . . .com&gt; to allow connection  
Node &lt;worker...com&gt; successfully added on admin node
Synchronizing current configuration  
 . . . 
Press enter to continue</span></li>
                                                                    <li value="5">Enter <span class="userinput">x</span> to exit.</li>
                                                                </ol>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- div class="toolbar-main">
            <MadCap:topicToolbarProxy data-mc-skin="/Project/Skins/okta-toolbar-no-expand.flskn" style="mc-topic-toolbar-items: ;" />
                </div -->
                                    <!-- *********************** Footer rows ********************************* -->
                                    <div class="footer2" data-test="footer">
                                        <div>
                                            <p class="copyright" data-test="copyrightNotice">©  <span class="mc-variable okta-variables.Year variable">2023</span> <span class="mc-variable okta-variables.CompanyName variable">Okta, Inc</span>. All Rights Reserved. Various trademarks held by their respective owners.
	</p>
                                        </div>
                                    </div>
                                    <!-- ********************** Scripts ************************************* -->
                                    <script src="../../resources/scripts/js/ignore-dompurify.js">
                                    </script>
                                    <script src="../../resources/scripts/js/app.js">
                                    </script>
                                    <script src="../../resources/scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/coveo.madcapflare.requirejs.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/coveo.madcapflare.okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                    <!-- Feedback tab for Qualtrics survey -->
                                    <div id="feedback-tab" data-mc-conditions="Primary.live-site-only"><a id="feedback-link" href="#" onclick="openSurvey();  return false" target="_blank" title="Submit feedback"><div id="feedback-container"><p id="feedback-text" translate="no">Feedback</p></div></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
