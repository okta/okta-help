<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_nav_poc" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-searchable="True" data-mc-toc-path="[%=System.LinkedHeader%]|[%=System.LinkedHeader%]" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="robots" content="noindex, nofollow" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Migrate users from an on-premises LDAP directory | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Pendo Script (Per Chris Bank) -->
        <!-- End Pendo Script -->
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../resources/stylesheets/okta-main-new-nav.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-NMZZV4P');
			/* ]]> */
		</script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KXMLV58');
			/* ]]> */
		</script>
        <script>
		/* <![CDATA[ */
		(function(apiKey){
			(function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
			v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
			o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
			y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
			z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id:              'VISITOR-UNIQUE-ID'
            },
            account: {
                id:           'ACCOUNT-UNIQUE-ID'
            }
        });
		})('a9bd3885-93ae-46ab-700b-dd29e613c19d');
		/* ]]> */
        function openSurvey() {
            window.open('https://surveys.okta.com/jfe/form/SV_e4L0iW8a3tz8Yol?source=' + encodeURIComponent(document.location.href), '_blank');
        }
		</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1024px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMZZV4P" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.OrgId variable">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="mc-variable okta-coveo-config.PlatformRestUri variable">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchPageUrl variable">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchTokenServiceUrl variable">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <div id="coveo_dev_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.DevOrgId variable">oktanonproduction1il1gtac7</span>
                                    </div>
                                    <div id="coveo_dev_token" style="Display:None"><span class="mc-variable okta-coveo-config.DevSearchToken variable">xxf1de37f5-c8aa-42db-a8ef-0cbf06dfa5e3</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************** Coveo Search bar ************************************* -->
                                    <!-- set margin and size in /Content/Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css to make room for replacing Flare-generated top-nav with HTML code (see below)-->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper" data-mc-conditions="MultiProdPublish.SearchBar">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="replace_top_nav">
                                        <div class="navbar" data-mc-conditions="Primary.live-site-only">
                                            <div class="dropdown" data-test="menuBarCategory" id="documentationMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">Documentation <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=oie-index" data-test="menuBarLink">Identity Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?id=index-admin" data-test="menuBarLink">Classic Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oag&amp;id=ext_oag_main" data-test="menuBarLink">Access Gateway</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=asa&amp;id=csh-asa-overview" data-test="menuBarLink">Advanced Server Access</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=wf&amp;id=ext-Okta-workflows" data-test="menuBarLink">Workflows</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="relnotesMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">Release notes <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=csh-oie-release-notes" data-test="menuBarLink">Identity Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?id=ext_okta_relnotes" data-test="menuBarLink">Classic Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oag&amp;id=ext_oag_releasenotes" data-test="menuBarLink">Access Gateway</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=asa&amp;id=ext-asa-releasenotes" data-test="menuBarLink">Advanced Server Access</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=wf&amp;id=ext-workflows-releasenotes" data-test="menuBarLink">Workflows</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="oktaDevDocsMenu"><a href="https://developer.okta.com/" target="_blank" data-test="menuBarLink">Okta Developer</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="auth0Menu"><a href="https://auth0.com/docs" target="_blank" data-test="menuBarLink">Auth0</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="trainingMenu"><a href="https://www.okta.com/services/training/" target="_blank" data-test="menuBarLink">Training</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="supportMenu"><a href="https://support.okta.com/help/s/?language=en_US" target="_blank" data-test="menuBarLink">Support</a>
                                            </div>
                                        </div>
                                        <div class="logo_container" id="OktaBanner" data-mc-conditions="Primary.live-site-only"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" data-test="OktaBanner"><img src="../../../resources/images/okta-assets/logo.png" alt="Okta product documentation" title="Okta product documentation" data-test="OktaBannerImg" /></a>
                                        </div>
                                        <div class="toolbar-main" data-test="toolBar" data-mc-conditions="Primary.live-site-only">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_no_expand mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie select-language-button" title="Change language">
                                                        <div>
                                                            <div role="img" class="button-icon-wrapper" aria-label="Change language">
                                                                <div class="button-icon"> </div>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics" data-test="bodyWrapper">
                                        <!-- *** Col1: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                                <div class="nocontent">
                                                    <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider="  &gt;  " data-mc-breadcrumbs-count="3" data-mc-toc="True">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main" data-test="bodyContent">
                                                <!-- Main content body -->
                                                <div role="main" id="mc-main-content">
                                                    <h1 id="migrate-users-from-an-on-premises-ldap-directory">Migrate users
from an on-premises LDAP directory</h1>
                                                    <p>Suppose you already handle authentication through an on-premises LDAP
directory but want to replace it with Okta. You can install an
on-premises Okta LDAP Agent to mirror those users to Universal Directory
and then redirect your applications to Okta for authentication. In this
scenario, Universal Directory serves as a single source of truth for
user data and lets administrators centrally manage policies and
profiles. You can assign them to any application registered with your
Okta org. Access to those assigned applications can be through any
protocol, such as LDAP Interface, OpenID Connect (OIDC), SAML, and so
on.</p>
                                                    <p>However, authentication of the LDAP user is delegated to the LDAP
server through the Okta LDAP Interface so that users can authenticate
with Okta using their LDAP directory server credentials. This directory
coexistence can stay in place until you migrate all your user
information to Universal Directory and no longer require the LDAP
directory.</p>
                                                    <p>In this tutorial, you create a sample web application that
authenticates directly with an on-premises OpenLDAP Directory Server.
Then, you migrate all the users in that directory to Universal Directory
with the Okta LDAP Agent. Finally, you update the application to
authenticate its users with Universal Directory through the Okta LDAP
Interface. Specifically:</p>
                                                    <ol type="1">
                                                        <li value="1"><a href="#set-up-the-start-scenario">Set up the start scenario</a>.
Spin up a simple OIDC-based web application in a Docker container that
authenticates its user against an OpenLDAP Directory server you've
started in a second Docker container. At this point, Okta isn't involved
in the authentication flow. Use a username and password to authenticate
directly with the LDAP directory server.</li>
                                                        <li value="2"><a href="#connect-okta-ldap-agent-and-import-users">Connect Okta
LDAP Agent and Import Users</a>. Spin up an Okta LDAP Agent instance in
a Docker container. Connect it to the OpenLDAP directory server and
Okta, and then import your LDAP users and groups into Universal
Directory.</li>
                                                        <li value="3"><a href="#update-the-application-to-point-to-the-okta-ldap-interface">Update
the application to point to the Okta LDAP Interface</a>. Your
application still expects to use LDAP to authenticate users. Initialize
and configure an Okta LDAP Interface and configure your application to
query that instead of the on-premises LDAP directory. The Okta service
then delegates authentication back to the on-premises LDAP directory
server.</li>
                                                        <li value="4"><a href="#update-the-application-to-use-oidc">Update application to
use OIDC instead of LDAP</a>. Build and register an OIDC web application
with Okta to replace the Okta LDAP Interface.</li>
                                                        <li value="5">(Optional) <a href="#migrate-users-from-ldap-to-okta">Complete the
migration of users from LDAP to Universal Directory</a>. Disable
delegated authentication back to the LDAP server and make your
applications authenticate only with Okta.</li>
                                                    </ol>
                                                    <p>At the end of step 4, when a user attempts to sign in to the
application, their authorization request is redirected to Okta and then
delegated to the LDAP directory. At the end of step 5, their
authorization request is handled entirely by Okta.</p>
                                                    <div class="three-quarter">
                                                        <p>
                                                            <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-flow-diagram.png" alt="An architecture diagram showing the authorization flow from user to Okta to an OpenLDAP Directory server and back again." />
                                                        </p>
                                                        <!--
    Source image: https://www.figma.com/file/YH5Zhzp66kGCglrXQUag2E/%F0%9F%93%8A-Updated-Diagrams-for-Dev-Docs?type=design&node-id=3714%3A41148&t=U52HeyImgt4pt3M2-1 ldap-to-okta-flow-diagram
  -->
                                                    </div>
                                                    <div class="noteOkta">
                                                        <p class="noteContent"> This tutorial uses three <a href="https://www.docker.com">Docker</a> containers that run a sample
web application, an OpenLDAP directory server, and an on-premises Okta
LDAP Agent. The tutorial also configures a cloud-based Okta LDAP
Interface. For information on integrating your LDAP instance with Okta,
see <a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=ext_LDAP_Provisioning">Manage
your LDAP integration</a></p>
                                                    </div>
                                                    <h2 id="set-up-the-start-scenario">Set up the start scenario</h2>
                                                    <p>Create the initial environment for the tutorial where an application
authenticates directly with an OpenLDAP directory server running
on-premises in a Docker container.</p>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>Change to your project directory and clone the
<code>ldap-users</code> branch of the
<code>okta-reference-coexistence-ldap-example</code> repository:</p>
                                                            <p><span class="codeblock">cd ${your project directory} git clone https://github.com/oktadev/okta-reference-coexistence-ldap-example -b ldap-users</span>
                                                            </p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Change to the
<code>okta-reference-coexistence-ldap-example</code> directory:</p>
                                                            <p><span class="codeblock">cd
okta-reference-coexistence-ldap-example</span>
                                                            </p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Start the application. The <code>docker compose up</code> command
uses the
<code>okta-reference-coexistence-ldap-example/docker-compose.yml</code>
file to start the two containers. One runs the web app, and one runs the
OpenLDAP directory server.</p>
                                                            <p><span class="codeblock">docker compose up</span>
                                                            </p>
                                                            <p>If successful, you should see the
<code>okta-reference-coexistence-ldap-example-webapp-1</code> started in
your terminal, similar to:</p>
                                                            <p><span class="codeblock">okta-reference-coexistence-ldap-example-webapp-1
| 2022-09-01 20:51:24.536 INFO 1 --- [ main]
o.s.l.c.support.AbstractContextSource : Property 'userDn' not set -
anonymous context will be used for read-write operations
okta-reference-coexistence-ldap-example-webapp-1 | 2022-09-01
20:51:24.857 INFO 1 --- [ main] o.s.b.w.embedded.tomcat.TomcatWebServer
: Tomcat started on port(s): 8080 (http) with context path ''
okta-reference-coexistence-ldap-example-webapp-1 | 2022-09-01
20:51:24.867 INFO 1 --- [ main] com.okta.example.ra.Application :
Started Application in 2.033 seconds (JVM running for
2.371)</span>
                                                            </p>
                                                        </li>
                                                        <li value="4">
                                                            <p>Open a private/incognito browser window and go to
<code>http://localhost:8080</code> to display the LDAP directory sign-in
dialog.</p>
                                                            <div class="half wireframe-border">
                                                                <p>
                                                                    <img src="/img/wireframes/sign-in-form-username-password.png" alt="A sign-in form with fields for username and password and a next button" />
                                                                </p>
                                                                <!--
Source image: https://www.figma.com/file/YH5Zhzp66kGCglrXQUag2E/%F0%9F%93%8A-Updated-Diagrams-for-Dev-Docs?node-id=3398%3A36678&t=wzNwSZkdctajVush-1 sign-in-form-username-password
-->
                                                            </div>
                                                            <p>The OpenLDAP directory contains three users defined in the
<code>ldifs\users.ldif</code> file. At the prompt, sign in with username
<span class="uicontrol">user01</span> and password <span class="uicontrol">password1</span>. The
following dialog appears after successful authentication:</p>
                                                            <div class="border">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-signin-response.png" alt="Sign-in response with welcome home successful authentication response" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                    </ol>
                                                    <h2 id="connect-okta-ldap-agent-and-import-users">Connect Okta LDAP
Agent and import users</h2>
                                                    <p>With the basic environment set up, connect the OpenLDAP directory
server to your Okta org with an instance of Okta LDAP Agent. Then,
import the LDAP users into Universal Directory.</p>
                                                    <div class="noteOkta">
                                                        <p class="noteContent"> Okta LDAP Agent is installed on-premises in
the same network as the LDAP server that it's connecting to Okta. For
this lab, you use an Okta LDAP Agent instance in a Docker container.</p>
                                                    </div>
                                                    <h3 id="sign-in-to-your-okta-account">Sign in to your Okta account</h3>
                                                    <p>Stop the currently running containers and sign in to your Okta
account.</p>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>In the <code>okta-reference-coexistence-ldap-example</code>
directory, stop the currently running containers with <code>Ctrl + C</code>.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Run <code>okta login</code>.</p>
                                                            <p><span class="codeblock">okta login</span>
                                                            </p>
                                                            <p>If you're already signed in to Okta, a prompt similar to the
following is returned. The current sign-in configuration is based on the
Okta org URL and API token that you provided at your previous
<code>okta login</code> command. If you want to use the existing
configuration, answer <span class="uicontrol">N</span> and skip steps a and b.
Otherwise, answer <span class="uicontrol">Y</span> and continue to steps a and b.</p>
                                                            <p><span class="codeblock">An existing Okta Organization (https://dev-133337.okta.com) was
found in C:\mydirectory.okta\okta.yaml Overwrite configuration file?
[Y/n]</span>
                                                            </p>
                                                            <p>If Okta CLI returns an error "Your Okta Org is missing a feature
required to use the Okta CLI: API Access Management," you aren't using
an Okta developer account. To resolve this error, see <a href="lab.htm#okta-developer-account">Okta
developer account</a>.</p>
                                                            <ol type="1">
                                                                <li value="1">Enter your <code>${OKTA_DOMAIN}</code>. If you don't know your
<code>${OKTA_DOMAIN}</code>, see <a href="lab.htm#values-and-variables">Values
and variables</a>.</li>
                                                                <li value="2">Follow the instructions in <a href="/docs/guides/create-an-api-token">Create an API token</a> to
create a token. After you have the token, enter it at the Okta API token
prompt.</li>
                                                            </ol>
                                                        </li>
                                                    </ol>
                                                    <h3 id="set-up-the-okta-ldap-agent">Set up the Okta LDAP Agent</h3>
                                                    <p>Connect the LDAP directory server to Okta with an Okta LDAP Agent.
The Okta LDAP Agent provides delegated authentication to the on-premises
LDAP server so your users can authenticate to Okta using their local
LDAP credentials.</p>
                                                    <div class="noteOkta">
                                                        <p class="noteContent"> Set up Just-In-Time (JIT) provisioning in the
Okta LDAP agent at this point if you want to use a <a href="directory-coexistence.htm#just-in-time-migration">JIT
migration strategy</a>. Remember that this allows LDAP server and
Universal Directory profiles to coexist. It also provides a seamless
experience because users don't have to create a new username or password
in Universal Directory. After your users are mirrored in Okta, you can
stop delegating authentication to the LDAP server and have Okta be
solely responsible for authentication, as described in <a href="#migrate-users-from-ldap-to-okta">Migrate users from LDAP to
Okta</a>.</p>
                                                    </div>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>In the <code>okta-reference-coexistence-ldap-example</code>
directory, check out the <code>agent</code> branch from the
<code>okta-reference-coexistence-ldap-example</code> repository. This
branch contains a Docker container that runs an Okta LDAP Agent.</p>
                                                            <p><span class="codeblock">git checkout agent</span>
                                                            </p>
                                                            <p>A successful checkout creates an
<code>okta-reference-coexistence-ldap-example\okta-ldap-agent</code>
directory.</p>
                                                            <div class="noteOkta">
                                                                <p class="noteContent"> For installation options, see <a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=ext_LDAP_Provisioning">Manage
your LDAP integration</a>.</p>
                                                            </div>
                                                        </li>
                                                        <li value="2">
                                                            <p>Rebuild the containers:</p>
                                                            <p><span class="codeblock">docker compose build</span>
                                                            </p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Edit the
<code>okta-reference-coexistence-ldap-example/.env</code> file, which
stores Okta-related configurations. Edit the <span class="uicontrol">OKTA_URL</span>
line so it points to your free Okta account:</p>
                                                        </li>
                                                    </ol>
                                                    <p><span class="codeblock">OKTA_URL="https://${OKTA_DOMAIN}"</span>
                                                    </p>
                                                    <p>For example, <code>OKTA_URL="https://dev-133337.okta.com"</code></p>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>In the terminal, start the application:</p>
                                                            <p><span class="codeblock">docker compose up</span>
                                                            </p>
                                                        </li>
                                                        <li value="2">
                                                            <p>The first time the <span class="uicontrol">ldap-agent</span> container starts,
an authentication link is provided in the terminal output.</p>
                                                            <p><span class="codeblock">ldap-agent Please visit the URL: https://dev-133337.okta.com/oauth2/auth?code=mzsggy7t
before Fri Feb 03 20:00:00 UTC 2023 to authenticate and continue agent
reistration.</span>
                                                            </p>
                                                            <div class="note_tipOkta">
                                                                <p class="noteContent"> If you don't see a link for the
<code>ldap-agent</code> in the terminal output, or you see
<code>ldap-agent</code> exited with code 3, type <code>Ctrl + C</code> in the terminal to stop the application. Next, in the
<code>okta-reference-coexistence-ldap-example/.env</code> file, verify
that you have straight quotes and that your Okta account name is spelled
correctly. Correct any errors and save the file. Finally, in the
terminal, run <code>docker compose up</code>.</p>
                                                            </div>
                                                        </li>
                                                        <li value="3">
                                                            <p>Open a browser and go to the URL provided in the terminal to link
the Okta LDAP Agent with your free Okta account. For example, for the
sample terminal output shown in the previous step go to
<code>https://dev-133337.okta.com/oauth2/auth?code=mzsggy7t</code>.</p>
                                                            <div class="note_cautionOkta">
                                                                <p class="noteContent"> You must complete this step within 10
minutes of executing <code>docker compose up</code>.</p>
                                                            </div>
                                                            <p>A <span class="uicontrol">token is expired</span> message may be output to the
terminal or displayed when attempting to go to the URL in the
browser.</p>
                                                            <div class="half">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-agent-token-expired-dialog.png" alt="Message in browser showing token expired message" />
                                                                </p>
                                                            </div>
                                                            <p>If it appears, perform the following steps:</p>
                                                            <ol type="1">
                                                                <li value="1">Type <code>Ctrl +  C</code> in the terminal to stop the
container.</li>
                                                                <li value="2">Type <code>docker compose down</code> to stop and delete the
container.</li>
                                                                <li value="3">Open Docker Desktop and delete the
<code>okta-reference-coexistence-ldap-example</code> container, if
present.</li>
                                                                <li value="4">Open the Admin Console for your org and delete any LDAP agents,
interfaces, and users that you've imported or added in this
exercise.</li>
                                                                <li value="5">Type <code>docker compose up</code> to start the container.</li>
                                                            </ol>
                                                        </li>
                                                        <li value="4">
                                                            <p>If requested, sign in to your Okta account.</p>
                                                        </li>
                                                        <li value="5">
                                                            <p>Click or tap <span class="uicontrol">Allow Access</span> to allow the Okta LDAP
Agent access to the Okta API.</p>
                                                            <div class="three-quarter">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-allow-access-to-okta-api.png" alt="dialog, Okta LDAP agent requesting permission to access Okta api" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                        <li value="6">
                                                            <p>Click or tap <span class="uicontrol">Continue</span> to complete the
connection. A dialog appears to confirm the connection.</p>
                                                            <div class="three-quarter">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-successful-access-to-okta.png" alt="dialog, Okta LDAP agent successful access to Okta api" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                    </ol>
                                                    <h3 id="configure-the-ldap-agent">Configure the LDAP Agent</h3>
                                                    <p>The Okta LDAP Agent is now connected to the LDAP server and Okta.
However, you still need to configure it using the Admin Console. This
configuration provides the mappings between users and groups in the
Universal Directory and the users and groups in your LDAP directory.</p>
                                                    <p>First, make sure that the LDAP Agent is operational:</p>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>Open the Admin Console for your Okta org.</p>
                                                            <p><code>https://${OKTA_DOMAIN_NAME}-admin.okta.com</code>
                                                            </p>
                                                            <p>For example, if <code>${OKTA_DOMAIN_NAME}</code> is
<code>dev-133337</code>, you access your Admin Console at
<code>https://dev-133337-admin.okta.com</code>.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Choose <span class="menucascade"><span class="uicontrol">Dashboard</span><span class="uicontrol">Dashboard</span></span>
to see the status of your org.</p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Locate the <span class="uicontrol">Status</span> section, and click
<span class="uicontrol">Agents</span> to see the agents associated with your free Okta
account:</p>
                                                            <div class="full">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-dashboard-agents-link.png" alt="Okta dashboard showing agents link" />
                                                                </p>
                                                            </div>
                                                            <p>The ldap-agent's <span class="uicontrol">Status</span> should be
<span class="uicontrol">Operational</span> with a green dot:</p>
                                                            <div class="full border">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-agent-green-and-operational.png" alt="Okta dashboard showing LDAP agent status green and operational" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                    </ol>
                                                    <p>Now you can configure the details of the LDAP integration. Okta
provides defaults, but if you're using a different LDAP configuration,
you may need to modify the configuration. For information on each
setting, see <a href="https://help.okta.com/okta_help.htm?id=ext-ldap-config-intg-settings">Configure
LDAP integration settings</a>.</p>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>Choose <span class="menucascade"><span class="uicontrol">Directory</span><span class="uicontrol">Directory
Integrations</span></span> to see the current directory
integrations.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Click <span class="uicontrol">LDAP</span> to configure the user mappings.</p>
                                                            <div class="full border">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-directory-integrations.png" alt="Okta dashboard showing directory integrations" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                        <li value="3">
                                                            <p>Set <span class="uicontrol">LDAP Version</span> to
<span class="uicontrol">OpenLDAP</span>.</p>
                                                            <div class="noteOkta">
                                                                <p class="noteContent"> For additional information on which LDAP
directories you can integrate with Okta, see <a href="https://help.okta.com/okta_help.htm?id=ext-ldap-agent-supported-directories">Supported
LDAP directories</a>.</p>
                                                            </div>
                                                        </li>
                                                        <li value="4">
                                                            <p>Set <span class="uicontrol">User Search Base</span> to
<span class="uicontrol">ou=users,dc=example,dc=org</span>.</p>
                                                        </li>
                                                        <li value="5">
                                                            <p>Update the following <span class="uicontrol">Group</span> values:</p>
                                                            <table>
                                                                <thead>
                                                                    <tr class="header">
                                                                        <th>Property</th>
                                                                        <th>Value</th>
                                                                        <th>Description</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="odd">
                                                                        <td>Group Search Base</td>
                                                                        <td><code>ou=groups,dc=example,dc=org</code>
                                                                        </td>
                                                                        <td>The Distinguished Name (DN) of the container for group searches
(that is, the root of the group subtree) that holds all groups to be
imported into your Okta org. The full search path for your groups.</td>
                                                                    </tr>
                                                                    <tr class="even">
                                                                        <td>Group Object Class</td>
                                                                        <td><code>posixgroup</code>
                                                                        </td>
                                                                        <td>The object class for your groups. Okta uses this in its query when
importing groups.</td>
                                                                    </tr>
                                                                    <tr class="odd">
                                                                        <td>Group Object Filter</td>
                                                                        <td><code>(objectclass=posixgroup)</code>
                                                                        </td>
                                                                        <td>The group search filter.</td>
                                                                    </tr>
                                                                    <tr class="even">
                                                                        <td>Member Attribute</td>
                                                                        <td><code>memberuid</code>
                                                                        </td>
                                                                        <td>The attribute that contains the Distinguished Name of the user.</td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </li>
                                                        <li value="6">
                                                            <p>Locate the <span class="uicontrol">Validate Configuration</span> section and
set <span class="uicontrol">Okta username format</span> to <span class="uicontrol">Email
address</span>.</p>
                                                        </li>
                                                        <li value="7">
                                                            <p>Set <span class="uicontrol">Example username</span> to
<span class="uicontrol"><code>user01@example.com</code></span>.</p>
                                                        </li>
                                                        <li value="8">
                                                            <p>Click <span class="uicontrol">Test Configuration</span>. Results similar to the
following appear:</p>
                                                            <div class="full">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-successful-validation.png" alt="Okta dashboard showing validation successful message" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                        <li value="9">
                                                            <p>Click <span class="uicontrol">Next</span> and then click
<span class="uicontrol">Done</span>.</p>
                                                        </li>
                                                    </ol>
                                                    <p>Choose <span class="menucascade"><span class="uicontrol">Directory</span><span class="uicontrol">Directory
Integrations</span><span class="uicontrol">LDAP</span><span class="uicontrol">Provisioning</span><span class="uicontrol">To Okta</span></span> to see the
mappings of the user and group attributes from LDAP to Okta. On this
page, you can create individual LDAP to Okta attribute mappings,
configure JIT provisioning, and various other settings. For this
example, leave this page as is.</p>
                                                    <div class="noteOkta">
                                                        <p class="noteContent"> For more information on the LDAP to Okta
integration settings, see <a href="https://help.okta.com/okta_help.htm?topic=oie&amp;id=ext_cofigure_ldap_okta_settings">Configure
LDAP to Okta provisioning settings</a>.</p>
                                                    </div>
                                                    <p>You're now ready to synchronize your LDAP users with Okta.</p>
                                                    <h3 id="import-users-and-groups">Import users and groups</h3>
                                                    <p>The Okta LDAP Agent now connects the LDAP Server to Okta so you can
import users and groups from the LDAP directory to the Okta Universal
Directory.</p>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>Choose <span class="menucascade"><span class="uicontrol">Directory</span><span class="uicontrol">Directory
Integrations</span></span>.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Click <span class="uicontrol">LDAP</span> to access your LDAP
connection.</p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Select <span class="uicontrol">Import</span>.</p>
                                                        </li>
                                                        <li value="4">
                                                            <p>In the <span class="uicontrol">Import Results</span> section, click
<span class="uicontrol">Import Now</span>.</p>
                                                        </li>
                                                        <li value="5">
                                                            <p>Select <span class="uicontrol">Import</span> to see all the users available to
import:</p>
                                                            <div class="three-quarter border">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-import-from-ldap-import-button.png" alt="Import from LDAP incremental report" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                        <li value="6">
                                                            <p>Click <span class="uicontrol">OK</span> on the dialog that shows the statistics
summary.</p>
                                                            <div class="half border">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-import-statistics.png" alt="Statistics summary showing three users and one group imported" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                        <li value="7">
                                                            <p>In the report, you can see how each LDAP directory user is mapped
to a user in Universal Directory.</p>
                                                            <p>Select all available users and click <span class="uicontrol">Confirm
Assignments</span>.</p>
                                                            <div class="full border">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-confirm-assignments.png" alt="Okta user assignments" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                        <li value="8">
                                                            <p>Select <span class="uicontrol">Auto-activate users after confirmation</span> in
the <span class="uicontrol">Confirm Imported User Assignments</span> dialog.</p>
                                                        </li>
                                                        <li value="9">
                                                            <p>Click <span class="uicontrol">Confirm</span>. All users and groups are now
imported from the LDAP directory to Universal Directory.</p>
                                                        </li>
                                                        <li value="10">
                                                            <p>Choose <span class="menucascade"><span class="uicontrol">Directory</span><span class="uicontrol">People</span></span> to
view the imported users.</p>
                                                            <div class="three-quarter border">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-directory-3-users-imported-from-ldap.png" alt="Okta user assignments" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                    </ol>
                                                    <p>The selected LDAP users and groups are now imported, and you can
assign them to any application that you've registered with your Okta
org. Users can access those assigned applications through any protocol,
such as LDAP Interface, OIDC, SAML, and so on.</p>
                                                    <p>However, authentication of the LDAP user is delegated to the LDAP
server through the Okta LDAP Agent. Delegated authentication is used
when that user signs in to an assigned application in your Okta org.</p>
                                                    <p>For this tutorial, there's only one on-premises LDAP directory
server. If you had LDAP directories running on other servers, you could
install an Okta LDAP Agent for each LDAP server and import those LDAP
users into Okta as well.</p>
                                                    <p>To update an application to authenticate against Okta Universal
Directory instead of the LDAP directory, you can either</p>
                                                    <ul>
                                                        <li><a href="#update-the-application-to-point-to-the-okta-ldap-interface">Update
your application to point to an Okta LDAP Interface</a>.</li>
                                                        <li><a href="#update-the-application-to-use-oidc">Update your
application to use OIDC</a>.</li>
                                                    </ul>
                                                    <p>This tutorial goes through the steps for each, starting with the Okta
LDAP Interface. However, we recommend updating your application to use
OIDC instead of the Okta LDAP Interface because OIDC is more secure.</p>
                                                    <h2 id="update-the-application-to-point-to-the-okta-ldap-interface">Update
the application to point to the Okta LDAP Interface</h2>
                                                    <p>The <a href="https://help.okta.com/okta_help.htm?topic=oie&amp;id=ext_LDAP_Using_the_LDAP_Interface">Okta
LDAP Interface</a> exposes Okta's users and groups to applications using
the LDAP protocol. In this section, you connect the
<code>okta-reference-coexistence-ldap-example</code> application to
Universal Directory through the Okta LDAP Interface. Universal Directory
delegates authentication back to the on-premises LDAP directory server
through the LDAP Agent.</p>
                                                    <div class="noteOkta">
                                                        <p class="noteContent"> For this example, the application needs to
change the LDAP configuration.</p>
                                                    </div>
                                                    <h3 id="enable-the-okta-ldap-interface">Enable the Okta LDAP
Interface</h3>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>In your terminal, stop the applications running in the
<code>okta-reference-coexistence-ldap-example</code> directory with
<kbd>Ctrl</kbd> + <kbd>C</kbd>.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Check out the <code>okta-ldap</code> branch:</p>
                                                            <p><span class="codeblock">git checkout okta-ldap</span>
                                                            </p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Open the Admin Console for your org.</p>
                                                        </li>
                                                        <li value="4">
                                                            <p>Choose <span class="menucascade"><span class="uicontrol">Directory</span><span class="uicontrol">Directory
Integrations</span></span> to see the current directory
integrations.</p>
                                                        </li>
                                                        <li value="5">
                                                            <p>Choose <span class="menucascade"><span class="uicontrol">Add Directory</span><span class="uicontrol">Add
LDAP</span></span> Interface.</p>
                                                        </li>
                                                        <li value="6">
                                                            <p>Click <span class="uicontrol">Edit</span> in the <span class="uicontrol">LDAP Interface
page</span> to edit this directory's configuration.</p>
                                                        </li>
                                                        <li value="7">
                                                            <p>Locate the <span class="uicontrol">Groups section</span> and set
<span class="uicontrol">Configuration</span> to <span class="uicontrol">Okta groups and app
groups</span>.</p>
                                                            <div class="noteOkta">
                                                                <p class="noteContent">See the <a href="https://help.okta.com/okta_help.htm?&amp;id=ext_expose_app_groups">LDAP
Groups settings</a>.</p>
                                                            </div>
                                                        </li>
                                                        <li value="8">
                                                            <p>Click <span class="uicontrol">Save</span>.</p>
                                                        </li>
                                                        <li value="9">
                                                            <p>Choose <span class="menucascade"><span class="uicontrol">Directory</span><span class="menucascade"><span class="uicontrol">Directory Integrations</span><span class="uicontrol">LDAP</span></span></span>. Make a note of the text after
<code>/instance/</code> at the end of the browser URL. The text is your
<code>${OKTA_LDAP_ID}</code>.</p>
                                                            <div class="full border">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-ldap-id-in-browser-url.png" alt="Okta user assignments" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                        <li value="10">
                                                            <p>Update the
<code>okta-reference-coexistence-ldap-example/.env</code> file with the
following values, and then save the file.</p>
                                                        </li>
                                                    </ol>
                                                    <p>You can also review <a href="https://github.com/oktadev/okta-reference-coexistence-ldap-example/commit/577f7b8df0e0c1b52272bdd38269784c814c67cf">additional
changes in the application</a> that allow it to access the Okta LDAP
Interface for authentication.</p>
                                                    <table>
                                                        <thead>
                                                            <tr class="header">
                                                                <th>Key</th>
                                                                <th>Value (example)</th>
                                                                <th>Description</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr class="odd">
                                                                <td><code>OKTA_LDAP_HOST</code>
                                                                </td>
                                                                <td><code>dev-133337.ldap.okta.com</code>
                                                                </td>
                                                                <td>LDAP Host name
  Replace <code>dev-133337</code> with
${OKTA_DOMAIN_NAME}. See <a href="lab.htm#values-and-variables">Values
and variables</a>.</td>
                                                            </tr>
                                                            <tr class="even">
                                                                <td><code>OKTA_LDAP_BASE</code>
                                                                </td>
                                                                <td><code>dc=dev-133337, dc=okta, dc=com</code>
                                                                </td>
                                                                <td>Base Distinguished Name
   Replace <code>dev-133337</code> with
${OKTA_DOMAIN_NAME}.</td>
                                                            </tr>
                                                            <tr class="odd">
                                                                <td><code>OKTA_LDAP_ID</code>
                                                                </td>
                                                                <td><code>&lt;yourOktaLdapId&gt;</code>
                                                                </td>
                                                                <td>The ID of the directory integration, found in the URL of integration
named LDAP.
  The URL is similar to
<code>/admin/app/ldap_sun_one/instance/{ID}</code>.
  The ID is
similar to <code>0oa6qvmxznVl4KFXe5d7</code>.</td>
                                                            </tr>
                                                            <tr class="even">
                                                                <td><code>OKTA_LDAP_USERNAME</code>
                                                                </td>
                                                                <td><code>ldap-user</code>
                                                                </td>
                                                                <td>A static user that has access to read user group information. See
the following section on how to create a user with restricted
access.</td>
                                                            </tr>
                                                            <tr class="odd">
                                                                <td><code>OKTA_LDAP_PASSWORD</code>
                                                                </td>
                                                                <td><code>&lt;change-me&gt;</code>
                                                                </td>
                                                                <td>Password for the user. Enter an actual value for the password and
make note of it.</td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                    <h3 id="create-a-user-to-access-the-okta-ldap-interface">Create a user
to access the Okta LDAP Interface</h3>
                                                    <p>In this section, you create a new user with a new admin role in
Universal Directory. This user connects the application to the Okta LDAP
Interface.</p>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>Open the Admin Console for your org.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Choose <span class="menucascade"><span class="uicontrol">Directory</span><span class="uicontrol">People</span><span class="uicontrol">Add Person</span></span>.</p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Enter the following values, and then press
<span class="uicontrol">Save</span>.</p>
                                                            <table>
                                                                <thead>
                                                                    <tr class="header">
                                                                        <th>Field name</th>
                                                                        <th>Value</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <tr class="odd">
                                                                        <td>First name</td>
                                                                        <td><code>LDAP</code>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="even">
                                                                        <td>Last name</td>
                                                                        <td><code>User</code>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="odd">
                                                                        <td>Username</td>
                                                                        <td><code>ldap-user@example.com</code>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="even">
                                                                        <td>Primary email</td>
                                                                        <td><code>ldap-user@example.com</code>
                                                                        </td>
                                                                    </tr>
                                                                    <tr class="odd">
                                                                        <td>I will set password</td>
                                                                        <td>Click <span class="uicontrol">I will set password</span> and then enter the
password that you set for the <code>OKTA_LDAP_PASSWORD</code> variable
in the <code>.env</code> file.</td>
                                                                    </tr>
                                                                    <tr class="even">
                                                                        <td>User must change password on first login</td>
                                                                        <td><code>false</code>
  Click <span class="uicontrol">User must change password on
first login</span> to clear the field.</td>
                                                                    </tr>
                                                                </tbody>
                                                            </table>
                                                        </li>
                                                        <li value="4">
                                                            <p>Create an admin role:</p>
                                                            <ol type="1">
                                                                <li value="1">Choose <span class="menucascade"><span class="uicontrol">Security</span><span class="uicontrol">Administrators</span><span class="uicontrol">Resources</span><span class="uicontrol">Create new resource set</span></span>.</li>
                                                                <li value="2">Set <span class="uicontrol">Resource set name</span> to <span class="uicontrol">Users &amp;
Groups</span>. This sets <span class="uicontrol">Resource set description</span> to
the same value.</li>
                                                                <li value="3">Set<span class="uicontrol">Resource type</span> to <span class="uicontrol">Users</span>.</li>
                                                                <li value="4">Verify that <span class="uicontrol">Constrain to all Users</span> is
selected.</li>
                                                                <li value="5">Click <span class="uicontrol">Add another resource type</span>.</li>
                                                                <li value="6">Set the second <span class="uicontrol">Resource type</span> to
<span class="uicontrol">Groups</span>.</li>
                                                                <li value="7">Verify the second <span class="uicontrol">Constrain to all Users</span> is
selected.</li>
                                                                <li value="8">Click <span class="uicontrol">Save resource set</span>.</li>
                                                                <li value="9">Choose <span class="menucascade"><span class="uicontrol">Roles</span><span class="uicontrol">Create new
role</span></span>.</li>
                                                                <li value="10">Set <span class="uicontrol">Role name</span> to
<span class="uicontrol">groups-user-reader</span>.</li>
                                                                <li value="11">Set <span class="uicontrol">Role description</span> to <span class="uicontrol">Groups Users
Reader</span>.</li>
                                                                <li value="12">Locate the <span class="uicontrol">User permissions</span> section and verify
<span class="uicontrol">View users and their details</span> is selected.</li>
                                                                <li value="13">Locate the <span class="uicontrol">Group permissions</span> section and verify
<span class="uicontrol">View groups and their details</span> is selected.</li>
                                                                <li value="14">Click <span class="uicontrol">Save role</span>.</li>
                                                            </ol>
                                                        </li>
                                                        <li value="5">
                                                            <p>Assign the admin role to your new user:</p>
                                                            <ol type="1">
                                                                <li value="1">Select <span class="menucascade"><span class="uicontrol">Admins</span><span class="uicontrol">Add
administrator</span></span>.</li>
                                                                <li value="2">Locate the <span class="uicontrol">Administrator assignment by admin</span> page
and set <span class="uicontrol">Admin</span> to <span class="uicontrol">LDAP User
(<code>ldap-user@example.com</code>)</span>.</li>
                                                                <li value="3">Set <span class="uicontrol">Role</span> to
<span class="uicontrol">groups-user-reader</span>.</li>
                                                                <li value="4">Set <span class="uicontrol">Resource set</span> to <span class="uicontrol">Users and
Groups</span>.</li>
                                                                <li value="5">Click <span class="uicontrol">Save Changes</span>.</li>
                                                                <li value="6">Refresh the <span class="uicontrol">Administrator</span> page to see your new
administrator, <span class="uicontrol">LDAP User</span>.</li>
                                                            </ol>
                                                        </li>
                                                    </ol>
                                                    <p>You can test the user's access using the following
<code>ldapsearch</code> command in the terminal. Remember to first
replace <code>${OKTA_DOMAIN_NAME}</code> with your Okta org name and
<code>${OKTA_LDAP_PASSWORD}</code> with the password that you set for
the <code>OKTA_LDAP_PASSWORD</code> variable in the
<code>okta-reference-coexistence-ldap-example/.env</code> file
first.</p>
                                                    <p><span class="codeblock">docker run bitnami/openldap:2 ldapsearch -x -b "ou=groups,dc=dev-133337,dc=okta,dc=com" -H ldaps://${OKTA_DOMAIN_NAME}.ldap.okta.com:636 -D uid=ldap-user,dc=dev-133337,dc=okta,dc=com -w '${OKTA_LDAP_PASSWORD}'</span>
                                                    </p>
                                                    <p>The result is a list of groups with <code>uniqueMember</code>
attributes, including your admin user and the three users that you
imported from the LDAP server into Okta. A portion of the listing is
similar to the following:</p>
                                                    <p><span class="codeblock">uniqueMember: uid=ldap-user@example.com,ou=users,dc=dev-133337,dc=okta,dc=com
uniqueMember: uid=user01@example.com,ou=users,dc=dev-133337,dc=okta,dc=com
uniqueMember: uid=user02@example.com,ou=users,dc=dev-133337,dc=okta,dc=com
uniqueMember: uid=user03@example.com,ou=users,dc=dev-133337,dc=okta,dc=com</span>
                                                    </p>
                                                    <h3 id="rebuild-the-application-to-incorporate-your-changes">Rebuild the
application to incorporate your changes</h3>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>Rebuild the application:</p>
                                                            <p><span class="codeblock">docker compose build</span>
                                                            </p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Start the application:</p>
                                                        </li>
                                                    </ol>
                                                    <p><span class="codeblock">docker compose up</span>
                                                    </p>
                                                    <ol start="3" type="1">
                                                        <li value="3">
                                                            <p>Open a private/incognito window and go to the same URL as before:
<code>http://localhost:8080</code>.</p>
                                                        </li>
                                                        <li value="4">
                                                            <p>Sign in with the imported user's email address and password:
<code>user01@example.com</code> and <code>password1</code>.</p>
                                                            <p>A successful sign-in flow returns the following dialog:</p>
                                                            <div class="half border">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-signin-to-ldap-directory.png" alt="Successful sign-in dialog saying Welcome home user01" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                    </ol>
                                                    <h3 id="troubleshooting">Troubleshooting</h3>
                                                    <p>If you see an error message similar to the following when you sign
in:</p>
                                                    <div class="half border">
                                                        <p>
                                                            <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-error-didnt-update-okta-domain.png" alt="Sign-in nested exception" />
                                                        </p>
                                                    </div>
                                                    <p>Perform the following steps:</p>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>Enter <code>Ctrl + C</code> in the terminal to stop the
containers.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Enter <code>docker compose down</code> to stop and delete the
containers.</p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Edit the
<code>okta-reference-coexistence-ldap-example/.env</code> file and
replace any incorrect Okta org names, such as <code>dev-133337</code>,
with your Okta org name. Verify the values for
<code>OKTA_LDAP_HOST</code>, <code>OKTA_LDAP_BASE</code>,
<code>OKTA_LDAP_ID</code>, <code>OKTA_LDAP_USERNAME</code>, and
<code>OKTA_LDAP_PASSWORD</code>.</p>
                                                        </li>
                                                        <li value="4">
                                                            <p>Save the
<code>okta-reference-coexistence-ldap-example/.env</code> file.</p>
                                                        </li>
                                                        <li value="5">
                                                            <p>In the terminal, start the application with
<code>docker compose up</code>.</p>
                                                        </li>
                                                        <li value="6">
                                                            <p>Repeat steps 3 and 4 from the previous section to sign in to the
application.</p>
                                                        </li>
                                                    </ol>
                                                    <h2 id="update-the-application-to-use-oidc">Update the application to
use OIDC</h2>
                                                    <p>You can replace the Okta LDAP Interface by updating the application
to use OIDC.</p>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>In the <code>okta-reference-coexistence-ldap-example</code>
directory, stop the current running containers with <code>Ctrl + C</code>.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Remove the containers:</p>
                                                            <p><span class="codeblock">docker compose down</span>
                                                            </p>
                                                        </li>
                                                        <li value="3">
                                                            <p>Check out the main branch of
<code>okta-reference-coexistence-ldap-example</code>. This updates the
code in the project to replace the LDAP authentication with OIDC:</p>
                                                            <p><span class="codeblock">git checkout main</span>
                                                            </p>
                                                        </li>
                                                        <li value="4">
                                                            <p>Create an Okta OIDC application and register the application with
Okta:</p>
                                                            <p><span class="codeblock">okta start</span>
                                                            </p>
                                                            <p>The <code>okta start</code> CLI command creates and registers an OIDC
client with Okta. Okta considers this an OIDC application. When this
OIDC application is registered, the <code>ISSUER</code>,
<code>CLIENT_ID</code>, and <code>CLIENT_SECRET</code> variables in the
<code>okta-reference-coexistence-ldap-example/.env</code> file are
updated for authentication with Okta, similar to:</p>
                                                            <p><span class="codeblock">ISSUER=https://dev-133337.okta.com/oauth2/default
CLIENT_ID=someIdValue
CLIENT_SECRET=someSecretValue</span>
                                                            </p>
                                                            <p>The sample web application in the Docker container uses the client ID
and client secret to communicate with the Okta OIDC application to use
Okta as the Identity Provider. See <a href="lab.htm#values-and-variables">Values
and variables</a>.</p>
                                                        </li>
                                                        <li value="5">
                                                            <p>Rebuild the application:</p>
                                                            <p><span class="codeblock">docker compose build</span>
                                                            </p>
                                                        </li>
                                                        <li value="6">
                                                            <p>Start the application:</p>
                                                            <p><span class="codeblock">docker compose up</span>
                                                            </p>
                                                        </li>
                                                        <li value="7">
                                                            <p>Open a private/incognito window and go to the same URL as before:
<code>http://localhost:8080</code>. This time you're redirected to Okta
to sign in. Sign in with the user's email address and password:
<code>user01@example.com</code> and <code>password1</code>. Okta
connects back to the LDAP server for authentication to sign in to the
<code>okta-reference-coexistence-ldap-example</code> application.</p>
                                                            <p>A successful sign in flow displays the following dialog:</p>
                                                            <div class="half border">
                                                                <p>
                                                                    <img src="../../../resources/images/ref-arch/directory-coexistence/ldap-to-okta-signin-response.png" alt="Successful sign-in response" />
                                                                </p>
                                                            </div>
                                                        </li>
                                                    </ol>
                                                    <h3 id="stop-the-application">Stop the application</h3>
                                                    <p>After you complete this tutorial, stop the application and remove the
Docker containers.</p>
                                                    <ol type="1">
                                                        <li value="1">
                                                            <p>In the <code>okta-reference-coexistence-ldap-example</code>
directory, stop the current running containers with <code>Ctrl + C</code>.</p>
                                                        </li>
                                                        <li value="2">
                                                            <p>Remove the containers:</p>
                                                            <p><span class="codeblock">docker compose down</span>
                                                            </p>
                                                        </li>
                                                    </ol>
                                                    <div class="noteOkta">
                                                        <p class="noteContent">The initial version of this application used
simple usernames such as <code>user01</code>. Okta defaults to using
email addresses for usernames, for example
<code>user01@example.com</code>. You can configure Okta to use simple
usernames if needed. See <a href="https://support.okta.com/help/s/article/How-can-I-remove-the-format-restriction-for-Okta-Username-from-using-an-email-address-format?language=en_US">How
can I remove the format restriction for Okta Username from using an
email address format</a>.</p>
                                                    </div>
                                                    <h2 id="migrate-users-from-ldap-to-okta">Migrate users from LDAP to
Okta</h2>
                                                    <p>The LDAP users are already stored in Okta, but the passwords are
managed by the LDAP server. If you want Okta to take over the
authentication part instead of Delegated Authentication to LDAP, disable
delegated Authentication for LDAP by going to <span class="menucascade"><span class="uicontrol">Security</span><span class="uicontrol">Delegated Authentication</span><span class="uicontrol">LDAP</span></span>. This requires you to reset passwords for the all
the LDAP users so that users can set an Okta password to sign in. This
will still retain the user's profile to be sourced by LDAP but
authentication will be handled by Okta. If you want user profiles to be
sourced by Okta, turn off Profile Master setting under
<span class="menucascade"><span class="uicontrol">Directories</span><span class="uicontrol">LDAP</span><span class="uicontrol">Settings</span><span class="uicontrol">Import Settings</span></span> and
<span class="uicontrol">Disable Profile Master</span>. This converts all LDAP user
profiles to be sourced by Okta.</p>
                                                    <div class="noteOkta">
                                                        <p class="noteContent"> This requires resetting the users' passwords.
If you don't want to reset all user passwords, you can use an Okta
password import hook. See <a href="lab-generic-database.htm#account-for-hash-types-okta-doesn-t-support">Account
for hash types Okta doesn't support</a>.</p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- div class="toolbar-main">
            <MadCap:topicToolbarProxy data-mc-skin="/Project/Skins/okta-toolbar-no-expand.flskn" style="mc-topic-toolbar-items: ;" />
                </div -->
                                    <!-- *********************** Footer rows ********************************* -->
                                    <div class="footer2" data-test="footer">
                                        <div>
                                            <p class="copyright" data-test="copyrightNotice">©  <span class="mc-variable okta-variables.Year variable">2023</span> <span class="mc-variable okta-variables.CompanyName variable">Okta, Inc</span>. All Rights Reserved. Various trademarks held by their respective owners.
	</p>
                                        </div>
                                    </div>
                                    <!-- ********************** Scripts ************************************* -->
                                    <script src="../../../resources/scripts/js/ignore-dompurify.js">
                                    </script>
                                    <script src="../../../resources/scripts/js/app.js">
                                    </script>
                                    <script src="../../../resources/scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../../resources/scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../../resources/scripts/coveo-resources/js/coveo.madcapflare.requirejs.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../../resources/scripts/coveo-resources/js/coveo.madcapflare.okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                    <!-- Feedback tab for Qualtrics survey -->
                                    <div id="feedback-tab" data-mc-conditions="Primary.live-site-only"><a id="feedback-link" href="#" onclick="openSurvey();  return false" target="_blank" title="Submit feedback"><div id="feedback-container"><p id="feedback-text" translate="no">Feedback</p></div></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
