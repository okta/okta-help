<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_old" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-searchable="True" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="">
    <head>
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" /><title>Using the Confluence On Premises SAML App</title>
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <script>
		/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-TJ45R6');
		/* ]]> */
		</script>
        <!-- End Google Tag Manager -->
        <!--<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-15777010-10', 'auto');
			ga('send', 'pageview');

		</script>-->
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" />
        <link href="../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/okta-main.css" rel="stylesheet" />
        <style>/*&lt;meta /&gt;*/

.button.expand-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/expand-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.button.collapse-all-button
{
	-pie-background: url('../../../Skins/Default/Stylesheets/Images/collapse-all-non-hover-sm.png') no-repeat center center, linear-gradient(#fff, #fff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/sanitize-html.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div>
                        <nav class="title-bar tab-bar" data-mc-ignore="true">
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <button class="menu-icon" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="../ReleaseNotes/okta-relnotes.htm" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="3" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" placeholder="Search" />
                                                <div class="search-filter-wrapper">
                                                    <div class="search-filter">
                                                        <div class="search-filter-content">
                                                            <ul>
                                                                <li>All Files</li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search">
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <section class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <div class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </div>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TJ45R6" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <div class="LeftRightTopRow">
                                        <div>
                                            <div>
                                            </div>
                                            <div class="toolbar-main is-not-in-mobile">
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie expand-all-button" data-state1-class="expand-all-button" data-state2-class="collapse-all-button" data-state2-title="Collapse all" title="Expand all" data-state1-title="Expand all">
                                                            <img src="../../../Skins/Default/Stylesheets/Images/transparent.gif" alt="expand all" />
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div>
                                            <p />
                                        </div>
                                    </div>
                                    <div class="LeftRightMenu">
                                        <div class="body-main">
                                            <h1>Using the Confluence On Premises SAML App</h1>
                                            <p>In addition to providing the Confluence Cloud Web application through the Okta Integration Network, Okta also supports single sign-on integration between Okta and the Confluence On-Premises <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">SAML<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An acronym for Security Assertion Markup Language, SAML is an XML-based standard for exchanging authentication and authorization data between an identity provider (IdP) and a service provider (SP). The SAML standard addresses issues unique to the single sign-on (SSO) solution, and defines three roles: the end user, the IDP, and the SP.</span></a> <a href="javascript:void(0);" class="MCTextPopup MCTextPopupHotSpot MCTextPopup_Open MCTextPopupHotSpot_ MCTextPopupHotSpot_Popup #text #textPopup">app<span class="MCTextPopupBody popupBody"><span class="MCTextPopupArrow"></span>An abbreviation of application. Essentially, it is a web-based site used to perform any number of specific tasks, and requires authentication from end users by signing in.</span></a>. To configure the integration, you must install Okta's custom Confluence authenticator on your Confluence server. The <a href="../Settings/Version_Histories/Ver_History_Confluence_Authenticator_Toolkit.htm">Okta Confluence Authenticator Version History</a> article lists the Confluence on-premise versions that support recent versions of the JAR. You can access the latest version of the <b>okta-confluence.jar</b> file from the Okta <b>Downloads</b> page. Download the file before you begin the integration.</p>
                                            <p>For more information about Confluence custom authenticators, refer to the page <a href="https://confluence.atlassian.com/kb/single-sign-on-integration-with-the-atlassian-stack-794495126.html">Single Sign-on Integration with JIRA and Confluence</a> on the Atlassian website. For information about configuring provisioning for the app, see <a href="http://saml-doc.okta.com/Provisioning_Docs/Confluence_Provisioning.html">Configuring Provisioning for Confluence (Atlassian)</a>.</p>
                                            <p><b>Note</b>: To ensure that communication between your on-premise Confluence server and Okta is not blocked, you may need to add Okta IP addresses to your <a href="../Security/Firewall_Whitelisting.htm#top">whitelist</a>.</p>
                                            <h2>Add the On-Premise App to Okta</h2>
                                            <p><b>Note:</b>&#160;Steps 5 and 8 below provide links to other documents with additional instructions.</p>
                                            <ol>
                                                <li value="1">
                                                    <p>Download the appropriate version of the <b>okta-confluence.jar</b> file from the Okta <b>Downloads</b> page. For information about which version of the JAR to download for use with your Confluence On-Premises SAML app, see <a href="https://help.okta.com/en/prod/Content/Topics/Settings/Version_Histories/Ver_History_Confluence_Authenticator_Toolkit.htm">Okta Confluence Authenticator Version History</a>. Later you will copy this file to your Confluence server.</p>
                                                </li>
                                                <li value="2">Go to <strong>Applications &gt; Applications</strong>.</li>
                                                <li value="3">Click <strong>Add Application</strong> and search for Confluence On-Premise SAML.</li>
                                                <li value="4">Click <b>Add</b>.
            </li>
                                                <li value="5">Follow the onscreen prompts. Detailed instructions for this part of the installation are provided in <a href="Apps_Apps.htm">Applications</a>.
                <p>When you have completed initial installation, the <b>Home</b> page of the newly-created app appears.</p></li>
                                                <li value="6">On the <b>Assignments</b> tab, assign users to the Confluence On-Premises SAML&#160;app.</li>
                                                <li value="7">Click the <b>Sign On</b> tab.
</li>
                                                <li value="8">In the <b>Settings</b> section, click <b>View Setup Instructions</b> to open the article <b style="font-style: italic;">How to Configure Confluence On-Premise SAML Application</b>.
The procedure is summarized as follows:   
				<ul><li value="1">Create a file <b>okta-config-confluence.xml</b> on the Confluence server.</li><li value="2">Paste the provided configuration into <b>okta-config-confluence.xml</b>.</li><li value="3">Update your <b>[confluence_webdir]/WEB-INF/classes/seraph-config.xml:</b></li><li value="4">Copy <b>okta-confluence.jar</b> to the <b>[confluence_webdir]/WEB-INF/lib</b> directory.</li><li value="5">	Restart your Confluence service.</li></ul></li>
                                            </ol>
                                            <h3>Optional - Filter User Access by IP Address, User Name, or Group Name</h3>
                                            <p class="p1">You can specify whether SAML authentication or service provider authentication is used by IP address, user name, or group name. This option is set in the okta-config-confluence.xml file in the following tags.</p>
                                            <p>The portions highlighted in blue in following code shows the relevant sections of an okta-config-confluence.xml file.</p>
                                            <p>&lt;configuration&gt;<br />			&lt;applications&gt;<br />			&lt;application&gt;<br />			&lt;md:EntityDescriptor ...&gt;....&lt;/md:EntityDescriptor&gt;<br />			&lt;/application&gt;<br />			&lt;/applications&gt;<br /><font color="blue">&lt;!--<br />		The IP range in the &lt;oktaUsers&gt; tag specifies the IP addresses that use the SAML toolkit for authentication. The values in the &lt;ipFrom&gt; and &lt;ipTo&gt; tags specify IP addresses. These tags can contain full IP addresses as shown below or a mask such as 182.0.*.* . The &lt;ipTo&gt; tag is optional. Omit it if the range is completely specified in the &lt;ipFrom&gt; tag. This range has higher priority than the range specified in the &lt;spUsers&gt; tag below.</font></p>
                                            <p><font color="blue">The IP range in the &lt;spUsers&gt; tag specifies the IP addresses that use the native service provider authentication. The values in the &lt;ipFrom&gt; and &lt;ipTo&gt; tags specify IP addresses, and work as described above. This range has low priority than the range specified in the oktaUsers&gt; tag above.</font>
                                            </p>
                                            <p><font color="blue"> </font>
                                            </p>
                                            <p><font color="blue">&lt;allowedAddresses&gt;<br />				&lt;oktaUsers&gt;<br />				&lt;ipFrom&gt;192.168.3.10&lt;/ipFrom&gt;<br />				&lt;ipTo&gt;192.168.3.220&lt;/ipTo&gt;<br />				&lt;/oktaUsers&gt;<br />				&lt;spUsers&gt;<br />				&lt;ipFrom&gt;*.*.*.*&lt;/ipFrom&gt;<br />				&lt;ipTo&gt;*.*.*.*&lt;/ipTo&gt;<br />				/spUsers&gt;<br />		&lt;/allowedAddresses&gt;</font>
                                            </p>
                                            <p><font color="blue"> </font>
                                            </p>
                                            <p><font color="blue">&lt;!--The values in the &lt;username&gt; tags contained in the &lt;spUsers&gt; tag specify usernames to process with the native service provider authentication. Any number of &lt;username&gt;&lt;/username&gt; tags are permitted.<br />		--&gt;</font>
                                            </p>
                                            <p><font color="blue"> </font>
                                            </p>
                                            <p><font color="blue">&lt;spUsers&gt;<br />				&lt;username&gt;john.doe@acme.com&lt;/username&gt;<br />				&lt;username&gt;john.smith@acme.com&lt;/username&gt;<br />				&lt;username&gt;jira.user@acme.com&lt;/username&gt;<br />				&lt;username&gt;confluence.user@acme.com&lt;/username&gt;<br />		&lt;/spUsers&gt;</font>
                                            </p>
                                            <p><font color="blue"> &lt;!--<br />				The values in the &lt;groupname&gt; tags contained in the &lt;spGroups&gt; tag specify group names to process with the native service provider authentication. Any number of &lt;groupname&gt;&lt;/groupname&gt; tags are permitted.<br />		--&gt;</font>
                                            </p>
                                            <p><font color="blue"> </font>
                                            </p>
                                            <p><font color="blue"> </font>
                                            </p>
                                            <p><font color="blue">&lt;spGroups&gt;<br />				&lt;groupname&gt;jira-grp&lt;/groupname&gt;<br />				&lt;groupname&gt;confluence-grp&lt;/groupname&gt;<br />		&lt;/spGroups&gt;</font>
                                            </p>
                                            <p><font color="blue"> </font>
                                            </p>
                                            <p>&lt;/configuration&gt;</p>
                                            <h3>Processing Details</h3>
                                            <p>If there are any duplications in IP addresses or if an IP address is inadvertently excluded, the following four rules determine the processing procedure.</p>
                                            <ul>
                                                <li value="1">If a user is matched in both ranges, the SAML toolkit is used for authentication.</li>
                                                <li value="2">If the &lt;allowedAddresses&gt; tag is not present, the SAML toolkit is used for authentication.</li>
                                                <li value="3">If user is not matched in either range,  the SAML toolkit is used for authentication.</li>
                                                <li value="4">The native Confluence authenticator (the service provider authenticator) is used only if a user is matched in the  &lt;spUsers&gt; range and not in the &lt;oktaUsers&gt; range.</li>
                                            </ul><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                        </div>
                                        <div>
                                            <div data-sticky-container="" id="-5QI9SJxxEuhwM86tkOTMA">
                                                <div class="sticky sticky-menu" style="width:100%" data-sticky="" data-top-anchor="-5QI9SJxxEuhwM86tkOTMA:top" data-bottom-anchor="contentBody:bottom" data-scroll-container=".body-container" data-sticky-on="small" data-scroll-container-on="only screen and (min-width: 1025px)">
                                                    <ul class="nocontent menu _Skins_okta_side_menu mc-component" data-mc-is-context-sensitive="True" data-mc-linked-toc="Data/BrowseSequences/BrowseSequences__secondary.js" data-mc-side-menu="True" data-mc-max-depth="1" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="False" data-mc-include-parent="True" data-mc-toc="True">
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="Footer">
                                        <div>
                                            <p class="copyright">Â© Copyright <span class="okta-variablesYear">2019</span> <span class="okta-variablesCompanyName">Okta, Inc</span></p>
                                        </div>
                                    </div>
                                    <script src="../../Resources/Scripts/js/app.js">
                                    </script>
                                    <!-- <script src="../../Resources/Scripts/js/vendor/jquery.js"></script> -->
                                    <script src="../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <script type="text/javascript" src="../../Resources/Scripts/back-to-top.js">
                                    </script>
                                    <script type="text/javascript" src="../../Resources/Scripts/get-feedback.js">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </section><a data-close="true"></a>
                </div>
            </div>
            <script>/* <![CDATA[ */$(document).foundation();/* ]]> */</script>
        </div>
    </body>
</html>