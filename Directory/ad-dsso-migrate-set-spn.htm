<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:onlyLocalStylesheets="False"
      MadCap:searchable="True"
      MadCap:conditions="MultiProdPublish.Classic+OIE"
      MadCap:fileTags="Tags/okta-authors.Patrick Calnan">
   <head>
      <title>[%=Heading.Level1%] | Okta</title>
      <link href="" rel="stylesheet" type="text/css"/>
      <meta name="description"
            content="Set the Service Principal Name (SPN) to allow Okta negotiate Kerberos authentication for agentless Desktop Single Sign-on (DSSO)."/>
   </head>
   <body>
      <h1>Set the service principal name</h1>
      <p>Set the Service Principal Name (SPN) to allow Okta negotiate Kerberos authentication for agentless Desktop Single Sign-on (DSSO). Domain administrator privileges are required to set the service principal name (SPN). </p>
      <ol>
         <li>Open a command prompt as an administrator in your Active Directory (AD) environment and run this command to add an SPN:
                <p>
               <code>setspn -S HTTP/<span class="term">&lt;<span class="term">myorg</span>&gt;.<span class="uicontrol">kerberos</span>.&lt;okta|oktapreview|okta-emea|okta-gov.com&gt;.com</span> &lt;ServiceAccountName&gt;</code>
            </p>
            <p>HTTP/<span class="term">&lt;<span class="term">myorg</span>&gt;.kerberos.okta.com</span> is the SPN. &lt;ServiceAccountName&gt; is the value you used when configuring Agentless DSSO and &lt;oktaorg&gt; is your <MadCap:variable name="okta-variables.ProductName"/> org (either oktapreview, okta-emea or okta). For example, <code>setspn -S HTTP/<span class="term">atko.kerberos.oktapreview.com</span> atkospnadmin</code>.</p>
            <p>This command does not create a new AD user account and SPN. Instead, it adds a new SPN to the existing AD user account. <br/>A child domain can use an SPN that resides in a parent domain only if the parent domain is also configured as a Kerberos Realm in Okta<br/>SPNs are unique across a forest so you only need to do this once in each forest. If you have multiple forests, repeat step 1 for each forest. This command is applicable to all orgs, including those that are using a custom URL.</p>
         </li>
         <li>Add https://<span class="term">&lt;<span class="term">myorg</span>&gt;.<span class="term">kerberos</span>.&lt;oktaorg&gt;.com</span> to the Intranet Site list in your Internet Settings for all the devices that you want using <MadCap:variable name="okta-feature-names.Agentless DSSO"/>.</li>
         <li>Open your <MadCap:variable name="okta-variables.ProductName"/> Admin Console, navigate to <span class="menucascade">
               <span class="uicontrol">Security</span>
               <span class="uicontrol">Delegated Authentication</span>
               <span class="uicontrol">Agentless DSSO</span>
               <span class="uicontrol">Edit</span>
            </span>
            <ol style="list-style-type: lower-alpha;">
               <li> Under the AD instances, click <span class="uicontrol">Edit</span>.</li>
               <li>If the service account username is in the old format (for example:  HTTP/<span class="term">&lt;<span class="term">myorg</span>&gt;.&lt;oktaorg&gt;.com</span>),  change it to the UPN of the service account for which the SPN was set.</li>
               <li>Select <span class="uicontrol">Validate service account credential on save</span>.</li>
               <li>Click <span class="uicontrol">Save</span>.</li>
            </ol>
            <p> This initiates the creation of a new DNS record for your org.</p>
         </li>
         <li>Use command line tools such as dig or nslookup to make sure your new Kerberos URL can be reached. For example:
            <p>
               <code>$ dig &lt;yourOrg&gt;.kerberos.&lt;oktaorg&gt;.com</code>
            </p>
            <p>
               <code>$ nslookup &lt;yourOrg&gt;.kerberos.&lt;oktaorg&gt;.com</code>
            </p>
            <p>To determine if the command was successful, refer to your Linux or Windows command reference documentation for explanations of the output messages. If the Kerberos URL can be reached, complete the remaining procedures. If you do not see  output indicating success, run the command again in five minutes or contact <MadCap:variable name="okta-variables.ProductName"/> support for assistance.</p>
         </li>
      </ol>
      <h2>Next steps</h2>
      <p>
         <MadCap:xref href="ad-dsso-migrate-configure-browser.htm">Configure browsers for single sign-on on Windows</MadCap:xref>
      </p>
   </body>
</html>
