<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:fileTags="Tags/okta-topic-status.In Progress,Tags/okta-authors.Patrick Calnan"
      MadCap:onlyLocalStylesheets="False"
      MadCap:searchable="True"
      MadCap:conditions="MultiProdPublish.Classic+OIE">
   <head>
      <title>[%=Heading.Level1%] | Okta</title>
      <link href="" rel="stylesheet" type="text/css"/>
      <meta name="description"
            content="Use the Okta AD Groups FAQ to learn how Okta handles Distribution Groups and Universal Security Groups during AD imports."/>
   </head>
   <body>
      <h1>
         <a name="FAQs"/>Active Directory integration FAQ</h1>
      <br/>
      <h3>How does Okta handle Universal Security Groups (USGs)?
                </h3>
      <p>For more about Universal Security Groups, click <a href="https://technet.microsoft.com/en-us/library/cc960640.aspx"
            target="_blank">here</a>.</p>
      <h4>Variables</h4>
      <ul>
         <li>Whether users and USGs reside in the <span class="uicontrol">same</span> or <span class="uicontrol">different</span> AD domains.</li>
         <li>If <span class="uicontrol">different</span> domains, whether both domains exist in Okta and are connected by a trust relationship.</li>
         <li>Whether users come in to Okta through sign-in (JIT) or import.</li>
      </ul>
      <h4>Assumptions</h4>
      <ul>
         <li>
            <span class="uicontrol">JIT Provisioning</span> and <span class="uicontrol">USG Support</span> options are selected in <span class="uicontrol">Import and Account Settings</span>.</li>
         <li>If the option <span class="uicontrol">Schedule import</span> is selected, the option <span class="uicontrol">Do not import new Users</span> is not selected.</li>
      </ul>
      <p>Okta does not support Domain Local Groups containing members from multiple domains. Universal Security Groups with cross-domain membership are supported if there is a two-way trust established between the domains. Universal Security Groups do not support cross-forest membership. </p>
      <h3>Sign-in (JIT) scenarios</h3>
      <h4>What happens when a user who is a member of a USG that does not already exist in Okta signs in to Okta?</h4>
      <ul>
         <li>If the user and the USG belong to the <span class="uicontrol">same</span> domain but the USG does not already exist in Okta, Okta creates or updates the user's profile in Okta, brings in the USG, and syncs the user's membership to the USG.</li>
         <li>If the user and the USG belong to <span class="uicontrol">different</span> domains and both domains exist in Okta but the USG does not already exist in Okta, Okta creates or updates the user's profile in Okta but does not bring the USG in to Okta.</li>
      </ul>
      <h4>What happens when a user who is a member of a USG that already exists in Okta signs in to Okta?</h4>
      <ul>
         <li>If the user and the USG belong to the <span class="uicontrol">same</span> domain and the USG exists in Okta, Okta creates or updates the user's profile in Okta and syncs the user's membership to the USG.</li>
         <li>If the user and the USG belong to <span class="uicontrol">different</span> domains and the USG exists in Okta, Okta syncs the user's membership to the USG at sign-in only if the two domains are connected by a trust relationship. If the domains have no trust relationship, Okta does not recognize the user's membership in the USG.</li>
      </ul>
      <h3>Import scenarios</h3>
      <h4>What happens during an import of groups and users?</h4>
      <ul>
         <li>If the users and the USG are members of the <span class="uicontrol">same</span> domain, Okta creates or updates the users' profile in Okta, creates the USG if it doesn't already exist in Okta, and syncs memberships to the USG only for users in the domain being imported. Nothing is imported from other domains. During import, Okta does not recognize memberships to USGs in other domains.</li>
         <li>If the users in the domain being imported are members of a USG that resides in a <span class="uicontrol">different</span> domain, Okta only imports the users and ignores their membership in the USG. If the domain containing the USG is imported later, Okta syncs memberships the next time group members sign-in to Okta.</li>
      </ul>
      <h3>Example: USG across 2-Domains</h3>
      <p>Given a USG that resides in Domain B and contains users from Domains A and B:</p>
      <p>
         <img src="../../Resources/Images/USG_2domains.png"/>
      </p>
      <h4>If Domain A is imported in to Okta, which members of the USG are imported in to Okta?</h4>
      <p>Only users from Domain A are imported in to Okta and their membership in the USG is ignored until Domain B is later imported. </p>
      <h4>If Domain A already exists in Okta, will importing Domain B bring the USG in to Okta and sync Group 2 memberships to the USG?</h4>
      <p>Yes.</p>
      <h3>Example: USG across 3-Domains</h3>
      <p>Given a USG in a 3-domain forest that resides in Domain A and contains users from Domains A, B, and C.</p>
      <p>When <span class="uicontrol">Domain A</span> users and groups are imported into Okta, the USG is imported and Domain A USG user memberships are synced.</p>
      <p>
         <img src="../../Resources/Images/USG_3 to 1 domain.png"
              style="width: 580px;height: 543px;"/>
      </p>
      <p>If <span class="uicontrol">Domains B</span> and <span class="uicontrol">C</span> users and groups are imported into Okta, the USG memberships from those domains are not synced until users from those domains sign in to Okta for the first time (as indicated by the dotted line in the diagram).</p>
      <p>
         <img src="../../Resources/Images/DistributionGroups_ADtoOkta.png"
              style="width: 567px;height: 522px;"/>
      </p>
      <br/>
      <h3>When are Distribution Groups brought in to Okta?
                </h3>
      <p>Distribution Groups are brought into Okta during incremental and full imports and not during Just-in-Time (JIT) provisioning. </p>
      <p>When users sign in and the JIT provisioning flow is enabled, <MadCap:variable name="okta-variables.ProductName"/> imports security group memberships but not distribution groups. JIT provisioning doesn't synchronize distribution group membership for user accounts. Users don't inherit membership in any parent security group when they are members of a child distribution group. To regularly update distribution group memberships from AD to <MadCap:variable name="okta-variables.ProductName"/>, schedule an import. </p>
      <br/>
      <h3>
         <a id="DGsSynced" name="DGsSynced"/>When are Distribution Group memberships synced in Okta?
                </h3>
      <p>Only during incremental and full imports, and only if the users and groups being imported belong to the same domain.</p>
      <p>When users sign in and the Just-in-Time (JIT) provisioning flow is enabled, <MadCap:variable name="okta-variables.ProductName"/> imports security group memberships but not distribution groups. JIT provisioning doesn't synchronize distribution group membership for user accounts. Users don't inherit membership in any parent security group when they are members of a child distribution group. To regularly update distribution group memberships from AD to <MadCap:variable name="okta-variables.ProductName"/>, schedule an import. </p>
      <p>When the <span class="uicontrol">Skip users during import</span> check box  is selected as a provisioning option on the <span class="uicontrol">To Okta</span> page,  group memberships are not  imported for Distribution or Universal Security Groups. See <MadCap:xref href="ad-agent-configure-import.htm">Configure Active Directory  import and account settings</MadCap:xref>.</p>
      <br/>
      <h3>
         <a id="DGs_USGs" name="DSGs_USGs"/>Does Okta treat Distribution Groups (DGs) and Universal Security Groups (USGs) the same or differently?
        </h3>
      <p>Okta treats DGs and USGs the <span class="uicontrol">same</span> in this respect:</p>
      <p>During imports, Okta does not sync group memberships to DGs or USGs that reside in a different domain than the domain being imported.</p>
      <p>Okta treats DGs and USGs <span class="uicontrol">differently</span> in this respect:</p>
      <ul>
         <li>If a user and a <span class="uicontrol">USG</span> of which it is a member belong to the same domain, Okta syncs the user to the USG during Just-in-Time (JIT) provisioning and imports</li>
         <li>If a user and a <span class="uicontrol">DG</span> of which it is a member belong to the same domain, Okta syncs the user to the DG only during imports, not during JIT.</li>
      </ul>
      <p>When users sign in and the JIT provisioning flow is enabled, Okta imports security group memberships but not distribution groups. JIT provisioning doesn't synchronize distribution group membership for user accounts. Users don't inherit membership in any parent security group when they are members of a child distribution group. To regularly update distribution group memberships from AD to <MadCap:variable name="okta-variables.ProductName"/>, schedule an import. </p>
      <p>When the <span class="uicontrol">Skip users during import</span> check box  is selected as a provisioning option on the <span class="uicontrol">To Okta</span> page,  group memberships are not  imported for Distribution or Universal Security Groups. See <MadCap:xref href="ad-agent-configure-import.htm">Configure Active Directory  import and account settings</MadCap:xref>.</p>
      <br/>
      <h3>How does Okta handle users and groups that are moved to an out-of-scope OU?
        </h3>
      <p>Note: The term <span class="uicontrol">out-of-scope</span> Organizational Unit (OU) refers to an OU that does not appear in or is not selected in the relevant OU selector. (Examples of the later type of out-of-scope OU are highlighted in yellow in the figure below.)</p>
      <p>Some organizations administer an employee off-boarding process that involves moving users or groups to an out-of-scope OU. As detailed below, Okta never imports users and groups in out-of-scope OUs, and denies sign-in to all such users.</p>
      <p>
         <img src="../../Resources/Images/OutOfScope OUs.png"/>
      </p>
      <h3>Sign-in (JIT) scenarios</h3>
      <p>Okta denies sign-in to all users in out-of-scope OUs, regardless of their enablement status in Active Directory.</p>
      <ul>
         <li>When a user in an <span class="uicontrol">out-of-scope OU</span> who is enabled in AD tries to sign in to Okta, Okta detects the user's AD status, preserves them as active in Okta, but denies their sign-in attempt.</li>
         <li>When a user in an <span class="uicontrol">out-of-scope OU </span>who is disabled in AD tries to sign in Okta, Okta detects their AD status, deactivates them in Okta, and denies their sign-in attempt.</li>
      </ul>
      <h3>Import scenarios</h3>
      <p>Okta performs incremental and full imports.</p>
      <ul>
         <li>During an incremental import, Okta doesn't detect users and groups in <span class="uicontrol">out-of-scope OUs</span>, so none of these users or groups are imported.</li>
         <li>
            <p>Accounts  imported from an in-scope OU during a full or incremental import and then later relocated to an out-of-scope OU are not deactivated during a subsequent incremental import.</p>
         </li>
         <li>During a full import, Okta detects users in <span class="uicontrol">out-of-scope OUs</span> as missing, deactivates them (regardless of their enablement status in AD), and denies their next sign-in attempt.</li>
         <li>
            <p>AD groups in Okta that have been deleted in AD will be removed from Okta only during full imports.</p>
         </li>
      </ul>
      <br/>
      <h3>How does JIT provisioning treat nested groups outside of OU and object filter scopes?</h3>
      <p>Membership inconsistencies can occur between “regular” imports and JIT provisioning. These membership anomalies may occur when using nested groups.
</p>
      <p>During regular imports, Okta does not detect a child group that is outside the scope of an AD OU or LDAP object filter. If a parent group is within an OU/object filter scope but its child groups are not, Okta incorrectly resolves the parent group membership during import.
 </p>
      <p>
JIT provisioning will correctly resolve these memberships to the parent group because its function detects only "flat" memberships.</p>
      <h3>What permissions does the Okta AD Agent Management Utility require?</h3>
      <p>The default permission is domain administrator. See <MadCap:xref href="ad-agent-get-started.htm">Get started with Active Directory integration</MadCap:xref>.</p>
      <h3>Can I create the Okta service account myself?</h3>
      <p>Yes, you can create or use an existing AD service account for the agent install if you do not want the install process to create one for you.</p>
      <h3>Can I move the Okta service account to a different OU?</h3>
      <p>Yes. You can move the account after installing the agent. For example, to an OU reserved just for service accounts.</p>
      <h3>How do I change the Okta service account password?</h3>
      <p>It is best practice to intermittently change the password for the Okta Service Account that was used to install the <MadCap:variable name="okta-feature-names.AD agent short"/>. </p>
      <p>To change the password:</p>
      <ol>
         <li>In Active Directory, use the <span class="uicontrol">Active Directory Users and Computers</span> tool , locate the <span class="uicontrol">OktaService</span> account. Right-click and reset the password in AD. You will require domain admin, or sufficiently elevated, privileges to perform this action.</li>
         <li>On the server on which the agent is installed, on the <span class="uicontrol">Services</span> console:<ol style="list-style-type: lower-alpha;">
               <li> Locate the <MadCap:variable name="okta-feature-names.AD agent short" style="font-weight: bold;"/> service and stop it.</li>
               <li>Right-click the service and select the <span class="menucascade">
                     <span class="uicontrol">Properties</span>
                     <span class="uicontrol">Log on</span>
                  </span> tab.</li>
               <li>Change the password to match the one you just set in AD.</li>
               <li>Start the service.</li>
            </ol>
         </li>
      </ol>
      <p>If you have also installed the Okta IWA SSO agent and used the same Okta Service account that was used to install the <MadCap:variable name="okta-feature-names.AD agent short"/>, then you must also change the Okta Service account password in the <span class="menucascade">
            <span class="uicontrol">IIS Server Manager dashboard</span>
            <span class="uicontrol">Tools</span>
            <span class="uicontrol">Internet Information Services (IIS) Manager</span>
         </span>. The OktaIWA service is installed under the Application Pools menu. Under <span class="uicontrol">Advanced Settings</span> you can change the Okta Service password to match the new password. Due to caching, the IWA service may not stop immediately. When the cache does reset, IWA will stop working if the OktaService password has not been updated here to match the password you reset in the Active Directory Users and Computers tool and the Services console.</p>
      <br/>
      <h3>How do I change the Okta admin account password?</h3>
      <p>There are two options for resetting an Okta admin account password:</p>
      <ul>
         <li>Sign in using that Admin user ID and password. Navigate to the end user account <span class="menucascade">
               <span class="uicontrol">Settings</span>
               <span class="uicontrol">Change Password</span>
            </span> section.</li>
         <li>While signed in as a super admin, navigate to <span class="menucascade">
               <span class="uicontrol">Admin</span>
               <span class="uicontrol">Directory</span>
               <span class="uicontrol">People</span>
               <span class="uicontrol">(admin account name)</span>
               <span class="uicontrol">Reset Password</span>
            </span>. Then select whether to send a Reset Password Link or set a Temporary password.</li>
      </ul>
      <br/>
      <h3>Do I have to open my firewall for the agent?</h3>
      <p>The <MadCap:variable name="okta-feature-names.AD agent short"/> is outbound only. You do not have to open your firewall for any inbound agent traffic.</p>
      <br/>
      <h3>Can I control which agents receive traffic?</h3>
      <p>No. All active agents will receive traffic. The only way to control whether an agent receives traffic or not is to turn an agent off. It is not possible to tailor agent traffic so that it only goes to a backup data center in the event of a failure.</p>
      <br/>
      <h3>Can I schedule when imports occur?</h3>
      <p>You cannot schedule a specific time of day for imports. You can schedule the frequency of imports. To schedule import frequency, go to <span class="menucascade">
            <span class="uicontrol">Directory</span>
            <span class="uicontrol">Directory Integrations</span>
         </span> and select the AD integration. On the <span class="uicontrol">Settings</span> tab, scroll to <span class="uicontrol">Import and Provisioning</span> and the <span class="uicontrol">Schedule Import</span> option to select the import interval. To perform a manual import, select the <span class="uicontrol">Import</span> tab and click <span class="uicontrol">Import Now</span>.</p>
      <br/>
      <h3>Is there a way to automate the agent install?</h3>
      <p>Currently there is no means for automating the agent installation.</p>
      <br/>
      <h3>How do I turn on more verbose debugging for the agent?</h3>
      <p>Logs can be an invaluable resource when troubleshooting an issue, and Okta Support will often request them while working on a case. You can enable verbose logging for troubleshooting purposes.</p>
      <p>To avoid continually generating numerous large files, <MadCap:variable name="okta-variables.ProductName"/> recommends disabling verbose logging when you finish troubleshooting.</p>
      <ol>
         <li>
                        On the system running the affected AD Agent, navigate to the AD Agent install directory. By default, this is <span class="filepath">C:\Program Files (x86)\Okta\Okta AD Agent</span>.
                    </li>
         <li>
                        ​Open the <span class="filepath">OktaAgentService.exe.config</span> file with a text editor.
                        <p>Change the value <span class="code">&lt;add key="VerboseLogging" value="False" /&gt;</span> to <span class="code">&lt;add key="VerboseLogging" value="True" /&gt;</span>.</p>
         </li>
         <li>
                        Save your changes to the file.
                    </li>
         <li>
                        Restart the AD Agent Service.
                    </li>
      </ol>
      <br/>
      <h3>What level of performance tuning can I do on the agent?</h3>
      <MadCap:snippetBlock src="Snippets/ad-agent-threads.flsnp"/>
      <br/>
      <h3>Can <MadCap:variable name="okta-variables.ProductName"/> integrate with AWS Managed Active Directory?</h3>
      <p>Yes, <MadCap:variable name="okta-variables.ProductName"/> can integrate with AWS Managed Active Directory with the following caveats:</p>
      <ul>
         <li>
            <p>AD Agent cannot create a new service account</p>
         </li>
         <li>
            <p>AD Agent can use an already existing account for a service account</p>
         </li>
         <li>
            <p>If you do not want to use the default AWS Managed AD admin account, we recommend creating a service account with granular permissions. See <MadCap:xref href="ad-agent-about-service-account.htm">About [%=okta-variables.ProductName%] service account permissions</MadCap:xref>.</p>
         </li>
         <li>
            <p>Pushing net new groups works as intended, but pushing AWS managed groups is not supported at this time.</p>
         </li>
      </ul>
   </body>
</html>
