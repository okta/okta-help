<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:conditions="MultiProdPublish.Classic+OIE"
      MadCap:fileTags="Tags/okta-authors.Patrick Calnan">
   <head>
      <title>[%=Heading.Level1%] | Okta</title>
      <meta name="description"
            content="Troubleshoot common password synchronization issues."/>
   </head>
   <body>
      <h1>
         <a name="Troubleshooting"/>Troubleshoot password synchronization</h1>
      <p>Use the information provided here to help resolve password synchronization issues. </p>
      <p>Here are some suggestions for resolving password synchronization issues:</p>
      <ul>
         <li>Review the <MadCap:variable name="okta-variables.ProductName"/> System Log to determine if the password synchronization event resulted in a password synchronization attempt to push the password to applications or to Active Directory (AD).</li>
         <li>Sign on to password synchronization target application manually to determine which password is working.</li>
         <li>With <MadCap:variable name="okta-variables.ProductName"/> to AD synchronization issues, confirm that the <MadCap:variable name="okta-feature-names.AD agent short"/> service account permissions are correct and there are no errors in the Agent.log file.</li>
         <li>Review the <MadCap:variable name="okta-feature-names.AD agent short"/> and Password Sync Agent (PSA) logs for synchronization events.</li>
         <li>Failed password synchronization events appear in the task list on the <span class="uicontrol">Tasks</span> page.</li>
      </ul>
      <h4>The <MadCap:variable name="okta-feature-names.Okta AD Password Sync Agent"/> is installed on all domain controllers, user's AD password has changed, but user is not able to sign in to apps using desktop SSO</h4>
      <p>The problem may be that the <span class="uicontrol">
            <MadCap:variable name="okta-variables.ProductName"/> username format</span> for your org is not set to <span class="uicontrol">User Principal Name (UPN)</span>  or <span class="uicontrol">sAMAccountName</span>. The <span class="uicontrol">
            <MadCap:variable name="okta-variables.ProductName"/> username format</span> must be set to <span class="uicontrol">User Principal Name (UPN)</span> or  <span class="uicontrol">sAMAccountName</span> in order for the AD Password Sync Agent to work. To check the <span class="uicontrol">
            <MadCap:variable name="okta-variables.ProductName"/> username format</span> setting:</p>
      <ol>
         <li>In the <MadCap:variable name="okta-feature-names.Administrator dashboard"/>, go to <span class="menucascade">
               <span class="uicontrol">Directory</span>
               <span class="uicontrol">Directory Integrations</span>
            </span>.</li>
         <li>Click <span class="uicontrol">Active Directory</span> and then the <span class="uicontrol">Provisioning</span> tab.</li>
         <li>In the <span class="uicontrol">Settings</span> list, click <span class="uicontrol">To <MadCap:variable name="okta-variables.ProductName"/>
            </span>.</li>
         <li>In the <span class="uicontrol">General</span> area, make sure that <span class="uicontrol">User Principal Name (UPN)</span> or <span class="uicontrol">sAMAccountName</span> is selected for <span class="uicontrol">
               <MadCap:variable name="okta-variables.ProductName"/> username format</span>.</li>
      </ol>
      <h4>Filter was loaded successfully, but is not enabled</h4>
      <p>If you launch the AD Password Sync agent and a message displays stating that the agent is not enabled, you must enter your <MadCap:variable name="okta-variables.ProductName"/> URL (for example, <span class="userinput">https://mycompany.okta.com</span>) and click <span class="uicontrol">Verify URL</span>. Use the <span class="userinput">https://</span> prefix in your entry.</p>
      <h4>
         <a id="SSL_error" name="SSL_error"/>Could not establish trust relationship</h4>
      <p>If you launch the AD Password Sync agent and see the message <span class="uicontrol">The underlying connection was closed. Could not establish trust relationship for the SSL/TLS secure channel</span>, then you installed AD Password Sync agent <span class="uicontrol">version 1.3.0</span> or later and your environment is one in which the agent's support for SSL certificate pinning prevents communication with the <MadCap:variable name="okta-variables.ProductName"/> server. This is most likely to occur in environments that rely on <span class="uicontrol">SSL proxies</span>. To allow installation to complete in this case, <MadCap:variable name="okta-variables.ProductName"/> recommends that you <span class="uicontrol">bypass SSL proxy processing</span> by adding the domain okta.com to an allowlist.</p>
      <p>Alternatively, you can choose to disable SSL certificate pinning as described below, but be aware that doing so disables a security enhancement provided by the agent.</p>
      <p>To disable support for SSL pinning, edit the Windows registry as follows:</p>
      <ol>
         <li>Click <span class="uicontrol">Search</span>, enter <span class="userinput">regedit</span> in the search box, and press <span class="uicontrol">Enter</span>.</li>
         <li>If the message <span class="uicontrol">Do you want to allow this app to make changes your device?</span> appears, click <span class="uicontrol">Yes</span>.</li>
         <li>In the <span class="uicontrol">Registry Editor</span>, navigate to
            <span class="menucascade">
               <span class="uicontrol">HKEY_LOCAL_MACHINE</span>
               <span class="uicontrol">SOFTWARE</span>
               <span class="uicontrol">
                  <MadCap:variable name="okta-variables.ProductName"/>
               </span>
               <span class="uicontrol">AD Password Sync</span>
            </span>.</li>
         <li>Double-click the setting <span class="uicontrol">Enable certificate pinning</span> and change the value to <span class="uicontrol">0</span>.</li>
         <li>Click <span class="uicontrol">OK</span> to save your change.</li>
      </ol>
      <p style="text-align: left;margin-left: 40px;">For more information about SSL certificate pinning, see <a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning"
            target="_blank">Open Web Application Security Project</a>.</p>
   </body>
</html>
