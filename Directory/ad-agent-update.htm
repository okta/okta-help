<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:onlyLocalStylesheets="False"
      MadCap:searchable="True"
      MadCap:fileTags="Tags/okta-authors.Patrick Calnan"
      MadCap:conditions="MultiProdPublish.Classic+OIE">
   <head>
      <title>[%=Heading.Level1%] | Okta</title>
      <link href="" rel="stylesheet" type="text/css"/>
      <meta name="description"
            content="Keep your Okta Active Directory (AD) agent updated to the latest version. Updating is as simple as running the agent installer."/>
   </head>
   <body>
      <h1>Update the <MadCap:variable name="okta-variables.ProductName"/> Active Directory agent</h1>
      <p>You can update an <MadCap:variable name="okta-feature-names.AD agent short"/> automatically. Refer to <MadCap:xref href="agent-auto-update-main.htm">Automatically update [%=okta-variables.ProductName%] agents</MadCap:xref>.</p>
      <p>If you need to update an <MadCap:variable name="okta-feature-names.AD agent short"/>, you don't need to uninstall  it. The agent installer automatically updates existing Okta AD Agents. Alternatively, you can uninstall and then reinstall the <MadCap:variable name="okta-feature-names.AD agent short"/> to make sure that you have the most current features and functionality and are getting optimum performance.</p>
      <p>If you have installed multiple Okta AD Agents, make sure that they're all the same version. Running different versions within a domain can cause all agents in that domain to function at the level of the oldest agent. This doesn't affect other domains. </p>
      <p>When you uninstall and reinstall your <MadCap:variable name="okta-feature-names.AD agent short"/>, you can remove the old <MadCap:variable name="okta-variables.ProductName"/> API token. If you're performing an upgrade, you aren't required to remove the old token. To remove the API token, you must delete the <MadCap:variable name="okta-feature-names.AD agent short"/> folder and then deactivate and delete your old agent.</p>
      <p class="note">To continue using an <MadCap:variable name="okta-feature-names.AD agent short"/> and avoid downtime, you must have a minimum of two agents running before you uninstall one of them. Refer to <MadCap:xref href="ad-agent-install-multiple.htm">Install multiple [%=okta-variables.ProductName%] Active Directory agents</MadCap:xref>.</p>
      <p>
         <MadCap:variable name="okta-variables.ProductName"/> recommends that you update one or two agents  at a time and avoid taking all agents down at the same time.  You should upgrade your <MadCap:variable name="okta-variables.ProductName"/> preview environment first and confirm that everything is working correctly before you upgrade your production environment.</p>
      <h2>
         <a name="Uninstall"/>Uninstall an <MadCap:variable name="okta-feature-names.AD agent short"/>
      </h2>
      <a name="Uninstallagent"/>
      <ol>
         <li>In Windows, select <span class="menucascade">
               <span class="uicontrol">Start</span>
               <span class="uicontrol">Control Panel</span>
               <span class="uicontrol">Programs</span>
               <span class="uicontrol">Programs and Features</span>
            </span>.</li>
         <li>Select the <span class="uicontrol">Okta AD Agent</span>, and then select <span class="uicontrol">Uninstall</span>.</li>
         <li>To remove the agent configuration data from the hard drive on the agent server, go to <span class="uicontrol">C:\Program Files (x86)\Okta</span> and delete the <span class="uicontrol">Okta AD Agent</span> folder. Deleting this folder removes the agent configuration data and the API token. The API token for the server remains valid in <MadCap:variable name="okta-variables.ProductName"/>, so it's important to remove the configuration data. Deleting this folder also removes all log records for the agent, which are stored in <span class="filepath">C:\Program Files (x86)\Okta\Okta AD Agent\logs</span>. If you need to access log records, be sure to move these files to another location.</li>
         <li>To revoke the API token of an uninstalled agent:</li>
         <ol style="list-style-type: lower-alpha;">
            <li> On the <MadCap:variable name="okta-variables.ProductName"/> Admin Console, click <span class="menucascade">
                  <span class="uicontrol">Directory </span>
                  <span class="uicontrol">Directory Integrations</span>
               </span>.</li>
            <li>Click <span class="uicontrol">Active Directory</span> and select the <span class="uicontrol">Agents</span> tab. </li>
            <li>Under <span class="uicontrol">Agent Monitors</span>, click <span class="uicontrol">Deactivate agent</span> twice.</li>
            <li>Click <span class="uicontrol">Delete agent</span> twice.</li>
         </ol>
      </ol>
      <h2>Reinstall an <MadCap:variable name="okta-feature-names.AD agent short"/>
      </h2>
      <p>Installing the <MadCap:variable name="okta-feature-names.AD agent short"/> doesn't overwrite the configuration data in the <span class="uicontrol">Okta AD Agent</span> folder. To reinstall and create a new API token, delete the <MadCap:variable name="okta-variables.ProductName"/> AD Agent folder  before reinstalling the <MadCap:variable name="okta-feature-names.AD agent short"/>.</p>
      <ol>
         <li>Install the <MadCap:variable name="okta-feature-names.AD agent short"/>. Refer to <MadCap:xref href="ad-agent-new-integration.htm">Install  the [%=okta-variables.ProductName%] Active Directory agent</MadCap:xref>.</li>
         <li>Select <span class="menucascade">
               <span class="uicontrol">Directory</span>
               <span class="uicontrol">Directory Integrations</span>
            </span>.</li>
         <li>Click <span class="uicontrol">Active Directory</span> and the <span class="uicontrol">Agents</span> tab.</li>
         <li>Confirm that your reinstalled <MadCap:variable name="okta-feature-names.AD agent short"/> appears in the Agent Monitors section and it's connected to <MadCap:variable name="okta-variables.ProductName"/>. A minimum of one <MadCap:variable name="okta-feature-names.AD agent short"/> should be online.</li>
         <li>Optional. To revoke the <MadCap:variable name="okta-variables.ProductName"/> API token of the old <MadCap:variable name="okta-feature-names.AD agent short"/>:<ol style="list-style-type: lower-alpha;">
               <li>Under <span class="uicontrol">Agent Monitors</span>, click <span class="uicontrol">Deactivate agent</span> for the old <MadCap:variable name="okta-feature-names.AD agent short"/> and then click <span class="uicontrol">Deactivate Agent</span>. Deactivating the agent revokes its API token.</li>
               <li>Click <span class="uicontrol">Delete agent</span> twice.</li>
            </ol>
         </li>
      </ol>
   </body>
</html>
