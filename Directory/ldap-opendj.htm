<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:onlyLocalStylesheets="False"
      MadCap:searchable="True"
      MadCap:conditions="MultiProdPublish.Classic+OIE"
      MadCap:fileTags="Tags/okta-authors.Patrick Calnan">
   <head>
      <title>[%=Heading.Level1%] | Okta</title>
      <link href="" rel="stylesheet" type="text/css"/>
      <meta name="description"
            content="Provides reference information specific to OpenDJ Lightweight Directory Access Protocol (LDAP) integrations."/>
   </head>
   <body>
      <h1>OpenDJ LDAP integration reference</h1>
      <p>This topic provides reference information specific to OpenDJ Lightweight Directory Access Protocol (LDAP) integrations. When you're installing the <MadCap:variable name="okta-feature-names.LDAP agent short"/>, you'll need this information to integrate your OpenDJ directory with <MadCap:variable name="okta-variables.ProductName"/>. See <MadCap:xref href="ldap-agent-install-configure.htm">Install the [%=okta-feature-names.LDAP agent short%]</MadCap:xref>. </p>
      <h2 MadCap:conditions="MultiProdPublish.Classic">Recommended version</h2>
      <p MadCap:conditions="MultiProdPublish.Classic">OpenDJ Community Edition 2.6.4</p>
      <h2>Known issues</h2>
      <ul>
         <li>
            <p>Users requesting a self password reset and who are required to change their password after it is reset by an admin, must provide their new password twice to access the Okta End-User Dashboard.</p>
         </li>
         <li>
            <p>When the provisioning settings indicate <span class="uicontrol">Do nothing</span> when users are deactivated, users remain active in <MadCap:variable name="okta-variables.ProductName"/>. When a single source provides user profile attributes, deactivated users are disconnected from the source and <MadCap:variable name="okta-variables.ProductName"/> becomes the source for user profile attributes</p>
         </li>
      </ul>
      <h2>Integration configuration</h2>
      <p>During the initial agent install and configuration  documented in <MadCap:xref href="ldap-agent-install-configure.htm">Install the [%=okta-feature-names.LDAP agent short%]</MadCap:xref>, these are the attributes for OpenDJ integrations:</p>
      <ul>
         <li>Unique Identifier Attribute - entryuuid</li>
         <li>DN Attribute - entrydn</li>
         <li>User Object Class - inetorgperson</li>
         <li>User Object Filter - (objectclass=inetorgperson)
            </li>
         <li>*Account Disabled Attribute - ds-pwp-account-disabled</li>
         <li>*Account Disabled Value - TRUE</li>
         <li>*Account Enabled Value - FALSE</li>
         <li>Password Attribute - userpassword</li>
         <li>Group Object Class - groupofuniquenames</li>
         <li>Group Object Filter - (objectclass=groupofuniquenames)
            </li>
         <li>Member Attribute - uniquemember</li>
         <li>Password Expiration Attribute  - ds-pwp-password-expiration-time</li>
      </ul>
      <h2>Schema read</h2>
      <p>There are no special considerations for OpenDJ integrations.</p>
      <p>To add attributes from AUX classes,  add the auxiliary class as an Auxiliary Object Class to the directory provisioning configuration. </p>
      <h2>Password change </h2>
      <p>Users trigger a password change by selecting <span class="uicontrol">Settings</span> on the <MadCap:variable name="okta-variables.ProductName"/>  end user dashboard.</p>
      <p>To allow  users to change or reset their password, click <span class="menucascade">
            <span class="uicontrol">Security</span>
            <span class="uicontrol">Delegated Authentication</span>
         </span> , select the <span class="uicontrol">LDAP</span> tab, and then select <span class="menucascade">
             <span class="uicontrol">Users can change their LDAP passwords</span>
             <span class="uicontrol">in</span>
             <span class="uicontrol">
                 <MadCap:variable name="okta-variables.ProductName" />
             </span>
         </span>. </p>
      <p>You can configure settings such as password length and expiration on your LDAP instance.</p>
      <p>Password update operations that fail are parsed by <MadCap:variable name="okta-variables.ProductName"/> and the error message appears in the Delegated Authentication page.</p>
      <h2>Password  reset</h2>
      <p>Password reset is triggered by an administrator or the User Forgot Password flow.</p>
      <p>Password reset can fail if the new password does not meet the password policy criteria.</p>
      <p>Users cannot update expired passwords. Expired passwords must be reset by an administrator.</p>
      <h2>Password  validation</h2>
      <p>Use the  pwdPolicy object class to implement OpenDJ specific password policies.</p>
      <p>If you do not specify OpenDJ password validators for your password policy, there are no restrictions on password length or permissible characters.</p>
      <h2>Import</h2>
      <p>Users or groups created in OpenDJ are not included in an incremental import until the first user profile change is detected.</p>
      <h2>JIT provisioning</h2>
      <p>There are no special considerations for OpenDJ Just In Time (JIT) provisioning. For user identification (UID), use an email format   to match the default setting for an <MadCap:variable name="okta-variables.ProductName"/> username. Do not use an external identity provider (IDP)  to trigger sign in.</p>
      <p>To make sure that JIT provisioning is successful the first time:</p>
      <ul>
         <li>the value of the configured naming attribute (such as UID) must not exist in Okta.</li>
         <li>the value of the configured naming attribute (such as UID) must be unique in all JIT-enabled directories.</li>
         <li>the required attributes must present. The <MadCap:variable name="okta-variables.ProductName"/> defaults are email, givenName, sn, and uid.</li>
         <li>the password must be correct.</li>
         <li>the Account Disabled Attribute must be set to false on the LDAP server.</li>
      </ul>
      <p>When JIT provisioning completes successfully, all of the user attributes specified on the LDAP settings page and in the Profile Editor are imported.  To select additional mandatory attributes, use the Profile Editor.</p>
      <h2>Membership import</h2>
      <p>User profiles with OpenDJ settings are added to groups with the object class <code>groupofuniquenames</code> and assigned the <code>uniquemember</code> group attribute.</p>
      <h2>Provisioning</h2>
      <p>If you do not specify OpenDJ password validators for your password policy, there are no restrictions on password length or permissible characters.</p>
      <p>To create and assign passwords when creating user profiles:</p>
      <ol>
         <li>Contact <MadCap:variable name="okta-variables.ProductName"/> customer support to enable LDAP push password updates.</li>
         <li>Disable delegated authentication:</li>
         <ol style="list-style-type: lower-alpha;">
            <li>
                    In the <MadCap:variable name="okta-feature-names.Administrator dashboard"/>, go to <span class="menucascade">
                     <span class="uicontrol">Security</span>
                     <span class="uicontrol">Delegated Authentication</span>
                     <span class="uicontrol">LDAP</span>
                  </span>.</li>
            <li>Click <span class="uicontrol">Edit</span> in the <span class="uicontrol">Delegated Authentication</span> pane.</li>
            <li>Clear the <span class="uicontrol">Enable delegated authentication to LDAP</span> check box.</li>
            <li>
                    Click <span class="uicontrol">Save</span>.
                </li>
            <li>Accept the default setting to reset all LDAP user passwords and click <span class="uicontrol">Disable LDAP Authentication</span>.</li>
         </ol>
         <li>
                In the <MadCap:variable name="okta-feature-names.Administrator dashboard"/>, go to <span class="menucascade">
                  <span class="uicontrol">Directory</span>
                  <span class="uicontrol">Directory Integrations</span>
                  <span class="uicontrol">LDAP</span>
                  <span class="uicontrol">Provisioning</span>
                  <span class="uicontrol">To App</span>
               </span>.</li>
         <li>Click <span class="uicontrol">Edit</span>, select <span class="uicontrol">Enable</span> next to <span class="uicontrol">Sync Password</span>, and click <span class="uicontrol">Save</span>. </li>
         <p>When <span class="uicontrol">Sync Password</span> is enabled, the LDAP agent sends the action PASSWORD_UPDATE when the user signs in for the first time.</p>
      </ol>
      <p>To assign existing <MadCap:variable name="okta-variables.ProductName"/> users to LDAP:</p>
      <ol>
         <li>
                In the <MadCap:variable name="okta-feature-names.Administrator dashboard"/>, go to <span class="menucascade">
                  <span class="uicontrol">Directory</span>
                  <span class="uicontrol">Directory Integrations</span>
                  <span class="uicontrol">LDAP</span>
                  <span class="uicontrol">Provisioning</span>
                  <span class="uicontrol">To App</span>
               </span>.</li>
         <li>Click <span class="uicontrol">Edit</span>, select <span class="uicontrol">Enable</span> next to <span class="uicontrol">Create Users</span>, and click <span class="uicontrol">Save</span>.</li>
         <li>Click <span class="menucascade">
               <span class="uicontrol">Directory</span>
               <span class="uicontrol">Groups</span>
            </span>.</li>
         <li>Select the <MadCap:variable name="okta-variables.ProductName"/> group to which you want to assign users.</li>
         <li>Click <span class="uicontrol">Manage Directories</span>.</li>
         <li>Select an LDAP instance in the left pane and click <span class="uicontrol">Next</span>.</li>
         <li>Enter the full distinguished name (DN) for the new user LDAP container in the <span class="uicontrol">Provisioning Destination DN</span> field.</li>
         <li>Click <span class="uicontrol">Confirm Changes</span>.</li>
      </ol>
      <h2>Troubleshooting</h2>
      <p>If LDAP directory authentication fails, the agent logs display messages similar to the following to assist with diagnosis and resolution:</p>
      <h4>Agent: Success</h4>
      <span class="codeblock">scanResults are sent with user+group info POST initiated with result status=SUCCESS,
actionType=USER_AUTH_AND_UPDATE, diagnostic message=, error code=, matched dn=, message=SUCCESS,
result code=, vendor=OPEN_DJ</span>
      <h4>Agent: Delauth failure</h4>
      <span class="codeblock">POST initiated with result status=FAILURE, actionType=USER_AUTH_AND_UPDATE,
actionId=ADSv0hR8zflMGGeUY0g3, diagnostic message=, error code=49, matched
dn=cn=LynxyForChange,cn=GroupForUser4Level,cn=GroupForUser3Level,
cn=GroupForUser2Level,cn=GroupForUser1Level,ou=LynxySpecificUsers,ou=LynxyUsers,
dc=example,dc=com, message=LDAPException(resultCode=49 (invalid credentials),
errorMessage='invalid credentials'), result code=invalid credentials,
vendor=OPEN_DJ</span>
      <h4>Agent: No user</h4>
      <span class="codeblock">POST initiated with result status=FAILURE, actionType=USER_AUTH_AND_UPDATE,
actionId=ADSv0bQoITDYU63b80g3, diagnostic message=, error code=, matched dn=,
message=User not found while executing query:
(&amp;(objectclass=inetorgperson)(uid=test@test.com)), result code=,
vendor=OPEN_DJ</span>
      <h4>Agent: Password Expired</h4>
      <span class="codeblock">POST initiated with result status=FAILURE, actionType=USER_AUTH_AND_UPDATE,
actionId=ADSv091Tx5GPJsUxV0g3, diagnostic message=, error code=49, matched
dn=cn=LynxyForChange,cn=GroupForUser4Level,cn=GroupForUser3Level,
cn=GroupForUser2Level,cn=GroupForUser1Level,ou=LynxySpecificUsers,ou=LynxyUsers,
dc=example,dc=com, message=LDAPException(resultCode=49 (invalid credentials),
errorMessage='invalid credentials', responseControls={PasswordExpiredControl(isCritical=false)}),
result code=PASSWORD_EXPIRED, vendor=OPEN_DJ</span>
      <h4>Agent: Locked Out or Disabled</h4>
      <p>OpenDJ doesn't have specific error code for account that was locked. In case when pwdAccountLockedTime more than current time - response code will be the same as in case with incorrect password (49 (invalid credentials))</p>
      <span class="codeblock">POST initiated with result status=FAILURE, actionType=USER_AUTH_AND_UPDATE,
actionId=ADSv0pY84CfDLi2Jc0g3, diagnostic message=, error code=49, matched
dn=cn=LynxyForChange,cn=GroupForUser4Level,cn=GroupForUser3Level,cn=GroupForUser2Level,
cn=GroupForUser1Level,ou=LynxySpecificUsers,ou=LynxyUsers,dc=example,dc=com,
message=LDAPException(resultCode=49 (invalid credentials), errorMessage='invalid credentials'),
result code=invalid credentials, vendor=OPEN_DJ</span>
   </body>
</html>
