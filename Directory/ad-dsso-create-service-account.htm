<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:onlyLocalStylesheets="False"
      MadCap:searchable="True"
      MadCap:conditions="MultiProdPublish.Classic+OIE"
      MadCap:fileTags="Tags/okta-authors.Patrick Calnan">
   <head>
      <title>[%=Heading.Level1%] | Okta</title>
      <link href="" rel="stylesheet" type="text/css"/>
      <meta name="description"
            content="Create a new service account and set the Service Principal Name (SPN) to allow Okta negotiate Kerberos authentication for agentless Desktop Single Sign-on (DSSO)."/>
   </head>
   <body>
      <h1>
         <a name="SSOAgentlessPrincName"/>Create a service account and configure a Service Principal Name</h1>
      <p>To use Kerberos authentication for agentless Desktop Single Sign-on (DSSO), you  need to create a new service account and set a Service Principal Name (SPN) for that service account. The service account itself does not need admin permissions, but you need specific permissions to set an SPN. See <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc731241(v=ws.11)">Delegating Authority to Modify SPNs</a>.</p>
      <p>When the service account credential changes, update the corresponding <MadCap:variable name="okta-variables.ProductName"/> service account credential at the same time to avoid service outages. As a security precaution, <MadCap:variable name="okta-variables.ProductName"/> recommends updating the service account credential regularly.</p>
      <p>When Federal Information Processing Standards (FIPS) functionality is enabled, the service account username and password must meet this criteria:</p>
      <ul>
         <li>The combined length of the service account username and the domain name must include a minimum of 16 characters.</li>
      </ul>
      <ul>
         <li>The service account password must contain a minimum of 14 characters.</li>
      </ul>
      <ol>
         <li>To open the Active Directory Users and Computers (ADUC) Microsoft Management Console (MMC) console, on the Active Directory server click <span class="menucascade">
               <span class="uicontrol">Start</span>
               <span class="uicontrol">Run</span>
            </span>, enter <span class="codeph">dsa. msc</span>, and press <span class="uicontrol">Enter</span>.</li>
         <li>
                Right-click the folder where you want to create the new account and select <span class="menucascade">
               <span class="uicontrol">New</span>
               <span class="uicontrol">User</span>
            </span>.
            </li>
         <li>Complete these fields:<ul>
               <li>
                  <span class="uicontrol">First name</span> — Enter the user's first name. </li>
               <li>
                  <span class="uicontrol">Initials</span> — Optional. Enter an initial for the user's middle name.</li>
               <li>
                  <span class="uicontrol">Last name</span> — Enter the user's last name.</li>
               <li>
                  <span class="uicontrol">Full name</span> — Optional. Enter the user's full name.</li>
               <li>
                  <span class="uicontrol">User logon name</span> — Enter a username.</li>
               <li>
                  <span class="uicontrol">User logon name (pre-Windows 2000)</span> — Optional. Modify the automatically generated name if necessary.</li>
            </ul>
         </li>
      </ol>
      <ol MadCap:continue="true">
         <li>
                Click <span class="uicontrol">Next</span>.
            </li>
         <li>Complete the <span class="uicontrol">Password</span> and <span class="uicontrol">Confirm Password</span> fields and clear the <span class="uicontrol">User must change password at next logon</span> check box. </li>
      </ol>
      <p style="text-align: left;margin-left: 40px;">
         <MadCap:variable name="okta-variables.ProductName"/> recommends selecting <span class="uicontrol">Password never expires</span> to avoid service interruptions. As a security precaution, update the service account credential regularly.</p>
      <ol start="6">
         <li>Click <span class="uicontrol">Next</span> and click <span class="uicontrol">Finish</span>.</li>
         <li>Right-click the user created in step 6, select <span class="uicontrol">Properties</span>, select the <span class="uicontrol">Account</span> tab, and then select the <span class="uicontrol">This account supports Kerberos AES 128 bit encryption</span> or <span class="uicontrol">This account supports Kerberos AES 256 bit encryption</span> check boxes in the <span class="uicontrol">Account Options</span> area. </li>
         <li>Click <span class="uicontrol">Apply</span>.</li>
         <li>
                Create a group policy to enable AES encryption on the AD server. See <a href="https://docs.microsoft.com/en-us/archive/blogs/openspecification/windows-configurations-for-kerberos-supported-encryption-type">Windows Configurations for Kerberos Supported Encryption Type</a>.
</li>
         <p>The group policy can be created on the domain controller, or on the server where the <MadCap:variable name="okta-feature-names.AD agent short"/> is installed. The policy is applied to the entire domain and applies to all domain servers and workstations within the domain.</p>
         <li>
                Open a command prompt and run this command to configure an SPN for the service account:
                <p>
               <span class="code">setspn -S HTTP/&lt;myorg&gt;.kerberos.&lt;okta|oktapreview|okta-emea&gt;.com &lt;ServiceAccountName&gt;</span>
            </p>
         </li>
      </ol>
      <p style="text-align: left;margin-left: 40px;">Where  <span class="code">HTTP/&lt;myorg&gt;.kerberos.&lt;oktaorg&gt;.com</span> is the SPN. <span class="code">&lt;ServiceAccountName&gt;</span> is the value you used when configuring Agentless DSSO and <span class="code">&lt;oktaorg&gt;</span> is your Okta org (either <span class="code">okta</span>, <span class="code">oktapreview</span>, <span class="code">okta-emea</span>). For example, <code>setspn -S HTTP/atko.kerberos.oktapreview.com atkospnadmin</code>.</p>
      <h2>Next steps</h2>
      <p>
         <MadCap:xref href="ad-dsso-configure-browsers.htm">Configure browsers for agentless Desktop Single Sign-on on Windows</MadCap:xref>
      </p>
      <p>
         <MadCap:xref href="ad-dsso-configure-browsers-mac.htm">Configure browsers for agentless Desktop Single Sign-on on Mac</MadCap:xref>
      </p>
   </body>
</html>
