<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:conditions="MultiProdPublish.Classic+OIE"
      MadCap:fileTags="Tags/okta-authors.Patrick Calnan">
   <head>
      <title>[%=Heading.Level1%] | Okta</title>
      <meta name="description"
            content="A comprehensive list of the prerequisites for Active Directory integrations."/>
   </head>
   <body>
      <h1>Active Directory integration prerequisites</h1>
      <p>This topic provides the prerequisites for Active Directory (AD) integrations.</p>
      <ul>
         <li>
            <a href="#Hardware">Hardware</a>
         </li>
         <li>
            <a href="#Operatin">Operating system and software</a>
         </li>
         <li>
            <a href="#Accountsrequired">Required accounts</a>
         </li>
      </ul>
      <h2>
         <a name="Hardware"/>Hardware</h2>
      <p>To install the <MadCap:variable name="okta-feature-names.AD agent short"/>, one or more Windows servers are required. These servers are called host servers. These host servers must be on at all times and have a continuous connection to the internet so that they can communicate with <MadCap:variable name="okta-variables.ProductName"/>.	</p>
      <ul>
         <li>The host server can be a physical or virtual server.</li>
         <li>The server should have at least 2 CPUs and a minimum of 8GB RAM.</li>
      </ul>
      <h2>
         <a name="Operatin"/>Operating system and software			</h2>
      <p>Download and install the latest version of the <MadCap:variable name="okta-feature-names.AD agent short"/> on your host servers to make sure that you have the most current features and functionality and get optimum performance. If you are running multiple <MadCap:variable name="okta-feature-names.AD agent short"/>s, make sure they are all the same version. Running different versions within a domain can cause all agents in that domain to function at the level of the oldest agent. This does not affect other domains. </p>
      <ul>
         <li>
            <span class="uicontrol">Okta recommends installing Windows server 2012, Windows server 2012 R2, Windows Server 2016, Windows Server 2019, or Windows server 2022 on the host server</span> — You need access to a Windows server to install the <MadCap:variable name="okta-feature-names.AD agent short"/>. You do not need to install the agent on the domain controller. Your system must have 20MB memory for the AD Service Account that is created during the agent installation.
            <p>Note: You must be running IE 10 or later on your Windows server.</p></li>
         <li>
            <p>
               <span class="uicontrol">.NET 4.6.2</span> or later. If you have an earlier version of .NET, upgrade to 4.6.2 or later.</p>
         </li>
         <li>To improve the security of AD integrations, the default security protocol is TLS1.2  for orgs running .NET Framework 4.5 or later.</li>
         <li>
            <span class="uicontrol">AD domain/forest functional level</span> — <MadCap:variable name="okta-variables.ProductName"/> supports an AD domain/forest functional level of 2003 and higher. For additional information on AD domain functional levels, see: <a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/active-directory-functional-levels">https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/plan/security-best-practices/understanding-active-directory-domain-services--ad-ds--functional-levels</a>
            <ul>
               <li>If you are using the AD domain functional level of 2003, AD usernames must be in the domain name format. That is, users must have a UPN that contains the <span class="uicontrol">@domain.name</span> format.</li>
            </ul>
         </li>
         <li>
            <span class="uicontrol">Member server</span> — The host server can be a member server in your AD domain or a domain controller. <MadCap:variable name="okta-variables.ProductName"/> recommends that you use a member server.</li>
         <li>
            <p>
               <span class="uicontrol">Run the setup wizard from the host server</span> – Run the agent setup wizard in a web browser on the host server where you want to install the agent. If you do not follow this recommendation, you must transfer the agent installer to the host server and then run it.</p>
         </li>
         <li>
            <span class="uicontrol">Must be a member server within your active directory forest</span> — The host server can be in a different domain than the domain that your users reside, but it must be in the same AD forest. Placing the agent on a different domain may cause performance issues.</li>
         <li>
            <span class="uicontrol">AD password history policy</span>  — To enforce the AD Password History policy, you must use <MadCap:variable name="okta-feature-names.AD agent short"/> version 3.4.1 or later and your AD Domain functional level should be Windows Server 2012 R2 or higher.</li>
         <li>
            <span class="uicontrol">High availability</span>   — To ensure high availability and redundancy,  install the agent on two or more computers.</li>
         <li>
            <span class="uicontrol">Number of agents</span>   — If there are 30K or more users, deploy a minimum of 3 AD agents.</li>
      </ul>
      <p>You also need to determine:</p>
      <ul>
         <li>the username format to use when importing AD users into <MadCap:variable name="okta-variables.ProductName"/> (email, samAccountName, UPN, or custom).</li>
         <li>which OUs to import users and groups from.</li>
         <li>which AD attributes to import to the <MadCap:variable name="okta-variables.ProductName"/> user profile.</li>
      </ul>
      <h2>
         <a name="Accountsrequired"/>Required accounts</h2>
      <ul>
         <li>
            <a href="#Oktaadmin">Okta admin account</a> — Used when you install the AD agent to allow the AD agent to connect to <MadCap:variable name="okta-variables.ProductName"/>. This account should be <MadCap:variable name="okta-variables.ProductName"/>-sourced, not AD-sourced. Super admin permissions are required for this account type.          </li>
         <li>
            <a href="#ADuseraccount">AD user account with Domain Admin permissions</a> — Required to run the <MadCap:variable name="okta-feature-names.AD agent short"/> installer. <MadCap:variable name="okta-variables.ProductName"/> recommends using the same AD service account to install all <MadCap:variable name="okta-feature-names.AD agent short"/>s. During the installation, you are asked if you want to create the <MadCap:variable name="okta-variables.ProductName"/> service account. </li>
         <li>
            <a href="#OktaService">
               <MadCap:variable name="okta-variables.ProductName"/> service account to run <MadCap:variable name="okta-variables.ProductName"/> AD Agent service</a> — This is an AD domain service or user account. It can be created by the installer (called <MadCap:variable name="okta-variables.ProductName"/>Service by default) or you can select an existing account. It is important that the <MadCap:variable name="okta-variables.ProductName"/> service account has permissions in all domains in that forest to read and access user data in all domains to which the agent connects.</li>
      </ul>
      <h3>
         <a name="Oktaadmin"/>Create an <MadCap:variable name="okta-variables.ProductName"/> admin account</h3>
      <p class="noteindent">For installation, you need an <MadCap:variable name="okta-variables.ProductName"/> account, not an AD account, to connect the AD agent to <MadCap:variable name="okta-variables.ProductName"/>. To create this account, you must be a super admin. </p>
      <p class="noteindent">
         <MadCap:variable name="okta-variables.ProductName"/> recommends that you use a dedicated <MadCap:variable name="okta-variables.ProductName"/> admin account for the AD agent. If you use an individual's super admin account to install and run the AD agent, and that individual later has their admin privileges lowered, revoked, or  deactivated, the <MadCap:variable name="okta-variables.ProductName"/> AD integration  stops working. If this occurs, you need to uninstall the existing AD agent and reinstall the AD agent with a new super admin account to reconnect <MadCap:variable name="okta-variables.ProductName"/> to AD.</p>
      <ol>
         <li>Sign in to your <MadCap:variable name="okta-variables.ProductName"/> super admin account.</li>
         <li>Click <span class="uicontrol">Admin</span> to open the <MadCap:variable name="okta-variables.ProductName"/> Admin Console.</li>
         <li>Click <span class="menucascade">
               <span class="uicontrol">Directory</span>
               <span class="uicontrol">People</span>
               <span class="uicontrol">Add Person</span>
            </span>. </li>
         <li>Complete the fields and click <span class="uicontrol">Save</span>.</li>
         <li>Click <span class="menucascade">
               <span class="uicontrol">Security</span>
               <span class="uicontrol">Administrators</span>
               <span class="uicontrol">Add Administrator</span>
            </span>. <ol style="list-style-type: lower-alpha;">
               <li>In the <span class="uicontrol">Grant Administrator role to field</span>, start entering the name of the user you added in step 3 and select the user from the list.</li>
               <li>Select  <span class="uicontrol">Super Administrator</span>. For admin permissions information, see <MadCap:xref href="../Security/Administrators.htm">Administrators</MadCap:xref>.<br/>
               </li>
            </ol>
         </li>
      </ol>
      <p>
         <MadCap:variable name="okta-variables.ProductName"/> recommends that the <MadCap:variable name="okta-feature-names.AD agent short"/> admin accounts are <MadCap:variable name="okta-variables.ProductName"/>-sourced and not AD-sourced. This does not affect existing AD-sourced administrators. It is recommended that you disconnect your admins from AD (select <span class="menucascade">
            <span class="uicontrol">Directory</span>
            <span class="uicontrol">People</span>
            <span class="uicontrol">More Actions</span>
            <span class="uicontrol">Disconnect from AD</span>
         </span>, select the admin users who you want to disconnect, and then click  <span class="uicontrol">Disconnect Selected</span>).</p>
      <p class="noteindent" MadCap:conditions="Primary.review-only">If you are using a third-party delegated authentication service, such as Workday which delegates authentication into one service and to another service, <MadCap:variable name="okta-variables.ProductName"/> recommends that when you create a user or service account with Admin rights, disable delegated authentication for these accounts and make them <MadCap:variable name="okta-variables.ProductName"/> sourced (user account with a password stored in <MadCap:variable name="okta-variables.ProductName"/>). This applies for any service account that you create in downstream apps.</p>
      <h3>
         <a name="ADuseraccount"/>AD service account to run the <MadCap:variable name="okta-feature-names.AD agent short"/> installer</h3>
      <p>
         <MadCap:variable name="okta-variables.ProductName"/> recommends you use the same AD service account to install all of your agents. During agent installation, you are asked if you want the installer create the <MadCap:variable name="okta-variables.ProductName"/> service account. You need one of the following based on your choice:</p>
      <ul>
         <li>An AD domain admin account if you want to let the installer create the <MadCap:variable name="okta-variables.ProductName"/> service account.</li>
         <li>An AD user account that has local administrator privileges on the host server if you want to use an existing domain user account as the <MadCap:variable name="okta-variables.ProductName"/> service account.</li>
         <li>
            <p>An AD user account needs read access rights to the OU, including the OktaService account, when selecting <span class="wintitle">Use an alternate account that I specify</span> in the Setup.</p>
         </li>
      </ul>
      <h3>
         <a name="OktaService"/>
         <MadCap:variable name="okta-variables.ProductName"/> service account to run <MadCap:variable name="okta-feature-names.AD agent short"/> service</h3>
      <p>The <MadCap:variable name="okta-variables.ProductName"/>  service account can be created by the installer. By default it is called <span class="uicontrol">OktaService</span>. If you choose to use an existing domain user account, be sure to set the account password to never expire. Managed service accounts are supported by <MadCap:variable name="okta-feature-names.AD agent short"/> version 3.6.0 and later. </p>
      <p>During installation, you are asked if you want to let the installer create the <MadCap:variable name="okta-variables.ProductName"/> service account. To do so, you must have the following permissions:</p>
      <ul>
         <li>Be a member of the domain admins group. This is required because you must be able to create a new AD user in AD that will act as the AD agent service account.</li>
         <li>Have local administrator privileges. If you are installing the AD agent but using an existing user account to run as the service account, you only need local administrator privileges.</li>
      </ul>
      <p>With either option, the installer grants <span class="uicontrol">logon as a service</span> to the domain user you select.</p>
      <h3>Okta service account permissions</h3>
      <p>The AD agent runs under the <MadCap:variable name="okta-variables.ProductName"/> account you specified (either the <MadCap:variable name="okta-variables.ProductName"/>service account the installer creates or the domain user you select during the agent install). Depending on the configuration of your integration, the agent performs the following actions:</p>
      <ul>
         <li>
            <span class="uicontrol">Read users, OUs, and groups</span> — Requires read access on the accessed objects. By default, a domain user has sufficient permission to do this. We recommend read access on the entire domain, but it isn't required.</li>
         <li>
            <span class="uicontrol">Authenticate users</span> — No special permissions are required.</li>
         <li>
            <span class="uicontrol">Change user passwords (by supplying the current password)</span> — No special permissions are required.</li>
         <li>
            <span class="uicontrol">Set user passwords (administratively, without the current password)</span> — Requires permissions to set passwords for users.</li>
         <li>
            <span class="uicontrol">Create and update users, attributes, and memberships in AD with values pushed from Okta</span> — Requires permissions to read and write to the attribute(s) you are updating.</li>
      </ul>
      <h3>Configure delegation for the Okta Service account</h3>
      <p>
         <a name="Okta_Svc_Acct_Permisions"/>On your Windows server you need to configure delegation to Okta service account in your AD domain based on your needs. </p>
      <ol>
         <li>On your AD Domain controller, open the <span class="uicontrol">Active Directory Users and Computers</span> snap-in.</li>
         <li> Right-click the <span class="uicontrol">OU</span> or <span class="uicontrol">domain name</span>, and then select <span class="uicontrol">Delegate Control</span>. </li>
         <li>In the Delegation of Control Wizard. add the <MadCap:variable name="okta-variables.ProductName"/> service account and select the  tasks to delegate:<ul>
               <li>
                  <p>
                     <span class="uicontrol">Create, delete, and manage user accounts</span> — For create and update user flows.</p>
               </li>
               <li>
                  <p>
                     <span class="uicontrol">Reset user passwords and force password change at next logon</span> — For syncing passwords.</p>
               </li>
               <li>
                  <p>
                     <span class="uicontrol">Read all user information</span> — For import and create user flows.</p>
               </li>
               <li>
                  <p>
                     <span class="uicontrol">Modify the membership of a group</span> — For Group Push.</p>
               </li>
            </ul>
         </li>
      </ol>
   </body>
</html>
