<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd"
      MadCap:fileTags="Tags/okta-authors.Ian Hakes">
   <head>
      <link rel="canonical"
            href="https://help.okta.com/wf/en-us/Content/Topics/Workflows/connector-reference/office365mail/overviews/authorization.htm"/>
      <title>[%=Heading.Level1%] | Okta</title>
      <meta name="coveo:connector" content="office365mail"/>
      <meta name="coveo:method-description"
            content="When you add an Office 365 Mail card to a Okta Workflow for the first time you'll be prompted to configure the connection."/>
      <meta name="coveo:method-name" content="authorization"/>
      <meta name="coveo:method-type" content="authorization"/>
   </head>
   <body>
      <div data-content-id="hoc-main-content">
         <h1>Authorization</h1>
         <p>When you add an <MadCap:variable name="workflows_connectors.Office 365 Mail"/> card to a <MadCap:variable name="okta-feature-names.Okta Workflow"/> for the first time, you'll be prompted to configure the connection. This helps you to connect your <MadCap:variable name="workflows_connectors.Office 365 Mail"/> account, save your account information, and reuse the connection for future <MadCap:variable name="workflows_connectors.Office 365 Mail"/> flows. Create a connection using an <MadCap:variable name="workflows_connectors.Office 365 Mail"/> admin account or an <MadCap:variable name="workflows_connectors.Office 365 Mail"/> user account. Okta recommend that you use an <MadCap:variable name="workflows_connectors.Office 365 Mail"/> admin account when creating a connection for the first time. </p>
         <div class="noteOkta">
            <p class="noteContent">Make sure that you have enabled supported scopes. See <MadCap:xref href="guidanceforoffice365mailsconnector.htm">Guidance for Office 365 Mail connector</MadCap:xref>.</p>
         </div>
         <ul>
            <li>
               <p>
                  <MadCap:xref href="#admin">Create a connection with an Office 365 Mail admin account</MadCap:xref>
               </p>
            </li>
            <li>
               <p>
                  <MadCap:xref href="#user">Create a connection with an Office 365 Mail user account</MadCap:xref>
               </p>
            </li>
            <li>
               <p>
                  <MadCap:xref href="#Prohibit">Prohibit users from creating new connections</MadCap:xref>
               </p>
            </li>
            <li>
               <p>
                  <MadCap:xref href="#Reauthorize">Re-authorize a connection</MadCap:xref>
               </p>
            </li>
         </ul>
         <div class="noteOkta">
            <p class="noteContent">For your convenience, Okta has created <MadCap:variable name="workflows_connectors.Office 365 Mail"/> OAuth applications:</p>
            <ul>
               <li>
                  <p class="noteContent">Preview: <MadCap:variable name="workflows_connectors.Office 365 Mail"/> for Okta Preview.</p>
               </li>
               <li>
                  <p class="noteContent">Production: <MadCap:variable name="workflows_connectors.Office 365 Mail"/> for Okta Workflows.</p>
               </li>
            </ul>
         </div>
         <h3>
            <a name="admin"/>Create a connection with an Office 365 Mail admin account</h3>
         <ol>
            <li>
               <p>Click <span class="uicontrol">New Connection</span>.</p>
            </li>
            <li>
               <p>Enter a <span class="uicontrol">Connection Nickname</span>. This is useful if you plan to create multiple <MadCap:variable name="workflows_connectors.Office 365 Mail"/> connections to share with your team.</p>
            </li>
            <li>
               <p>Click <span class="uicontrol">Create</span>.</p>
            </li>
            <li>
               <p>Log in to your <MadCap:variable name="workflows_connectors.Office 365 Mail"/> account to authorize the connection.</p>
            </li>
            <li>
               <p>Select one of the following options:</p>
               <ol style="list-style-type: lower-alpha;">
                  <li>
                     <p>
                        <span class="uicontrol">As an admin you don't want regular users to create connections</span>. Click <span class="uicontrol">Accept</span> and make sure that the Consent on behalf of your organization option is <span class="uicontrol">not</span> selected.</p>
                  </li>
                  <li>
                     <p>
                        <span class="uicontrol">As an admin you want regular users also able to create connections</span>. Click <span class="uicontrol">Accept</span> and make sure that the <span class="uicontrol">Consent on behalf of your organization</span> option is  selected. All  user accounts in your organization can create connections on their own.</p>
                  </li>
               </ol>
            </li>
         </ol>
         <h3>
            <a name="user"/>Create a connection with an Office 365 Mail user account</h3>
         <ol>
            <li>
               <p>Click <span class="uicontrol">New Connection</span>.</p>
            </li>
            <li>
               <p>Enter a <span class="uicontrol">Connection Nickname</span>. This is useful if you plan to create multiple <MadCap:variable name="workflows_connectors.Office 365 Mail"/> connections to share with your team.</p>
            </li>
            <li>
               <p>Click <span class="uicontrol">Create</span>.</p>
            </li>
            <li>
               <p>Log in to your <MadCap:variable name="workflows_connectors.Office 365 Mail"/> account to authorize the connection.</p>
            </li>
            <li>
               <p>Select one of the following options:</p>
               <ol style="list-style-type: lower-alpha;">
                  <li>
                     <p>
                        <span class="uicontrol">Can accept the permissions requested directly</span>.By selecting this option, the admin allows regular user consent for this Okta app. </p>
                  </li>
                  <li>
                     <p>
                        <span class="uicontrol">Need admin approval</span>. Contact your admin to grant you access to the application. See <MadCap:xref href="#Consent">Consent for all apps</MadCap:xref> or <MadCap:xref href="#Grant">Grant tenant-wide admin consent.</MadCap:xref>
                     </p>
                  </li>
                  <li>
                     <p>
                        <span class="uicontrol">Need to submit an approval request</span>. Enter justification for requesting this app in the space provided. See <MadCap:xref href="#Enableadminconset">Enable the admin consent workflow</MadCap:xref>.</p>
                  </li>
               </ol>
            </li>
            <li>
               <p>Click <span class="uicontrol">Accept</span>.</p>
            </li>
         </ol>
         <h3>Admin app approval</h3>
         <p>Admins can grant Okta app access to regular user accounts.  If an admin forgot to select the <span class="wintitle">Consent on behalf of your organization</span> option and then clicks <span class="uicontrol">Accept</span> when configuring a connection, the authorization page might not display using the same admin account. This occurs because the connection was authorized by the Okta app and is remembered by the system.</p>
         <p>The following information provides additional ways for an admin to grant Okta app access to regular user accounts.</p>
         <h4>
            <a name="Consent"/>Consent for all apps</h4>
         <p>Allow user consent for all apps, or for apps from verified publishers, for selected permissions. Configure permissions as Global Admin only. See <a href="https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/configure-user-consent?tabs=azure-portal"
               target="_blank">Configure how users consent to applications</a>.</p>
         <ol>
            <li>
               <p>In the Azure Portal, select <span class="menucascade">
                     <span class="uicontrol">Azure Active Directory</span>
                     <span class="uicontrol">Enterprise applications</span>
                     <span class="uicontrol">Consent and permissions</span>
                     <span class="uicontrol">User consent settings</span>
                  </span>.</p>
            </li>
            <li>
               <p>Select one of the following permissions options:</p>
               <ul>
                  <li>
                     <p>
                        <span class="uicontrol">Allow user consent for apps</span>. This is a less secure option.</p>
                  </li>
                  <li>
                     <p>
                        <span class="uicontrol">Allow user consent for apps from verified publishers</span>. This is a secure option. Configure    the following permission as low impact: </p>
                  </li>
                  <ul style="list-style-type: circle;">
                     <li>
                        <span class="code">Mail.ReadWrite</span>
                     </li>
                     <li>
                        <span class="code">Mail.ReadWrite.Shared</span>
                     </li>
                     <li>
                        <span class="code">Mail.Send</span>
                     </li>
                     <li>
                        <span class="code">Mail.Send.Shared</span>
                     </li>
                     <li>
                        <span class="code">offline_access</span>
                     </li>
                  </ul>
               </ul>
            </li>
            <li>
               <p>From  <span class="wintitle">Enterprise applications</span> go to the <span class="wintitle">Admin consent requests</span> page and review and grant access.</p>
            </li>
         </ol>
         <h4>
            <a name="Grant"/>Grant tenant-wide admin consent</h4>
         <p>You can grant tenant-wide admin consent for an Okta app only if the Okta app is authorized by your admin account, or any other admin accounts. See <a href="https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/grant-admin-consent"
               target="_blank">Grant tenant-wide admin consent to an application</a>.</p>
         <ol>
            <li>
               <p>In your Azure Portal, go to <span class="menucascade">
                     <span class="uicontrol">Azure Active Directory</span>
                     <span class="uicontrol">Enterprise applications</span>
                  </span>.</p>
            </li>
            <li>
               <p>Select one of the following Okta apps:</p>
               <ul>
                  <li>
                     <p>Office 365 Mail for Okta Preview</p>
                  </li>
                  <li>
                     <p> Office 365 Mail for Okta Workflows.</p>
                  </li>
               </ul>
            </li>
            <li>
               <p> Select <span class="menucascade">
                     <span class="uicontrol">Permissions</span>
                     <span class="uicontrol">Grant admin consent</span>
                  </span>.<br/>All regular user accounts  in your organization have been granted consent to the Okta app.</p>
            </li>
         </ol>
         <h4>
            <a name="Enableadminconset"/>Enable the admin consent workflow</h4>
         <p>Enable regular users to request access to applications that require admin consent. Users won't be  able to directly create connections until the request is approved by the admin. Configure permissions as Global Admin only. See <a href="https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/configure-admin-consent-workflow"
               target="_blank">Configure the admin consent workflow</a>.</p>
         <ol>
            <li>
               <p>In your Azure Portal, select <span class="menucascade">
                     <span class="uicontrol">Azure Active Directory</span>
                     <span class="uicontrol">Enterprise applications</span>
                  </span>.</p>
            </li>
            <li>
               <p> Under <span class="uicontrol">Manage</span>, select <span class="uicontrol">User settings</span>.</p>
            </li>
            <li>
               <p> Under <span class="menucascade">
                     <span class="uicontrol">Admin consent requests</span>
                     <span class="uicontrol">Users can request admin consent to apps they are unable to consent to</span>
                  </span>, select <span class="uicontrol">Yes</span>. See <a href="https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/configure-admin-consent-workflow"
                     target="_blank">Configure the admin consent workflow</a>.</p>
            </li>
            <li>
               <p>From  <span class="wintitle">Enterprise applications</span> go to the <span class="wintitle">Admin consent requests</span> page and review and grant access.</p>
            </li>
         </ol>
         <h3>
            <a name="Prohibit"/>Prohibit users from creating new connections</h3>
         <p>Remove  admin consent that was granted previously by deleting  the Okta app in Enterprise applications and then re-authorize it. Deleting the app revokes the admin consent tenant-wide. Revoking individual user consent is not allowed.</p>
         <p> All existing connections stop working after one hour. For previously configured admin connections that you want to keep active, manually re-authorize them and use the consent process  to avoid connection failure.</p>
         <ol>
            <li>
               <p>In your Azure Portal, select <span class="menucascade">
                     <span class="uicontrol">Azure Active Directory</span>
                     <span class="uicontrol">Enterprise applications</span>
                  </span>.</p>
            </li>
            <li>
               <p>Select one of the following Okta apps:</p>
               <ul>
                  <li>
                     <p>Office 365 Mail for Okta Preview</p>
                  </li>
                  <li>
                     <p> Office 365 Mail for Okta Workflows</p>
                  </li>
               </ul>
            </li>
            <li>
               <p> Select <span class="uicontrol">Delete</span>.</p>
            </li>
         </ol>
         <p>Admin consents previously granted are revoked and regular users won't be able to create new connections until  admin consent is granted.</p>
         <h3>
            <a name="Reauthorize"/>Re-authorize a connection</h3>
         <p>If you've used your account to create a connection successfully, you can use this account to create multiple connections. If you've already created connections you can re-authorize these connections as long as there are no configuration changes made by the admin.</p>
         <MadCap:snippetBlock src="../o365mailseealso.flsnp"/>
      </div>
   </body>
</html>
