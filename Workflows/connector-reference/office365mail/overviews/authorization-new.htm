<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:fileTags="Tags/okta-authors.Ian Hakes" MadCap:conditions="Primary.do-not-publish">
    <head>
        <link rel="canonical" href="https://help.okta.com/wf/en-us/Content/Topics/Workflows/connector-reference/office365mail/overviews/authorization.htm" /><title>[%=Heading.Level1%] | Okta</title>
        <meta name="coveo:connector" content="office365mail" />
        <meta name="coveo:method-description" content="When you add an Office 365 Mail card to a Okta Workflow for the first time you'll be prompted to configure the connection." />
        <meta name="coveo:method-name" content="authorization" />
        <meta name="coveo:method-type" content="authorization" />
    </head>
    <body>
        <div data-content-id="hoc-main-content">
            <h1>Authorization</h1>
            <p>When you add an <MadCap:variable name="workflows_connectors.Office 365 Mail" /> card to a <MadCap:variable name="okta-feature-names.Okta Workflow" /> for the first time, you'll be prompted to configure the connection. This will enable you to connect your <MadCap:variable name="workflows_connectors.Office 365 Mail" /> account, save your account information, and reuse the connection for future <MadCap:variable name="workflows_connectors.Office 365 Mail" /> flows.</p>
            <div class="noteOkta" MadCap:conditions="Primary.review-only">
                <img src="../../../../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Note" alt="Note" />
                <p class="noteContent"> An <MadCap:variable name="workflows_connectors.Office 365" /> user or admin account can be used to authenticate with this connector. For information about authenticating with a user account, see Guidance for Office 365 Mail connector.</p>
                <p class="noteContent">After creating a new connection or reauthorizing an existing connection, any 404 errors are not addressed by the connector and need to be handled within the flow. </p>
            </div>
            <div class="noteOkta">
                <img src="../../../../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Note" alt="Note" />
                <p class="noteContent">You must be an <MadCap:variable name="workflows_connectors.Office 365" /> administrator in order to authenticate with this connector.</p>
                <p class="noteContent">After creating a new connection or reauthorizing an existing connection, any 404 errors are not addressed by the connector and need to be handled within the flow. </p>
            </div>
            <div class="noteOkta">
                <img src="../../../../../Resources/Images/assets/Icons/Notes/icon-lightbulb.png" class="noteImgFloat" title="Tip" alt="Tip" />
                <p class="noteContent">You can create multiple connections and manage them from your Connections page.</p>
                <p class="noteContent">Before an application can access your organization's data, a user must grant the application permissions to do so. See <a href="https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/configure-user-consent?tabs=azure-portal" target="_blank">Configure user consent</a>.</p>
            </div>
            <p>To authorize an <MadCap:variable name="workflows_connectors.Office 365 Mail" /> account and grant it the necessary properties to create an account for use with Workflows:</p>
            <ol>
                <li>
                    <p>Navigate to your <MadCap:variable name="3rd Party Integrations.AAD" /> console.</p>
                </li>
                <li>
                    <p>Click <span class="uicontrol">Enterprise applications</span> &gt;&#160;<span class="uicontrol">Consent and permissions</span> &gt;&#160;<span class="uicontrol">User consent settings</span>.</p>
                </li>
                <li>
                    <p>Select <span class="uicontrol">Allow user consent to apps</span>.</p>
                </li>
                <li>
                    <p>Select <span class="uicontrol">Allow group owner consent for all group owners</span>.</p>
                </li>
            </ol>
            <p>To create a new connection:</p>
            <ol>
                <li>
                    <p>Click <span class="uicontrol">New Connection</span>.</p>
                </li>
                <li>
                    <p>Enter a <span class="uicontrol">Connection Nickname</span>. This is useful if you plan to create multiple <MadCap:variable name="workflows_connectors.Office 365 Mail" /> connections to share with your team.</p>
                </li>
                <li>
                    <p>Click <span class="uicontrol">Create</span>.</p>
                </li>
                <li>
                    <p>Log in to your <MadCap:variable name="workflows_connectors.Office 365 Mail" /> account to authorize the connection. </p>
                    <p MadCap:conditions="Primary.review-only">One of the following options appears in the <span class="wintitle">Permissions requested</span> page.</p>
                    <ol style="list-style-type: lower-alpha;" MadCap:conditions="Primary.review-only">
                        <li>
                            <p MadCap:conditions="Primary.review-only">Select the <span class="wintitle">Consent on behalf of your organization</span> checkbox and then click <span class="uicontrol">Accept</span>. All user accounts in your organization can create their own connection without admin assistance.</p>
                        </li>
                        <li>
                            <p MadCap:conditions="Primary.review-only">Click <span class="uicontrol">Accept</span>. Regular users  won't be able to create their own connection without admin assistance.</p>
                        </li>
                    </ol>
                </li>
            </ol>
            <h3>Workflows header properties</h3>
            <p>By default, Workflows includes three header properties in all messages sent to APIs:</p>
            <ul>
                <li>User-Agent: <span class="code">azuqua</span></li>
                <li>Content-Type: <span class="code">application/json</span></li>
                <div class="noteOkta">
                    <img src="../../../../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Note" alt="Note" />
                    <p class="noteContent">This property may be changed by the connector to match the specific requirements of the API endpoint.</p>
                </div>
                <li>Content-Length: &lt;length&gt;</li>
                <div class="noteOkta">
                    <img src="../../../../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Note" alt="Note" />
                    <p class="noteContent">The value is calculated  prior to sending the message.</p>
                </div>
            </ul>
            <p>For some APIs, you may need to allow the <span class="code">azuqua</span> User-Agent property to be accepted in the account configuration or security settings of your cloud application.</p>
            <div class="noteOkta">
                <img src="../../../../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Note" alt="Note" />
                <p class="noteContent">Some environments don't allow individual user accounts to consent to application access. If this applies to your environment, you can have an admin authorize the Workflows app for use with <MadCap:variable name="workflows_connectors.Office 365 Mail" /> by creating an account with the required permissions, making a connection in Workflows, then have the admin associated with the account approve the connection. After the connection has been approved, the admin deletes the connection and closes their browser session to remove the authorization token. Create a new connection using a non-admin <MadCap:variable name="workflows_connectors.Office 365" /> account. This new connection can be used to authorize into <MadCap:variable name="workflows_connectors.Office 365 Mail" /> since the Workflows app was approved by an admin.</p>
            </div>
            <h2>Supported scopes</h2>
            <ul>
                <li>Mail.ReadWrite</li>
                <li>Mail.Send</li>
                <li>Mail.Send.Shared</li>
                <li>Mail.ReadWrite.Shared</li>
                <li>offline_access</li>
            </ul>
            <MadCap:snippetBlock src="../o365mailseealso.flsnp" />
        </div>
    </body>
</html>