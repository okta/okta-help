<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:fileTags="Tags/okta-authors.Ian Hakes">
    <head>
        <link rel="canonical" href="https://help.okta.com/wf/en-us/Content/Topics/Workflows/connector-reference/googlecloudfunctions/overviews/authorization.htm" /><title>[%=Heading.Level1%] | Okta</title>
        <meta name="coveo:connector" content="googlecloudfunctions" />
        <meta name="coveo:method-description" content="When you add a Google Cloud Functions card to a Flow for the first time you'll be prompted to create a connection." />
        <meta name="coveo:method-name" content="authorization" />
        <meta name="coveo:method-type" content="authorization" />
    </head>
    <body>
        
        
            <div data-content-id="hoc-main-content">
                <h1>Authorization</h1>
                <p>When you add a <MadCap:variable name="workflows_connectors.Google Cloud Functions" /> card to a flow for the first time, you'll be prompted to create a connection. Connecting your account will enable you to save your account information and reuse that connection the next time you build a flow with the connector.</p>
                <p><span class="uicontrol">Note:</span> You can create multiple connections and share them with your team.</p>
                <div class="noteOkta">
                    <img src="../../../../../Resources/Images/assets/Icons/Notes/icon-lightbulb.png" class="noteImgFloat" title="Tip" alt="Tip" />
                    <p class="noteHeading">Tip</p>
                    <p class="noteContent">You can create multiple connections and manage them from your Connections page.</p>
                </div>
                <p>To create a new connection from an Action card:</p>
                <ol>
                    <li>
                        <p>Click <span class="uicontrol">New Connection</span>.</p>
                    </li>
                    <li>
                        <p>Enter an <span class="uicontrol">Connection Nickname</span>. As a best practice, make this nickname unique so that you can connect multiple <MadCap:variable name="workflows_connectors.Google Cloud Functions" /> accounts.</p>
                    </li>
                    <li>
                        <p>Enter your <span class="uicontrol">Project ID</span>, then click <span class="uicontrol">Create</span>. You can obtain the project ID from the project URL.</p>
                    </li>
                    <li>
                        <p>Choose an account, then click <span class="uicontrol">Allow</span>.</p>
                    </li>
                </ol>
                <h2>Set up the <MadCap:variable name="workflows_connectors.Google Cloud Functions" /> Project</h2>
                <p>Your <MadCap:variable name="workflows_connectors.Google Cloud Functions" /> Project provides access to the Google Cloud Functions API. By using the connector's Custom API Action card, authorized users can call the API for their project. For example, users can call the API to list the cloud functions that are deployed in a particular region. To use the Okta Workflows Custom API Action action card to list all the functions in the project, your Google Cloud Functions Project must be set up properly.</p>
                <p>Complete the following steps:</p>
                <ul>
                    <li>
                        <p>Create a <MadCap:variable name="workflows_connectors.Google Cloud Functions" /> project</p>
                    </li>
                    <li>
                        <p>Enable the <MadCap:variable name="workflows_connectors.Google Cloud Functions" /> API (search and enable it in Library). Otherwise, users will not be able to call the API or invoke cloud functions.</p>
                    </li>
                    <li>
                        <p>Enable the Identity and Access Management API (search and enable it in Library). Otherwise, users will not be able to invoke cloud functions.</p>
                    </li>
                    <li>
                        <p>A service account that starts the project name (i.e. {project-name}@appspot.gserviceaccount.com) will be created when the project is created. Add the following role to the service account:</p>
                    </li>
                    <li><pre><code>Service Account Token Creator
</code></pre>
                    </li>
                    <li>
                        <p>The default region for new cloud functions is <code>us-central1</code>.</p>
                    </li>
                    <li>
                        <p>Note that cloud functions with the same name can be deployed to multiple regions.</p>
                    </li>
                    <li>
                        <p>Use the <span class="uicontrol">IAM &amp; Admin</span> menu to add users to the project, and assign roles to those users.</p>
                        <ul>
                            <li>
                                <p>To invoke a cloud function, a user must be assigned the <code>Cloud Functions Invoker</code> role.</p>
                            </li>
                            <li>
                                <p>Consider assigning other roles to cloud functions: <code>Cloud Functions Admin</code>, <code>Cloud Functions Developer</code>, or <code>Cloud Functions Viewer</code>:</p>
                                <ul>
                                    <li>
                                        <p><code>Cloud Functions Developer</code> can edit and invoke functions</p>
                                    </li>
                                    <li>
                                        <p><code>Cloud Functions Admin</code> can add users and change permissions on functions</p>
                                    </li>
                                    <li>
                                        <p><code>Cloud Functions Viewer</code> can only view functions</p>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
                <p>Additionally, be aware of the following:</p>
                <ul>
                    <li>
                        <p>When you authenticate using the Invoke Function card you must provide the Google Cloud Project ID. Users are authenticated using IAM roles that are assigned within your <MadCap:variable name="workflows_connectors.Google Cloud Functions" /> Project.</p>
                    </li>
                    <li>
                        <p>When the connector calls a Google Cloud Function it will utilize an ID Token (JWT) for your user.</p>
                    </li>
                    <li>
                        <p>The Invoke Function card requires that the user has Google Functions Invoker role. Calls to unsecure cloud functions is not supported by the Invoke Function card, however users can call unsecure functions using the Custom API Action card.</p>
                    </li>
                    <li>
                        <p>You can only create a secure function at the time of creation by making sure that the <span class="uicontrol">Allow unauthenticated invocations</span> checkbox is left unchecked. You cannot secure a function after you've created it. Even if users are assigned to an unsecured function with proper roles, they will not be able to call it.</p>
                    </li>
                    <li>
                        <p>After deployment of a cloud function, security can be configured independently by adding users to the Cloud Functions Invoker role.</p>
                    </li>
                </ul>
                <h2>Supported Scopes</h2>
                <ul>
                    <li>
                        <p>https://www.googleapis.com/auth/cloud-platform</p>
                    </li>
                    <li>
                        <p>https://www.googleapis.com/auth/cloudfunctions</p>
                    </li>
                    <li>
                        <p>openid</p>
                    </li>
                    <li>
                        <p>email</p>
                    </li>
                </ul>
                <h2>Disclaimer Statement</h2>
                <p>The app’s use of information received from <MadCap:variable name="workflows_connectors.Google Cloud Functions" /> APIs will adhere to Google’s Limited Use Requirements.</p>
            </div>
    </body>
</html>
