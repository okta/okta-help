<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_nav_poc" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../" data-mc-has-content-body="True" data-mc-searchable="True" data-mc-toc-path="Devices|Device Trust" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="Enforce Okta Device Trust for Exchange ActiveSync on devices with Okta Mobility Management and use certificates to stop unmanaged devices from using Office 365." /><title>Enforce Okta Device Trust for Exchange ActiveSync on OMM-managed iOS devices | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Pendo Script (Per Chris Bank) -->
        <!-- End Pendo Script -->
        <link href="../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../resources/stylesheets/okta-main-new-nav.css" rel="stylesheet" type="text/css" />
        <script src="../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-NMZZV4P');
			/* ]]> */
		</script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KXMLV58');
			/* ]]> */
		</script>
        <script>
		/* <![CDATA[ */
		(function(apiKey){
			(function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
			v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
			o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
			y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
			z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id:              'VISITOR-UNIQUE-ID'
            },
            account: {
                id:           'ACCOUNT-UNIQUE-ID'
            }
        });
		})('a9bd3885-93ae-46ab-700b-dd29e613c19d');
		/* ]]> */
        function openSurvey() {
            window.open('https://surveys.okta.com/jfe/form/SV_e4L0iW8a3tz8Yol?source=' + encodeURIComponent(document.location.href), '_blank');
        }
		</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1024px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMZZV4P" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.OrgId variable">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="mc-variable okta-coveo-config.PlatformRestUri variable">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchPageUrl variable">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchTokenServiceUrl variable">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <div id="coveo_dev_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.DevOrgId variable">oktanonproduction1il1gtac7</span>
                                    </div>
                                    <div id="coveo_dev_token" style="Display:None"><span class="mc-variable okta-coveo-config.DevSearchToken variable">xxb48840fe-d60d-4e40-b1d3-522d5a35c384</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************** Coveo Search bar ************************************* -->
                                    <!-- set margin and size in /Content/Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css to make room for replacing Flare-generated top-nav with HTML code (see below)-->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper" data-mc-conditions="MultiProdPublish.SearchBar">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="replace_top_nav">
                                        <div class="navbar" data-mc-conditions="Primary.live-site-only">
                                            <div class="dropdown" data-test="menuBarCategory" id="documentationMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">Documentation <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=oie-index" data-test="menuBarLink">Identity Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?id=index-admin" data-test="menuBarLink">Classic Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oag&amp;id=ext_oag_main" data-test="menuBarLink">Access Gateway</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=asa&amp;id=csh-asa-overview" data-test="menuBarLink">Advanced Server Access</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=wf&amp;id=ext-Okta-workflows" data-test="menuBarLink">Workflows</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="relnotesMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">Release notes <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=csh-oie-release-notes" data-test="menuBarLink">Identity Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?id=ext_okta_relnotes" data-test="menuBarLink">Classic Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oag&amp;id=ext_oag_releasenotes" data-test="menuBarLink">Access Gateway</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=asa&amp;id=ext-asa-releasenotes" data-test="menuBarLink">Advanced Server Access</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=wf&amp;id=ext-workflows-releasenotes" data-test="menuBarLink">Workflows</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="oktaDevDocsMenu"><a href="https://developer.okta.com/" target="_blank" data-test="menuBarLink">Okta Developer</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="auth0Menu"><a href="https://auth0.com/docs" target="_blank" data-test="menuBarLink">Auth0</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="trainingMenu"><a href="https://www.okta.com/services/training/" target="_blank" data-test="menuBarLink">Training</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="supportMenu"><a href="https://support.okta.com/help/s/?language=en_US" target="_blank" data-test="menuBarLink">Support</a>
                                            </div>
                                        </div>
                                        <div class="logo_container" id="OktaBanner" data-mc-conditions="Primary.live-site-only"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" data-test="OktaBanner"><img src="../../resources/images/okta-assets/logo.png" alt="Okta product documentation" title="Okta product documentation" data-test="OktaBannerImg" /></a>
                                        </div>
                                        <div class="toolbar-main" data-test="toolBar" data-mc-conditions="Primary.live-site-only">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_no_expand mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie select-language-button" title="Change language">
                                                        <div>
                                                            <div role="img" class="button-icon-wrapper" aria-label="Change language">
                                                                <div class="button-icon"> </div>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics" data-test="bodyWrapper">
                                        <!-- *** Col1: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                                <div class="nocontent">
                                                    <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider="  &gt;  " data-mc-breadcrumbs-count="3" data-mc-toc="True">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="oie-label" data-mc-conditions="MultiProdPublish.Classic">
                                                <img class="oie-label" title="Label: Okta Classic Engine content" src="../../resources/images/okta-assets/classic_engine.svg" />
                                            </div>
                                            <div class="body-main" data-test="bodyContent">
                                                <!-- Main content body -->
                                                <div role="main" id="mc-main-content">
                                                    <h1><a name="top"></a>Enforce Okta <span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span> for Exchange ActiveSync on OMM-managed iOS devices</h1>
                                                    <p class="earlyaccess"><span class="mc-variable okta-variables.EarlyAccess variable">This is an Early Access feature. To enable it, please contact Okta Support.</span>
                                                    </p>
                                                    <p>This Okta <span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span> solution for Microsoft Office 365 EAS on OMM managed iOS devices allows you to do the following: </p>
                                                    <ul>
                                                        <li>Configure the iOS mail app to use certificates instead of passwords to allow OMM-enrolled users to authenticate to Microsoft Office 365 Exchange ActiveSync.</li>
                                                        <li>Configure iOS mail app client access policy to prevent users with unmanaged devices from accessing Microsoft Office 365 Exchange ActiveSync.</li>
                                                    </ul>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/eas_dt_o365_flow3.png" data-mc-popup-alt="The image illustrates how Okta Device Trust is enforced for Exchange ActiveSync on OMM-managed iOS devices."><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="829" data-mc-height="335" src="../../resources/images/eas_dt_o365_flow3_thumb_220_220.png" alt="The image illustrates how Okta Device Trust is enforced for Exchange ActiveSync on OMM-managed iOS devices." tabindex="" /></a>
                                                    </p>
                                                    <p>This <span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span> solution provides these key benefits:</p>
                                                    <ul>
                                                        <li>Allows end users to seamlessly SSO in to their native iOS mail app (EAS) from OMM-enrolled iOS devices</li>
                                                        <li>Enhances Office 365 Exchange ActiveSync security through enforcement of certificate-based authentication instead of password authentication</li>
                                                        <li>
                                                            <p>Prevents users with unmanaged iOS devices from accessing Office365</p>
                                                        </li>
                                                        <li>Helps prevent users from becoming locked-out of their account due to Active Directory (AD) password resets</li>
                                                    </ul>
                                                    <h2>Prerequisites</h2>
                                                    <ul>
                                                        <li>
						An Office 365 tenant federated to an Okta org with at least one license for Exchange Online
					</li>
                                                        <li>
						A Windows computer to run PowerShell commands
</li>
                                                        <li>Azure PowerShell 5.0 (64-bit)</li>
                                                        <li>
					An iOS 9 (or higher) device</li>
                                                    </ul>
                                                    <h2>   Procedures</h2>
                                                    <p>This procedure has four main steps: </p>
                                                    <h3><a name="Step1"></a>Step 1. Enable Exchange ActiveSync certificate-based authentication in Okta</h3>
                                                    <div class="noteOkta">
                                                        <p class="noteContent">
                                                            <ul>
                                                                <li>Do not click <span class="uicontrol">Save</span> at the end of Step 1. You will save changes in <a href="#Step3">Step 3: Distribute certificates for EAS to OMM-enrolled devices.</a></li>
                                                                <li>If you have set up multiple Office 365 app instances in your org, note that Okta generates a different Okta CA certificate for each Office 365 app instance/domain. This means that you must upload a separate root certificate for each Office 365 app instance/domain that you want to configure with certificate based authentication.</li>
                                                            </ul>
                                                        </p>
                                                    </div>
                                                    <ol>
                                                        <li value="1"><a name="FromOktaAdminConsole"></a>In the <span class="mc-variable okta-feature-names.Administrator_dashboard variable">Admin Console</span>, go to <span class="menucascade"><span class="uicontrol">Applications</span><span class="uicontrol">Applications</span></span>. </li>
                                                        <li value="2">Click the Office 365 app.</li>
                                                        <li value="3">Click the <span class="wintitle">Mobile</span> tab.</li>
                                                        <li value="4">Scroll down to <span class="wintitle">Exchange ActiveSync Settings</span>, and then click <span class="uicontrol">Edit</span>.
									<p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/eas_cba_o365.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="583" data-mc-height="661" src="../../resources/images/eas_cba_o365_thumb_220_220.png" tabindex="" /></a></p></li>
                                                        <li value="5">Select <span class="uicontrol">Enable Exchange ActiveSync</span>.</li>
                                                        <li value="6">Enter a <span class="uicontrol">Profile name</span>.</li>
                                                        <li value="7">Select <span class="uicontrol">Enable certificate-based authentication for iOS</span>.</li>
                                                        <li value="8">Click <span class="uicontrol">Download root certificate</span>.
									</li>
                                                        <li value="9">For use later in this procedure, copy and paste the <span class="uicontrol">Certificate Revocation List URL</span> and the <span class="uicontrol">Delta Certificate Revocation List URL</span> into a text editor.
							<p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/eas_cba_o365_clr-drl.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="341" data-mc-height="124" src="../../resources/images/eas_cba_o365_clr-drl_thumb_220_220.png" tabindex="" /></a></p><div class="note_cautionOkta"><p class="noteContent"><a name="Stop_dontclicksave"></a>Do not click <span class="uicontrol">Save</span> yet. You'll save these settings in <a href="#Step3">Step 3: Distribute certificates for EAS to OMM-enrolled devices</a> after you complete the PowerShell actions detailed in <a href="#Step2">Step 2: Enable Exchange ActiveSync certificate-based authentication in Office 365</a>. If you save  now and then encounter a problem when enabling Exchange ActiveSync Cert Based Authentication in Office 365, your users may not be able to access their mail app.</p></div></li>
                                                    </ol>
                                                    <div class="noteOkta">
                                                        <p class="noteContent">Tell your end users how the above configuration may affect their device and mail account. See <a href="#KnownIssues">Known issues</a>.</p>
                                                    </div>
                                                    <h3><a name="Step2"></a>Step 2. Enable Exchange ActiveSync certificate-based authentication in Office 365</h3>
                                                    <p><a name="FromWinCLI"></a>From a Windows command line, do the following:</p>
                                                    <ol>
                                                        <li value="1"><a name="Launch"></a>Launch Azure PowerShell 5.0 (64-bit) as an Administrator.
						
						
								
										
										
										
										
										
									<div class="noteOkta"><p class="noteContent">An error message appears if you try to use the x86 (32-bit) version of PowerShell.</p></div></li>
                                                        <li value="2">
                                                            <p>Issue the following command to install the AzureAD module for PowerShell:</p>
                                                            <p><span class="code">Install-Module -Name AzureAD –RequiredVersion 2.0.0.33</span>
                                                            </p>
                                                            <ul>
                                                                <li>If the message "NuGet provider is required to continue" appears, click <span class="uicontrol">Yes</span> to install and import NuGet provider.</li>
                                                                <li>If the message "Untrusted repository" appears, click <span class="uicontrol">Yes to All</span> to install the required modules.</li>
                                                            </ul>
                                                        </li>
                                                        <li value="3">In PowerShell, issue the following command to connect to your Azure AD tenant and authenticate to Office 365:
						
						
									<p><span class="code">Connect-AzureAD</span></p></li>
                                                        <li value="4">
                                                            <p>Enter your Office 365 credentials in the <span class="wintitle">Azure Active Directory</span> sign-in screen.</p>
                                                        </li>
                                                        <li value="5">To create the necessary PowerShell variables, issue the following commands in PowerShell:
								
								
								
									<p><span class="code">$cert=Get-Content -Encoding byte "LOCATION OF YOUR CER FILE\filename.cer"</span></p><p>Make sure to replace <span class="code">LOCATION OF YOUR CER FILE\filename.cer</span> with the path and filename of your <span class="code">*.cer</span> file.</p><p><span class="code">$new_ca=New-Object -TypeName Microsoft.Open.AzureAD.Model.CertificateAuthorityInformation</span></p><p><span class="code">$new_ca.AuthorityType=0</span></p><p><span class="code">$new_ca.TrustedCertificate=$cert</span></p></li>
                                                        <li value="6">To enable certificate revocation in Office 365, issue the following commands, making sure to paste the revocation URLs that you saved earlier: <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/eas_cba_o365_clr-drl.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="341" data-mc-height="124" src="../../resources/images/eas_cba_o365_clr-drl_thumb_220_220.png" tabindex="" /></a></p><p><span class="code">$new_ca.crlDistributionPoint = "CERTIFICATE REVOCATION LIST URL"</span></p><p>Replace <span class="code">CERTIFICATE REVOCATION LIST URL</span> with the <span class="uicontrol">Certificate Revocation list URL</span> that you saved earlier.</p><p><span class="code">$new_ca.deltaCrlDistributionPoint = "DELTA CERTIFICATE REVOCATION LIST URL"</span></p><p>Replace <span class="code">DELTA CERTIFICATE REVOCATION LIST URL</span> with the <span class="uicontrol">Delta Certificate Revocation list URL</span> that you saved earlier.</p></li>
                                                        <li value="7">To add the appropriate certificate authority in Office 365, issue the following command:
									<p><span class="code">New-AzureADTrustedCertificateAuthority -CertificateAuthorityInformation $new_ca</span></p></li>
                                                        <li value="8">To confirm that the certificate authority was added to Office 365, issue the following command:
					
									<p><span class="code">Get-AzureADTrustedCertificateAuthority</span></p><p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/eas_cert_install_cli.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="970" data-mc-height="395" src="../../resources/images/eas_cert_install_cli_thumb_220_220.png" tabindex="" /></a></p></li>
                                                        <li value="9">Optional. Issue the following commands to help troubleshoot your configuration, if necessary:
							<ul><li><p>If you want to add the existing Certificate Authorities to a variable:</p><p><span class="code">$c=Get-AzureADTrustedCertificateAuthority</span></p></li><li><p>If you want to remove a Certificate Authority, issue the following command and choose the correct certificate. Numbering begins at <span class="code">0</span> (zero). For example, to remove the first certificate, enter <span class="code">0</span> as shown below:</p><p><span class="code">Remove-AzureADTrustedCertificateAuthority -CertificateAuthorityInformation $c[0]</span></p></li></ul></li>
                                                    </ol>
                                                    <div class="noteOkta">
                                                        <p class="noteContent">Tell your end users how the above configuration may affect their device and mail account. See <a href="#KnownIssues">Known issues</a>.</p>
                                                    </div>
                                                    <h3><a name="Step3"></a>Step 3. Distribute certificates for EAS to OMM-enrolled devices</h3>
                                                    <ol>
                                                        <li value="1">Make sure to advise your end users to remove any <a href="#KnownIssues">manually-configured EAS profiles</a> that may be installed on their device.</li>
                                                        <li value="2">In the Okta Admin Console, return to the <span class="uicontrol">Exchange ActiveSync Settings</span> dialog box and click <span class="uicontrol">Save</span>.</li>
                                                        <li value="3">Click <span class="uicontrol">Save</span> in the <span class="uicontrol">Confirm Exchange ActiveSync</span> changes message.</li>
                                                    </ol>
                                                    <h3><a name="Step4"></a>Step 4. Optional. Prevent unmanaged devices from accessing Office 365 email using the iOS Mail app (EAS)</h3>
                                                    <div class="noteOkta">
                                                        <p class="noteContent">Only configure Step 4 if your users have been notified to enroll in Okta Mobility Management.</p>
                                                    </div>
                                                    <ol>
                                                        <li value="1">Configure the Office 365 client access policy:								
				<li>In the <span class="mc-variable okta-feature-names.Administrator_dashboard variable">Admin Console</span>, go to <span class="menucascade"><span class="uicontrol">Applications</span><span class="uicontrol">Applications</span></span>. </li><li>Click the Office 365 app instance</li><li>Click the <span class="wintitle">Sign On</span> tab, scroll down to the <span class="wintitle">Sign On Policy</span>, and click <span class="uicontrol">Add Rule</span>.</li><li>Enter a name for the rule and apply it to the appropriate group or users.</li><li>In the <span class="wintitle">Client</span> section, select <span class="uicontrol">Mobile (Exchange ActiveSync)</span> and <span class="uicontrol">iOS</span>.</li><div class="noteOkta"><p class="noteContent">Make sure the other options  are not selected.</p></div><p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../resources/images/clientaccesspolicies_dt_eas_ios.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="605" data-mc-height="422" src="../../resources/images/clientaccesspolicies_dt_eas_ios_thumb_220_220.png" tabindex="" /></a></p><ol style="list-style-type: lower-alpha;"><li value="1">In the <span class="wintitle">Actions</span> section, for <span class="uicontrol">When all the conditions above are met, sign on to this application is</span>, select <span class="uicontrol">Denied</span>.
									</li><li value="2">
										Click <span class="uicontrol">Save</span>.
							</li></ol></li>
                                                        <li value="2">
								Using an OMM-enrolled iOS device, verify the <span class="mc-variable okta-feature-names.Device_Trust variable">Device Trust</span> configuration:
								<ol style="list-style-type: lower-alpha;"><li value="1">
										Ensure that the OMM-enrolled iOS device is covered by an appropriate Okta mobile policy.
									</li><li value="2">
										Launch the native iOS mail app and confirm that email works without the need to authenticate to Office 365.
									</li><li value="3">
										Manually create an EAS mail account on the native iOS mail app to confirm that Okta is blocking manually-configured email accounts.
							</li></ol></li>
                                                    </ol>
                                                    <h3>Known issues<a name="KnownIssues"></a></h3>
                                                    <ul>
                                                        <li>Continuous password prompt caused by duplicate EAS profiles — iOS 9.3 and iOS 10.2 device users who manually configure the native iOS mail app before enrolling in OMM will have duplicate EAS profiles on their device after OMM enrollment pushes a certificate-based profile to their device automatically. On <span class="uicontrol">iOS 9.3</span> devices, this duplication may cause confusion. On <span class="uicontrol">iOS 10.2</span> devices, in addition to the profile duplication issue, the manually-configured profile doesn't receive email and continuously prompts for a password. To address these issues, we recommend that you advise your users to delete the manually-configured profile from their device. Otherwise, the password prompt appears continuously.</li>
                                                        <li>Currently, this feature supports only the native iOS mail app on iOS devices.</li>
                                                        <li>
                                                            <p>Users may be prompted for credentials — If you unassign and then reassign a CBA-configured Office 365 app instance to users or groups, users trying to access the EAS-enabled native iOS mail client are prompted to enter their credentials. Even after entering credentials, users still receive the message "Cannot Get Mail". Users may need to wait up to several hours before they can access email.</p>
                                                        </li>
                                                        <li>Block access to Outlook for iOS or Android — If you don't want your end users to access Outlook for iOS or Android, you can block access as described in the Microsoft article <a href="https://technet.microsoft.com/en-us/library/mt465747(v=exchg.150).aspx">Enabling Outlook for iOS and Android in Exchange Online</a>. Scroll down to <span class="wintitle" style="font-weight: normal;">Blocking Outlook for iOS and Android</span>.</li>
                                                        <li>
                                                            <p>CRL cache must refresh — When Okta revokes a certificate, or if the trusted root CA certificate is removed from Exchange Online/O365/Azure AD, CBA EAS-enabled devices using the certificate can still access email until the next time Office 365 invalidates the Certificate Revocation List (CRL) cache and refreshes the CRL. When the cache is refreshed, Microsoft denies the device access to email. Microsoft cache expires once every 24 hours, or whenever the device switches to a different Wi-Fi network.</p>
                                                        </li>
                                                        <li>More than one OS type in the header when using the Outlook mail app — When Okta receives a request from the Outlook Mail app on iOS and Android devices, the header contains both iOS and Android, which prevents Okta from precisely identifying the OS type. To ensure that the client access policy is applied in this case, select the <span class="uicontrol">Others</span> option in the Mobile (Exchange ActiveSync<span class="uicontrol">)</span> client access policy. For more information, see <a href="https://support.okta.com/help/Documentation/Knowledge_Article/Getting-Started-with-Office-365-Client-Access-Policies#ClientAccessPolicies">Configuring Rules for Office 365 Client Access Policies</a>.</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- div class="toolbar-main">
            <MadCap:topicToolbarProxy data-mc-skin="/Project/Skins/okta-toolbar-no-expand.flskn" style="mc-topic-toolbar-items: ;" />
                </div -->
                                    <!-- *********************** Footer rows ********************************* -->
                                    <div class="footer2" data-test="footer">
                                        <div>
                                            <p class="copyright" data-test="copyrightNotice">©  <span class="mc-variable okta-variables.Year variable">2023</span> <span class="mc-variable okta-variables.CompanyName variable">Okta, Inc</span>. All Rights Reserved. Various trademarks held by their respective owners.
	</p>
                                        </div>
                                    </div>
                                    <!-- ********************** Scripts ************************************* -->
                                    <script src="../../resources/scripts/js/ignore-dompurify.js">
                                    </script>
                                    <script src="../../resources/scripts/js/app.js">
                                    </script>
                                    <script src="../../resources/scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/coveo.madcapflare.requirejs.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../resources/scripts/coveo-resources/js/coveo.madcapflare.okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                    <!-- Feedback tab for Qualtrics survey -->
                                    <div id="feedback-tab" data-mc-conditions="Primary.live-site-only"><a id="feedback-link" href="#" onclick="openSurvey();  return false" target="_blank" title="Submit feedback"><div id="feedback-container"><p id="feedback-text" translate="no">Feedback</p></div></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
