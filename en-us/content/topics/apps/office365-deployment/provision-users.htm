<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_nav_poc" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="App integrations|[%=System.LinkedHeader%]|Microsoft Azure AD and Office 365|[%=System.LinkedHeader%]|Deploy Office 365" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="Explains different provisioning types and how to configure them." />
        <meta name="viewport" content="width=device-width, height=device-height" /><title>Provision users to Office 365 | Okta</title>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <link rel="shortcut icon" href="../../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Pendo Script (Per Chris Bank) -->
        <!-- End Pendo Script -->
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/print.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../resources/stylesheets/okta-main-new-nav.css" rel="stylesheet" type="text/css" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-NMZZV4P');
			/* ]]> */
		</script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KXMLV58');
			/* ]]> */
		</script>
        <script>
		/* <![CDATA[ */
		(function(apiKey){
			(function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
			v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
			o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
			y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
			z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id:              'VISITOR-UNIQUE-ID'
            },
            account: {
                id:           'ACCOUNT-UNIQUE-ID'
            }
        });
		})('a9bd3885-93ae-46ab-700b-dd29e613c19d');
		/* ]]> */
        function openSurvey() {
            window.open('https://surveys.okta.com/jfe/form/SV_e4L0iW8a3tz8Yol?source=' + encodeURIComponent(document.location.href), '_blank');
        }
		</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1024px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMZZV4P" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.OrgId variable">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="mc-variable okta-coveo-config.PlatformRestUri variable">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchPageUrl variable">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchTokenServiceUrl variable">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <div id="coveo_dev_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.DevOrgId variable">oktanonproduction1il1gtac7</span>
                                    </div>
                                    <div id="coveo_dev_token" style="Display:None"><span class="mc-variable okta-coveo-config.DevSearchToken variable">xxf1de37f5-c8aa-42db-a8ef-0cbf06dfa5e3</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************** Coveo Search bar ************************************* -->
                                    <!-- set margin and size in /Content/Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css to make room for replacing Flare-generated top-nav with HTML code (see below)-->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper" data-mc-conditions="MultiProdPublish.SearchBar">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="replace_top_nav">
                                        <div class="navbar" data-mc-conditions="Primary.live-site-only">
                                            <div class="dropdown" data-test="menuBarCategory" id="documentationMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">Documentation <em class="fa fa-caret-down"></em></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=oie-index" data-test="menuBarLink">Identity Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?id=index-admin" data-test="menuBarLink">Classic Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oag&amp;id=ext_oag_main" data-test="menuBarLink">Access Gateway</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=asa&amp;id=csh-asa-overview" data-test="menuBarLink">Advanced Server Access</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=wf&amp;id=ext-Okta-workflows" data-test="menuBarLink">Workflows</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="relnotesMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">Release notes <em class="fa fa-caret-down"></em></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oie&amp;id=csh-oie-release-notes" data-test="menuBarLink">Identity Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?id=ext_okta_relnotes" data-test="menuBarLink">Classic Engine</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=oag&amp;id=ext_oag_releasenotes" data-test="menuBarLink">Access Gateway</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=asa&amp;id=ext-asa-releasenotes" data-test="menuBarLink">Advanced Server Access</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/okta_help.htm?type=wf&amp;id=ext-workflows-releasenotes" data-test="menuBarLink">Workflows</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="oktaDevDocsMenu"><a href="https://developer.okta.com/" target="_blank" data-test="menuBarLink">Okta Developer</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="auth0Menu"><a href="https://auth0.com/docs" target="_blank" data-test="menuBarLink">Auth0</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="trainingMenu"><a href="https://www.okta.com/services/training/" target="_blank" data-test="menuBarLink">Training</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="supportMenu"><a href="https://support.okta.com/help/s/?language=en_US" target="_blank" data-test="menuBarLink">Support</a>
                                            </div>
                                        </div>
                                        <div class="logo_container" id="OktaBanner" data-mc-conditions="Primary.live-site-only"><a class="logo" href="https://help.okta.com/okta_help.htm?id=csh-index" data-test="OktaBanner"><img src="../../../resources/images/okta-assets/logo.png" alt="Okta Docs" title="Okta Docs" data-test="OktaBannerImg" /></a>
                                        </div>
                                        <div class="toolbar-main" data-test="toolBar" data-mc-conditions="Primary.live-site-only">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_no_expand mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie select-language-button" title="Change language">
                                                        <div>
                                                            <div role="img" class="button-icon-wrapper" aria-label="Change language">
                                                                <div class="button-icon"> </div>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics" data-test="bodyWrapper">
                                        <!-- *** Col1: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                                <div class="nocontent">
                                                    <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider="  &gt;  " data-mc-breadcrumbs-count="3" data-mc-toc="True">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="oie-label" data-mc-conditions="MultiProdPublish.Classic">
                                                <img class="oie-label" title="Label: Okta Classic Engine content" src="../../../resources/images/okta-assets/classic_engine.svg" />
                                            </div>
                                            <div class="body-main" data-test="bodyContent">
                                                <!-- Main content body -->
                                                <div role="main" id="mc-main-content">
                                                    <h1>Provision users to Office 365</h1>
                                                    <p>You can create, update, deprovision, and sync users in <span class="mc-variable Mobile.O365 variable">Office 365</span> from your Okta org. You can import users from different source directories into Okta and provision them in <span class="mc-variable Mobile.O365 variable">Office 365</span> using profile mappings.</p>
                                                    <h2>Before you begin
        </h2>
                                                    <ul>
                                                        <li>Complete <a href="configure-sso.htm" class="MCXref xref">Configure Single Sign-On for Office 365</a>.</li>
                                                        <li>Disable the Microsoft MFA for the <span class="mc-variable Mobile.O365 variable">Office 365</span> admin account that you're using for WS-Federation. If the MFA is enabled, it can break provisioning and single sign-on setups in Okta.</li>
                                                        <li>
                                                            <p><span class="uicontrol">Bring users into Okta</span>: You can import users from a directory such as <span class="mc-variable _3rd_Party_Integrations.AD variable">Active Directory</span> (AD) or an app such as <span class="mc-variable workflows_connectors.Salesforce variable">Salesforce</span>. Currently, <span class="mc-variable okta-variables.ProductName variable">Okta</span> doesn't support imports that take longer than two hours to complete. <a href="https://support.okta.com/help/s/opencase">Contact Support</a> if you have this type of import. You can also create users directly in Okta. See the following  for more information:</p>
                                                            <ul>
                                                                <li><a href="../../directory/ad-agent-manage-users-groups.htm" class="MCXref xref">Manage Active Directory users and groups</a>
                                                                </li>
                                                                <li><a href="../../users-groups-profiles/usgp-import-users-main.htm" class="MCXref xref">Import users</a>
                                                                </li>
                                                                <li><a href="../../users-groups-profiles/usgp-add-users.htm" class="MCXref xref">Add users manually</a>
                                                                </li>
                                                            </ul>
                                                        </li>
                                                        <li>
                                                            <p>Decide the type of provisioning, depending on your provisioning needs. See <a href="../office365/references/provisioning-types.htm" class="MCXref xref">Provisioning options for Office 365</a>.</p>
                                                        </li>
                                                        <li>
                                                            <p>Ensure you have a Global administrator account in <span class="mc-variable _3rd_Party_Integrations.Microsoft variable">Microsoft</span> and an App administrator account in Okta tenant.</p>
                                                        </li>
                                                    </ul>
                                                    <h2>Start this procedure</h2>
                                                    <p>To provision users in <span class="mc-variable Mobile.O365 variable">Office 365</span>, you need to perform the following tasks in order:</p>
                                                    <ol>
                                                        <li value="1">
                                                            <p><a href="#1." class="MCXref xref">Set up Okta to Office 365 provisioning</a>
                                                            </p>
                                                        </li>
                                                        <li value="2">
                                                            <p><a href="#2." class="MCXref xref">Map profile attributes Okta to Office 365</a>
                                                            </p>
                                                        </li>
                                                        <li value="3">
                                                            <p><a href="#3." class="MCXref xref">Test provisioning</a>
                                                            </p>
                                                        </li>
                                                    </ol>
                                                    <h3><a name="1."></a>Set up Okta to <span class="mc-variable Mobile.O365 variable">Office 365</span> provisioning</h3>
                                                    <p>You can automate provisioning tasks by enabling API integration, obtaining admin consent for user import and provisioning, and configuring settings for user lifecycle stages.</p>
                                                    <h4>Enable API integration</h4>
                                                    <p><span class="mc-variable Mobile.O365 variable">Office 365</span> requires your consent to authenticate against the <span class="mc-variable _3rd_Party_Integrations.Microsoft variable">Microsoft</span> API. This allows Okta to enable provisioning in <span class="mc-variable Mobile.O365 variable">Office 365</span> applications.</p>
                                                    <ol>
                                                        <li value="1">Go to <span class="menucascade"><span class="uicontrol">Office 365</span><span class="uicontrol">Provisioning</span><span class="uicontrol">Integration</span><span class="uicontrol">Configure API Integration</span></span>.</li>
                                                        <li value="2">Check <span class="uicontrol">Enable API Integration</span>.</li>
                                                        <li value="3">
                                                            <p>Click <span class="uicontrol">Authenticate with Microsoft Office 365</span> to provide consent. You're redirected to the <span class="mc-variable _3rd_Party_Integrations.Microsoft variable">Microsoft</span> <span class="mc-variable _3rd_Party_Integrations.Microsoft_Azure variable">Azure</span> login page.</p>
                                                        </li>
                                                        <li value="4">Click <span class="uicontrol">Accept</span>. Upon accepting the scopes in the <span class="mc-variable _3rd_Party_Integrations.Microsoft variable">Microsoft</span> <span class="mc-variable _3rd_Party_Integrations.Microsoft_Azure variable">Azure</span> portal, you're redirected back to Okta.</li>
                                                    </ol>
                                                    <h4>Select provisioning type and settings</h4>
                                                    <p>The provisioning options depend on the provisioning type that you select. <span class="uicontrol">Profile Sync</span> is selected by default.</p>
                                                    <ol>
                                                        <li value="1">Go to <span class="menucascade"><span class="uicontrol">Office 365</span><span class="uicontrol">Provisioning</span><span class="uicontrol">To App</span><span class="uicontrol">Edit</span></span>.</li>
                                                        <li value="2">
                                                            <p>Select <span class="uicontrol">Office 365 Provisioning Type</span>. </p>
                                                            <p>You can change the provisioning type from <span class="uicontrol">Profile Sync</span> to <span class="uicontrol">Licenses &amp; Role Management</span>, <span class="uicontrol">Universal</span>, or <span class="uicontrol">User Sync</span>. See <a href="../office365/references/provisioning-types.htm" class="MCXref xref">Provisioning options for Office 365</a>.</p>
                                                            <p>For <span class="uicontrol">Universal Sync</span> only: Select <span class="uicontrol">Send full profile, contacts, and conference rooms from these AD instances</span> if you want to sync <span class="mc-variable _3rd_Party_Integrations.AD variable">Active Directory</span> groups and resources.</p>
                                                            <div class="noteOkta">
                                                                <img src="../../../resources/images/assets/icons/notes/help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                                <p class="noteContent">A service account is created with username <span class="code">vc_OKTA_sync_{appId}</span> format in <span class="mc-variable _3rd_Party_Integrations.AAD variable">Azure Active Directory</span>. Don't delete this account or add or remove any roles from it.</p>
                                                            </div>
                                                        </li>
                                                        <li value="3" data-mc-conditions="MultiProdPublish.Classic">Enable or disable other provisioning settings. See <a href="../apps_okta_enhancements_office_365_integration.htm" class="MCXref xref">Get started with Office 365 provisioning and deprovisioning</a>.</li>
                                                        <li value="4">Click <span class="uicontrol">Save</span>.</li>
                                                    </ol>
                                                    <div class="noteOkta">
                                                        <img src="../../../resources/images/assets/icons/notes/help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                        <p class="noteContent">Each user provisioned for <span class="mc-variable Mobile.O365 variable">Office 365</span> has an attribute, <span class="code">StsRefreshTokensValidFrom</span>, which is a date that invalidates existing user sessions and refresh tokens when users change their password, requiring the user to sign in to their apps again. This attribute is automatically calculated and populated based on the provisioning type.</p>
                                                        <ul>
                                                            <li>
                                                                <p><span class="uicontrol">License Only</span> or <span class="uicontrol">Profile Sync</span>: The <span class="code">StsRefreshTokensValidFrom</span> attribute is set to the current date and time when the user changes their password in Okta.</p>
                                                            </li>
                                                            <li>
                                                                <p><span class="uicontrol">User Sync</span> or <span class="uicontrol">Universal Sync</span>: If the user is linked from <span class="mc-variable _3rd_Party_Integrations.AD variable">Active Directory</span> (AD), the <span class="code">StsRefreshTokensValidFrom</span> attribute is set to the <span class="code">pwdLastSet </span>attribute in AD. For all other users, the <span class="code">StsRefreshTokensValidFrom</span> attribute is set to the current date and time when the user changes their password in Okta.</p>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <h3><a name="2."></a>Map profile attributes Okta to <span class="mc-variable Mobile.O365 variable">Office 365</span></h3>
                                                    <p>Depending on where your users are sourced from, the username format can vary. For users to successfully sign in to <span class="mc-variable Mobile.O365 variable">Office 365</span>, their username for <span class="mc-variable Mobile.O365 variable">Office 365</span> must be in an email address format for the domain you're federating (<span class="userinput">username@yourfederated.domain</span>).</p>
                                                    <div class="noteOkta">
                                                        <img src="../../../resources/images/assets/icons/notes/help.png" class="noteImgFloat" title="Important Note" alt="Important Note" />
                                                        <p class="noteContent">You must remap attributes whenever you make any changes to provisioning settings.</p>
                                                    </div>
                                                    <h4>Map username unchanged</h4>
                                                    <p>If your users already have their username in an email address format for the domain you're federating (<span class="userinput">username@yourfederated.domain</span>) format, you can map the email without reformatting.</p>
                                                    <p data-mc-conditions="MultiProdPublish.Classic"><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../resources/images/office365/o365-username-email.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="525" data-mc-height="122" src="../../../resources/images/office365/o365-username-email_thumb_220_220.png" tabindex="" /></a>
                                                    </p>
                                                    <ol>
                                                        <li value="1">Go to <span class="menucascade"><span class="uicontrol">Office 365 Sign on</span><span class="uicontrol">Edit</span></span>.</li>
                                                        <li value="2">In <span class="menucascade"><span class="uicontrol">Credentials Details</span><span class="uicontrol">Application username format</span></span>, select <span class="uicontrol">Email</span>.</li>
                                                        <li value="3">Click <span class="uicontrol">Save</span>.</li>
                                                    </ol>
                                                    <h4>Map custom username</h4>
                                                    <p>If your users are sourced from different directories or apps, their username format may vary. You can use the <span class="mc-variable okta-feature-names.Okta_EL variable">Okta Expression Language</span> to customize the username that is passed on to <span class="mc-variable Mobile.O365 variable">Office 365</span>.</p>
                                                    <div data-mc-conditions="MultiProdPublish.Classic">
                                                        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../resources/images/office365/o365-username-custom.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="694" data-mc-height="240" src="../../../resources/images/office365/o365-username-custom_thumb_220_220.png" tabindex="" /></a>
                                                        </p>
                                                        <ol>
                                                            <li value="1">Go to <span class="menucascade"><span class="uicontrol">Office 365</span><span class="uicontrol">Sign on</span><span class="uicontrol">Edit</span></span>.</li>
                                                            <li value="2">In <span class="menucascade"><span class="uicontrol">Credentials Details</span><span class="uicontrol">Application username format</span></span>, select <span class="uicontrol">Custom</span>.<p>Enter this expression in the provided text box:</p><span class="userinput">String.substringBefore(user.email, "@") + "@yourfederated.domain"</span></li>
                                                            <li value="3">Replace <span class="url">yourfederated.domain</span> with the domain that you're federating.</li>
                                                            <li value="4">Enter an Okta user in the <span class="uicontrol">Preview</span> box to check the result of the mapping.</li>
                                                            <li value="5">The resulting username should match the <span class="mc-variable Mobile.O365 variable">Office 365</span> username for the user.</li>
                                                            <li value="6">Click <span class="uicontrol">Save</span>.</li>
                                                        </ol>
                                                    </div>
                                                    <h4>Map email address</h4>
                                                    <p>If your users' email addresses don't reside in the domain you're federating, you can use the <span class="mc-variable okta-variables.ProductName variable">Okta</span> Expression Language to customize the email address that's passed to <span class="mc-variable Mobile.O365 variable">Office 365</span>.</p>
                                                    <p style="font-weight: bold;">Prerequisite</p>
                                                    <p>Provisioning type should be selected to <span class="uicontrol">User Sync</span> or <span class="uicontrol">Universal Sync</span>. See <a href="../office365/references/provisioning-types.htm" class="MCXref xref">Provisioning options for Office 365</a>.</p>
                                                    <div data-mc-conditions="MultiProdPublish.Classic">
                                                        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../resources/images/office365/o365-profile-editor-email-custom.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1002" data-mc-height="566" src="../../../resources/images/office365/o365-profile-editor-email-custom_thumb_220_220.png" tabindex="" /></a>
                                                        </p>
                                                        <ol>
                                                            <li value="1">Go to <span class="menucascade"><span class="uicontrol">Directory</span><span class="uicontrol">Profile Editor</span><span class="uicontrol">Microsoft Office 365 Mappings</span><span class="uicontrol">Okta to Microsoft Office 365</span></span>. </li>
                                                            <li value="2">In the <span class="uicontrol">source.email</span> field, enter this expression:<br /><span class="userinput">String.substringBefore(user.email, "@") + "@yourfederated.domain"</span></li>
                                                            <li value="3">Replace <span class="userinput">yourfederated.domain</span> with the domain that you're federating.</li>
                                                            <li value="4">Enter an <span class="mc-variable okta-variables.ProductName variable">Okta</span> user in the <span class="uicontrol">Preview</span> box to check the result of the mapping.</li>
                                                            <li value="5">The resulting email address should match the <span class="mc-variable Mobile.O365 variable">Office 365</span> email address for the user.</li>
                                                            <li value="6">Exit <span class="uicontrol">Preview</span> and save mappings.</li>
                                                            <li value="7">Click <span class="uicontrol">Apply Updates Now</span>.</li>
                                                        </ol>
                                                    </div>
                                                    <h3><a name="3."></a>Test provisioning</h3>
                                                    <p>Ensure you have correctly configured provisioning by assigning <span class="mc-variable Mobile.O365 variable">Office 365</span> to test users in Okta and verifying they appear in your <span class="mc-variable _3rd_Party_Integrations.Microsoft variable">Microsoft</span> tenant. Be sure that you've selected the <span class="uicontrol">Create Users</span> option in <span class="wintitle">Provisioning</span>.</p>
                                                    <p>In Okta:</p>
                                                    <ol>
                                                        <li value="1">Open the <span class="uicontrol">Assignment</span> tab of the <span class="mc-variable _3rd_Party_Integrations.Microsoft variable">Microsoft</span> <span class="mc-variable Mobile.O365 variable">Office 365</span> app.</li>
                                                        <li value="2">Click <span class="uicontrol">Assign</span>.</li>
                                                        <li value="3">Assign appropriate <span class="mc-variable Mobile.O365 variable">Office 365</span> licenses to test users.</li>
                                                        <li value="4">Click <span class="uicontrol">Done</span>.</li>
                                                    </ol>
                                                    <p>In the <span class="mc-variable _3rd_Party_Integrations.Microsoft variable">Microsoft</span> Admin center:</p>
                                                    <ol>
                                                        <li value="1">Open the list of <span class="wintitle">Active Users</span>.</li>
                                                        <li value="2">Ensure that all test users appear in the list with appropriate licenses.</li>
                                                    </ol>
                                                    <p>In Okta:</p>
                                                    <ol>
                                                        <li value="1">Log into Okta as a test user.</li>
                                                        <li value="2">Ensure that all <span class="mc-variable Mobile.O365 variable">Office 365</span> apps appear on the user dashboard.</li>
                                                    </ol>
                                                    <div class="noteOkta">
                                                        <img src="../../../resources/images/assets/icons/notes/help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                        <p class="noteContent">
            If you've selected the <span class="uicontrol">User Sync</span> or <span class="uicontrol">Universal Sync</span> provisioning type, all users appear as <span class="uicontrol">Synced with Active Directory</span> in the <span class="mc-variable Mobile.O365 variable">Office 365</span> tenant, irrespective of where their profile is sourced. However, individual users are still sourced from their respective directories.</p>
                                                    </div>
                                                    <h2><span>Next step</span>
                                                    </h2>
                                                    <p><a href="assign-o365.htm" class="MCXref xref">Assign Office 365 to users and groups</a>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- div class="toolbar-main">
            <MadCap:topicToolbarProxy data-mc-skin="/Project/Skins/okta-toolbar-no-expand.flskn" style="mc-topic-toolbar-items: ;" />
                </div -->
                                    <!-- *********************** Footer rows ********************************* -->
                                    <div class="footer2" data-test="footer">
                                        <div>
                                            <p class="copyright" data-test="copyrightNotice">  <span class="mc-variable okta-variables.Year variable">2024</span> <span class="mc-variable okta-variables.CompanyName variable">Okta, Inc</span>. All Rights Reserved. Various trademarks held by their respective owners.
	</p>
                                        </div>
                                    </div>
                                    <!-- ********************** Scripts ************************************* -->
                                    <script src="../../../resources/scripts/js/ignore-dompurify.js">
                                    </script>
                                    <script src="../../../resources/scripts/js/app.js">
                                    </script>
                                    <script src="../../../resources/scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../../resources/scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../../resources/scripts/coveo-resources/js/coveo.madcapflare.requirejs.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../../resources/scripts/coveo-resources/js/coveo.madcapflare.okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                    <!-- Feedback tab for Qualtrics survey -->
                                    <div id="feedback-tab" data-mc-conditions="Primary.live-site-only"><a id="feedback-link" href="#" onclick="openSurvey();  return false" target="_blank" title="Submit feedback"><div id="feedback-container"><p id="feedback-text" translate="no">Feedback</p></div></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
