<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_nav_poc" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="App integrations|[%=System.LinkedHeader%]|Microsoft Azure AD and Office 365|[%=System.LinkedHeader%]|[%=System.LinkedHeader%]" data-mc-conditions="MultiProdPublish.Classic" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Migrate registry-key-based Office 365 Silent Activation to new configuration</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Pendo Script (Per Chris Bank) -->
        <!-- End Pendo Script -->
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/stylesheets/mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <link href="../../../resources/stylesheets/okta-main-new-nav.css" rel="stylesheet" type="text/css" />
        <link href="../../../resources/tablestyles/standard.css" rel="stylesheet" data-mc-stylesheet-type="table" />
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-NMZZV4P');
			/* ]]> */
		</script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KXMLV58');
			/* ]]> */
		</script>
        <script>
		/* <![CDATA[ */
		(function(apiKey){
			(function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
			v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
			o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
			y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
			z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id:              'VISITOR-UNIQUE-ID'
            },
            account: {
                id:           'ACCOUNT-UNIQUE-ID'
            }
        });
		})('a9bd3885-93ae-46ab-700b-dd29e613c19d');
		/* ]]> */
        function openSurvey() {
            window.open('https://surveys.okta.com/jfe/form/SV_e4L0iW8a3tz8Yol?source=' + encodeURIComponent(document.location.href), '_blank');
        }
		</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1024px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMZZV4P" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.OrgId variable">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="mc-variable okta-coveo-config.PlatformRestUri variable">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchPageUrl variable">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchTokenServiceUrl variable">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <div id="coveo_dev_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.DevOrgId variable">oktanonproduction1il1gtac7</span>
                                    </div>
                                    <div id="coveo_dev_token" style="Display:None"><span class="mc-variable okta-coveo-config.DevSearchToken variable">xxb48840fe-d60d-4e40-b1d3-522d5a35c384</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************** Coveo Search bar ************************************* -->
                                    <!-- set margin and size in /Content/Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css to make room for replacing Flare-generated top-nav with HTML code (see below)-->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper" data-mc-conditions="MultiProdPublish.SearchBar">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="replace_top_nav">
                                        <div class="navbar" data-mc-conditions="Primary.live-site-only">
                                            <div class="dropdown" data-test="menuBarCategory" id="documentationMenu" data-mc-conditions="MultiProdPublish.DocMenu">
                                                <button class="dropbtn">Documentation <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://help.okta.com/en-us/Content/index.htm" data-test="menuBarLink">Product documentation</a>
                                                    </div>
                                                    <div><a href="https://developer.okta.com" target="_blank" data-test="menuBarLink">Developer documentation</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="knowledgebaseMenu"><a href="https://support.okta.com/help/s/knowledge?language=en_US" data-test="menuBarLink">Knowledge base</a>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="communityMenu">
                                                <button class="dropbtn">Community <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://support.okta.com/help/s/community?language=en_US" data-test="menuBarLink">Home</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/group/CollaborationGroup/Recent?language=en_US" data-test="menuBarLink">Discussions</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/questions?language=en_US" data-test="menuBarLink">Questions</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/ideas?language=en_US" target="_blank" data-test="menuBarLink">Ideas</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/events?language=en_US" data-test="menuBarLink">Webinars</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/blogs?language=en_US" data-test="menuBarLink">Blogs</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="productMenu">
                                                <button class="dropbtn">Product <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content" data-test="menuBarItems">
                                                    <div><a href="https://support.okta.com/help/s/productroadmap?language=en_US" data-test="menuBarLink">Roadmap</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/product-hub?language=en_US" data-test="menuBarLink">Product hub</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/mysuccesshub/get-started?language=en_US" data-test="menuBarLink">Customer success hub</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown" data-test="menuBarCategory" id="trainingMenu"><a href="https://www.okta.com/services/education-services/" target="_blank" data-test="menuBarLink">Training</a>
                                            </div>
                                        </div>
                                        <div class="logo_container" id="OktaBanner" data-mc-conditions="Primary.live-site-only"><a class="logo" href="https://help.okta.com" data-test="OktaBanner"><img src="../../../resources/images/okta-assets/logo.png" alt="Okta Support" title="Okta Support" data-test="OktaBannerImg" /></a>
                                        </div>
                                        <div class="toolbar-main" data-test="toolBar" data-mc-conditions="Primary.live-site-only">
                                            <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_no_expand mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                <div class="button-group-container-left">
                                                    <button class="button needs-pie select-language-button" title="Change language">
                                                        <div>
                                                            <div role="img" class="button-icon-wrapper" aria-label="Change language">
                                                                <div class="button-icon"> </div>
                                                            </div>
                                                        </div>
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics" data-test="bodyWrapper">
                                        <!-- *** Col1: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                                <div class="nocontent">
                                                    <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider="  &gt;  " data-mc-breadcrumbs-count="3" data-mc-toc="True">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="oie-label" data-mc-conditions="MultiProdPublish.Classic">
                                                <img class="oie-label" title="Label: Okta Classic Engine content" src="../../../resources/images/okta-assets/classic_engine.svg" />
                                            </div>
                                            <div class="body-main" data-test="bodyContent">
                                                <!-- Main content body -->
                                                <div role="main" id="mc-main-content">
                                                    <h1>Migrate registry-key-based Office 365 Silent Activation to new configuration</h1>
                                                    <div class="noteOkta">
                                                        <ul>
                                                            <li>
                                                                <p>This topic is intended for orgs that implemented the Early Access version of this feature prior to the 2019.09.0 release. If this applies to your org, you must complete this migration procedure.</p>
                                                            </li>
                                                            <li>
                                                                <p>If you're implementing this feature for the first time after the 2019.09.0 release,  follow the instructions in <a href="../apps_o365_silent_activation.htm" class="MCXref xref">Office 365 Silent Activation: New Implementations</a>.</p>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <p>This procedure describes how to migrate your registry-key-based Office 365 Silent Activation configuration to the new Kerberos-based configuration. The new configuration uses Kerberos authentication, which eliminates the need for registry keys.</p>
                                                    <h2>Start this procedure</h2>
                                                    <p>This procedure includes the following main steps:</p>
                                                    <p><a href="#A." class="MCXref xref">A. Create and test a new Kerberos subdomain</a>
                                                    </p>
                                                    <p><a href="#B." class="MCXref xref">B. Create and confirm a new DNS record for your org</a>
                                                    </p>
                                                    <p><a href="#C." class="MCXref xref">C. Test the new setup</a>
                                                    </p>
                                                    <div class="noteOkta">
                                                        <p class="noteContent">
                                                            <ul>
                                                                <li>If a Client Access Policy in Office 365 is set to deny web browsers, it will also block the silent activation.</li>
                                                                <li>If your app or Okta sign-on policy requires MFA for web browsers, there will be no MFA when logging in through silent activation.</li>
                                                                <li> SWA sign-on is not supported.</li>
                                                            </ul>
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <h3><a name="A."></a>A. Create and test a new Kerberos subdomain</h3>
                                                        <h4>1. Add a new kerberos subdomain SPN</h4>
                                                        <div class="note_cautionOkta">
                                                            <p class="noteContent">Use the same service account that you're using currently. Changing the service account can cause Silent Activation authentication requests to fail.
			</p>
                                                        </div>
                                                        <ol>
                                                            <li value="1">In your Active Directory environment, open a command prompt as an administrator.</li>
                                                            <li value="2">
                                                                <p>Run the following command to add a Kerberos subdomain SPN:</p>
                                                                <p><span class="code">setspn -S HTTP/&lt;yourorg&gt;.kerberos.&lt;oktaorgtype&gt;.com &lt;serviceAccountName&gt;</span>
                                                                </p>
                                                                <table style="width: 100%;mc-table-style: url('../../../resources/tablestyles/standard.css');" class="TableStyle-standard" cellspacing="0">
                                                                    <col class="TableStyle-standard-Column-Column1" style="width: 808px;" />
                                                                    <col class="TableStyle-standard-Column-Column1" />
                                                                    <thead>
                                                                        <tr class="TableStyle-standard-Head-Header1">
                                                                            <th class="TableStyle-standard-HeadF-Column1-Header1">
                                                                                <p>Placeholder</p>
                                                                            </th>
                                                                            <th class="TableStyle-standard-HeadD-Column1-Header1">
                                                                                <p>Value</p>
                                                                            </th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr class="TableStyle-standard-Body-Body1">
                                                                            <td class="TableStyle-standard-BodyF-Column1-Body1">
                                                                                <p><span class="code">HTTP/&lt;yourorg&gt;.kerberos.&lt;oktaorgtype&gt;.com</span>
                                                                                </p>
                                                                            </td>
                                                                            <td class="TableStyle-standard-BodyD-Column1-Body1">Your SPN.</td>
                                                                        </tr>
                                                                        <tr class="TableStyle-standard-Body-Body2">
                                                                            <td class="TableStyle-standard-BodyF-Column1-Body2">
                                                                                <p><span class="code">oktaorgtype</span>
                                                                                </p>
                                                                            </td>
                                                                            <td class="TableStyle-standard-BodyD-Column1-Body2">
                                                                                <p>Your Okta org type. For example: oktapreview, okta-emea, or okta-gov.</p>
                                                                            </td>
                                                                        </tr>
                                                                        <tr class="TableStyle-standard-Body-Body1">
                                                                            <td class="TableStyle-standard-BodyC-Column1-Body1">
                                                                                <p><span class="code">serviceAccountName</span>
                                                                                </p>
                                                                            </td>
                                                                            <td class="TableStyle-standard-BodyA-Column1-Body1">Your service account name. This is the name that you used when configuring the Early Access version of Agentless Desktop SSO.</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                                <p>Example:</p>
                                                                <p><span class="codeph">setspn -S HTTP/qa-synth.kerberos.oktapreview.com spndefault</span>
                                                                </p>
                                                                <div class="noteOkta">
                                                                    <p class="noteContent">This command doesn't create a Active Directory user account. Instead, it adds a new SPN to the existing AD user account. This command is applicable to all orgs, including those that are using a custom URL.</p>
                                                                </div>
                                                            </li>
                                                            <li value="3">
                                                                <p>If you have multiple AD forests, repeat step 2 for each forest.</p>
                                                                <p>SPNs are unique across a forest so you only need to do this once in each forest.</p>
                                                            </li>
                                                        </ol>
                                                        <h4>2. Verify the new Kerberos subdomain SPN</h4>
                                                        <ol>
                                                            <li value="1">
                                                                <p>In Windows PowerShell, enter the following command to confirm that the new DNS and SPN entries are updated:</p>
                                                                <p><span class="codeblock">klist get HTTP/&lt;yourorg&gt;.kerberos.&lt;oktaorgtype&gt;.com</span>
                                                                </p>
                                                                <p>For example:</p>
                                                                <p><span class="codeblock">klist get HTTP/atko.kerberos.oktapreview.com</span>
                                                                </p>
                                                            </li>
                                                            <li value="2">
                                                                <p>Confirm that you get the message about successful ticket retrieval. 
</p>
                                                                <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../resources/images/office365/test-spn-klist-result.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1082" data-mc-height="522" src="../../../resources/images/office365/test-spn-klist-result_thumb_220_220.png" tabindex="" /></a>
                                                                </p>
                                                            </li>
                                                        </ol>
                                                        <h4>3. Add the new Kerberos subdomain to intranet zone</h4>
                                                        <p>Add <span class="url">https://&lt;yourorg&gt;.kerberos.&lt;oktaorgtype&gt;.com</span> to the intranet site list in your internet settings for all the devices that should use Silent Activation.</p>
                                                        <p style="font-weight: normal;">In Internet Explorer:</p>
                                                        <ol style="list-style-type: lower-alpha;">
                                                            <li value="1"> Go to <span class="uicontrol">Settings &gt; Internet Options &gt; Security.</span></li>
                                                            <li value="2">
                        On the <span class="uicontrol">Security</span> tab, click <span class="uicontrol">Local Intranet &gt; Sites &gt; Advanced</span>. </li>
                                                            <li value="3">
                                                                <p>Add the URL for your Okta org as configured in the earlier steps. </p>
                                                                <p><span class="url">https://&lt;yourorg&gt;.kerberos.&lt;oktaorgtype&gt;.com</span>
                                                                </p>
                                                                <p>Example: <span class="url">https://atkodemo.kerberos.oktapreview.com</span></p>
                                                            </li>
                                                            <li value="4">Click <span class="uicontrol">Close</span> and <span class="uicontrol">OK</span> on the other configuration options.</li>
                                                        </ol>
                                                    </div>
                                                    <div>
                                                        <h3><a name="B."></a>B. Create and confirm a new DNS record for your org</h3>
                                                        <p>Prerequisite: Domain administrator privileges  to set the SPN.</p>
                                                        <h4>1. Create a DNS record for your org</h4>
                                                        <p>In the <span class="uicontrol">Okta Admin Console</span>, </p>
                                                        <ol>
                                                            <li value="1">Go to <span class="uicontrol">Security &gt; Delegated Authentication.</span></li>
                                                            <li value="2">On the <span class="uicontrol">Delegated Authentication</span> page, click the <span class="uicontrol">Active directory</span> tab.
</li>
                                                            <li value="3">
                                                                <p>Scroll down to the <span class="uicontrol">Agentless Desktop SSO and Silent Activation</span> section and click <span class="uicontrol">Edit</span>.</p>
                                                            </li>
                                                            <li value="4">
                                                                <p>If the <span class="uicontrol">service account username</span> is in the old format (for example:  <span class="userinput">HTTP/&lt;yourorg&gt;.&lt;oktaorgtype&gt;.com</span>), change it to the sAMAccountname or the username part of the UPN of the service account for which you set up the SPN in Part A.
</p>
                                                                <div class="noteOkta">
                                                                    <p class="noteContent">Service account username is case-sensitive.</p>
                                                                </div>
                                                                <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../resources/images/office365/ui-validate-save.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1192" data-mc-height="674" src="../../../resources/images/office365/ui-validate-save_thumb_220_220.png" tabindex="" /></a>
                                                                </p>
                                                            </li>
                                                            <li value="5">Select <span class="uicontrol">Validate service account credential on save</span>.</li>
                                                            <li value="6">Click <span class="uicontrol">Save</span>.</li>
                                                        </ol>
                                                        <p>This triggers the creation of a new DNS record for your org. Creating a new DNS record can take a few minutes, or sometimes, a few hours.</p>
                                                        <h4>2. Confirm the creation of the new DNS record</h4>
                                                        <p>Use the following <span class="code">dig</span> (Mac) or <span class="code">nslookup</span> (Windows) commands to confirm that the new Kerberos URL is reachable. </p>
                                                        <div class="noteOkta">
                                                            <p class="noteContent">If you don't see a success message, run the command again after a few minutes. Sometimes, record creation can take several hours.
Refer to the respective command reference documentation for more information on the output messages.			</p>
                                                        </div>
                                                        <p style="text-decoration: underline;">For Mac</p>
                                                        <p><span class="codeblock">$ dig &lt;yourorg&gt;.kerberos.&lt;oktaorgtype&gt;.com
</span>
                                                        </p>
                                                        <p>For example:</p>
                                                        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../resources/images/office365/test-dns-dig-result.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1138" data-mc-height="640" src="../../../resources/images/office365/test-dns-dig-result_thumb_220_220.png" tabindex="" /></a>
                                                        </p>
                                                        <p>OR</p>
                                                        <p style="text-decoration: underline;">For Windows</p>
                                                        <p><span class="codeblock">$ nslookup &lt;yourorg&gt;.kerberos.&lt;oktaorgtype&gt;.com</span>
                                                        </p>
                                                        <p>For example:</p>
                                                        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../resources/images/office365/test-dns-lookup-result.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="2083" data-mc-height="472" src="../../../resources/images/office365/test-dns-lookup-result_thumb_220_220.png" tabindex="" /></a>
                                                        </p>
                                                    </div>
                                                    <div>
                                                        <h3><a name="C."></a>C. Test the new setup</h3>
                                                        <h4>Prerequisites</h4>
                                                        <ul>
                                                            <li>Test user account that has assigned Office 365 app instance and works with old Silent Activation configuration.</li>
                                                            <li>Following credentials for the test user account:
<ul><li><span class="uicontrol">Domain</span>: <span class="userinput">&lt;yourorg&gt;.kerberos.&lt;oktaorgtype&gt;.com</span></li><li><span class="uicontrol">External ID</span>: External ID of the org in which the test user is. You can find this in the script you used for the org's WS-Fed set up.
</li><li><span class="uicontrol">Username</span>: Username part of the test user's UPN.</li><li><span class="uicontrol">Password</span>: Password for the test user's account.</li></ul></li>
                                                            <li>Admin permissions on Windows.
</li>
                                                        </ul>
                                                        <h4>Procedure</h4>
                                                        <ol>
                                                            <li value="1">
                                                                <p>On Windows, as an admin run the following PowerShell command:</p>
                                                                <p><span class="codeblock">Get-ExecutionPolicy</span>
                                                                </p>
                                                            </li>
                                                            <li value="2">
                                                                <p>Make a note of the output policy. This value is required for the final step of the procedure.</p>
                                                                <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../resources/images/office365/test-mig-get-policy.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="1148" data-mc-height="88" src="../../../resources/images/office365/test-mig-get-policy_thumb_220_220.png" tabindex="" /></a>
                                                                </p>
                                                            </li>
                                                            <li value="3">
                                                                <p>Change the execution policy to <span class="code">Unrestricted</span> using the following command:</p>
                                                                <p><span class="codeblock">Set-ExecutionPolicy Unrestricted</span>
                                                                </p>
                                                                <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../resources/images/office365/test-mig-set-policy.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="2680" data-mc-height="288" src="../../../resources/images/office365/test-mig-set-policy_thumb_220_220.png" tabindex="" /></a>
                                                                </p>
                                                            </li>
                                                            <li value="4">
                                                                <p>Test a user account:</p>
                                                                <ol style="list-style-type: lower-alpha;">
                                                                    <li value="1">
                                                                        <p>Copy the following script into a text file and save the file as <span class="filepath">Test_windowsTransport.ps1</span>.</p>
                                                                        <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">Copy</a>
                                                                            <div style="mc-code-lang: PowerShell;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code><span style="color: #a71d5d; font-weight: bold; ">param</span> (<br />[Parameter(Mandatory=<span style="font-weight: bold; ">$true</span>,<br />HelpMessage=<span style="color: #df5000; ">"Domain for org. No need to pass Kerberos subdomain."</span>)]<br />[string]<span style="font-weight: bold; ">$domain</span>,<br />[Parameter(Mandatory=<span style="font-weight: bold; ">$true</span>,<br />HelpMessage=<span style="color: #df5000; ">"External id of the Office365 app instance."</span>)]<br />[string]<span style="font-weight: bold; ">$externalId</span>,<br />[Parameter(Mandatory=<span style="font-weight: bold; ">$true</span>,<br />HelpMessage=<span style="color: #df5000; ">"Username for the account on the box that should be used for authentication."</span>)]<br />[string]<span style="font-weight: bold; ">$username</span>,<br />[Parameter(Mandatory=<span style="font-weight: bold; ">$true</span>,<br />HelpMessage=<span style="color: #df5000; ">"Password for the account on the box that should be used for authentication."</span>)]<br />[string]<span style="font-weight: bold; ">$password</span><br />)<br /> <br /><span style="font-weight: bold; ">$HTTPREQUEST_SETCREDENTIALS_FOR_SERVER</span> = <span style="color: #333333; ">0</span>;<br /> <br /><span style="font-weight: bold; ">$path</span> = <span style="color: #df5000; ">"app/office365/{0}/sso/wsfed/windowstransport"</span> -f <span style="font-weight: bold; ">$externalId</span><br /><span style="font-weight: bold; ">$url</span> = <span style="color: #df5000; ">"https://{0}/{1}"</span> -f <span style="font-weight: bold; ">$domain</span>, <span style="font-weight: bold; ">$path</span><br /><span style="color: #a71d5d; font-weight: bold; ">Write-Host</span> (<span style="color: #df5000; ">"Url: {0}"</span> -f <span style="font-weight: bold; ">$url</span>)<br /> <br /><span style="font-weight: bold; ">$soapPayload</span> =<br />@<span style="color: #df5000; ">'</span><br />&lt;s:Envelope xmlns:s=<span style="color: #df5000; ">'http://www.w3.org/2003/05/soap-envelope'</span><br />xmlns:wsa=<span style="color: #df5000; ">'http://www.w3.org/2005/08/addressing'</span><br />xmlns:wsu=<span style="color: #df5000; ">'http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd'</span>&gt;<br />&lt;s:Header&gt;<br />&lt;wsa:Action s:mustUnderstand=<span style="color: #df5000; ">'1'</span>&gt;http://schemas.xmlsoap.org/ws/<span style="color: #333333; ">2005</span>/<span style="color: #333333; ">02</span>/trust/RST/Issue&lt;/wsa:Action&gt;<br />&lt;wsa:messageID&gt;urn:uuid:<span style="color: #a71d5d; font-weight: bold; ">099B1123-4E9C</span>-<span style="color: #a71d5d; font-weight: bold; ">4244-8F51</span>-B92937BFA08E&lt;/wsa:messageID&gt;<br />&lt;wsa:ReplyTo&gt;<br />&lt;wsa:Address&gt;http://www.w3.org/<span style="color: #333333; ">2005</span>/<span style="color: #333333; ">08</span>/addressing/anonymous&lt;/wsa:Address&gt;<br />&lt;/wsa:ReplyTo&gt;<br />&lt;wsa:To s:mustUnderstand=<span style="color: #df5000; ">'1'</span>&gt;{<span style="color: #333333; ">0</span>}&lt;/wsa:To&gt;<br />&lt;/s:Header&gt;<br />&lt;s:Body&gt;<br />&lt;wst:RequestSecurityToken xmlns:wst=<span style="color: #df5000; ">'http://schemas.xmlsoap.org/ws/2005/02/trust'</span>&gt;<br />&lt;wsp:AppliesTo xmlns:wsp=<span style="color: #df5000; ">'http://schemas.xmlsoap.org/ws/2004/09/policy'</span>&gt;<br />&lt;wsa:EndpointReference&gt;<br />&lt;wsa:Address&gt;urn:federation:MicrosoftOnline&lt;/wsa:Address&gt;<br />&lt;/wsa:EndpointReference&gt;<br />&lt;/wsp:AppliesTo&gt;<br />&lt;wst:KeyType&gt;http://schemas.xmlsoap.org/ws/<span style="color: #333333; ">2005</span>/<span style="color: #333333; ">05</span>/identity/NoProofKey&lt;/wst:KeyType&gt;<br />&lt;wst:RequestType&gt;http://schemas.xmlsoap.org/ws/<span style="color: #333333; ">2005</span>/<span style="color: #333333; ">02</span>/trust/Issue&lt;/wst:RequestType&gt;<br />&lt;/wst:RequestSecurityToken&gt;<br />&lt;/s:Body&gt;<br />&lt;/s:Envelope&gt;<br /><span style="color: #df5000; ">'@ -f $url</span><br /> <br /><span style="font-weight: bold; ">$winHttp</span> = <span style="color: #a71d5d; font-weight: bold; ">New-Object</span> -Com <span style="color: #df5000; ">"WinHttp.WinHttpRequest.5.1"</span><br /><span style="font-weight: bold; ">$winHttp</span>.open(<span style="color: #df5000; ">"POST"</span>, <span style="font-weight: bold; ">$url</span>, <span style="font-weight: bold; ">$false</span>)<br /> <br /><span style="font-weight: bold; ">$winHttp</span>.SetRequestHeader(<span style="color: #df5000; ">"Content-Type"</span>, <span style="color: #df5000; ">"application/soap+xml; charset=utf-8"</span>)<br /><span style="font-weight: bold; ">$winHttp</span>.SetRequestHeader(<span style="color: #df5000; ">"SOAPAction"</span>, <span style="color: #df5000; ">"http://schemas.xmlsoap.org/ws/2005/02/trust/RST/Issue"</span>)<br /><span style="font-weight: bold; ">$winHttp</span>.SetRequestHeader(<span style="color: #df5000; ">"x-client-OS"</span>, <span style="color: #df5000; ">"10.0.14393"</span>)<br /><span style="font-weight: bold; ">$winHttp</span>.SetRequestHeader(<span style="color: #df5000; ">"x-client-SKU"</span>, <span style="color: #df5000; ">"Win32"</span>)<br /><span style="font-weight: bold; ">$winHttp</span>.SetRequestHeader(<span style="color: #df5000; ">"x-client-Ver"</span>, <span style="color: #df5000; ">"v2.2.1.28801"</span>)<br /> <br /><span style="font-weight: bold; ">$winHttp</span>.send(<span style="font-weight: bold; ">$soapPayload</span>)<br /> <br /><span style="color: #a71d5d; font-weight: bold; ">if</span> (<span style="font-weight: bold; ">$winHttp</span>.Status <span style="color: #795da3; ">-ne</span> [int]<span style="color: #333333; ">401</span>) {<br /><span style="color: #a71d5d; font-weight: bold; ">Write-Error</span> (<span style="color: #df5000; ">"Received unexpected response status: {0}, expected 401."</span> -f <span style="font-weight: bold; ">$winHttp</span>.Status)<br />}<br /> <br /><span style="color: #a71d5d; font-weight: bold; ">Write-Host</span> <span style="color: #df5000; ">"Received 401 response status."</span><br /> <br /><span style="font-weight: bold; ">$winHttp</span>.SetCredentials(<span style="font-weight: bold; ">$username</span>, <span style="font-weight: bold; ">$password</span>, <span style="font-weight: bold; ">$HTTPREQUEST_SETCREDENTIALS_FOR_SERVER</span>)<br /><span style="font-weight: bold; ">$winHttp</span>.send(<span style="font-weight: bold; ">$soapPayload</span>)<br /> <br /><span style="color: #a71d5d; font-weight: bold; ">if</span> (<span style="font-weight: bold; ">$winHttp</span>.Status <span style="color: #795da3; ">-ne</span> [int]<span style="color: #333333; ">200</span>) {<br /><span style="color: #a71d5d; font-weight: bold; ">Write-Error</span> (<span style="color: #df5000; ">"Received unexpected response status: {0}, expected 200."</span> -f <span style="font-weight: bold; ">$http</span>.Status)<br />}<br /> <br /><span style="color: #a71d5d; font-weight: bold; ">Write-Host</span> (<span style="color: #df5000; ">"Received {0} response status."</span> -f <span style="font-weight: bold; ">$winHttp</span>.Status)<br /> <br /><span style="font-weight: bold; ">$samlTicket</span> = [XML]<span style="font-weight: bold; ">$winHttp</span>.ResponseText<br /> <br /><span style="color: #a71d5d; font-weight: bold; ">if</span> (-not <span style="font-weight: bold; ">$samlTicket</span>.Envelope.Body.RequestSecurityTokenResponse.RequestedSecurityToken) {<br /><span style="color: #a71d5d; font-weight: bold; ">Write-Error</span> (<span style="color: #df5000; ">"Response did not contain saml ticket."</span>)<br />}<br /> <br /><span style="color: #a71d5d; font-weight: bold; ">Write-Host</span> (<span style="color: #df5000; ">"Valid SAML ticket received."</span>)</code></pre>
                                                                            </div>
                                                                        </div>
                                                                    </li>
                                                                    <li value="2">
                                                                        <p>Run the following command in PowerShell:</p>
                                                                        <div class="codeSnippet"><a class="codeSnippetCopyButton" role="button" href="javascript:void(0);">Copy</a>
                                                                            <div style="mc-code-lang: PowerShell;" class="codeSnippetBody" data-mc-continue="False" data-mc-line-number-start="1" data-mc-use-line-numbers="False"><pre><code>.\Test_windowsTransport.ps1 -domain &lt;yourorg&gt;.kerberos.&lt;oktaorgtype&gt;.com -externalId &lt;orgexternalid&gt; -username &lt;testusername&gt; -password &lt;-testpassword&gt;    </code></pre>
                                                                            </div>
                                                                        </div>
                                                                    </li>
                                                                    <li value="3">
                                                                        <p>Confirm that you get the following successful SAML message:</p>
                                                                        <p><span class="codeblock">Valid SAML ticket received.</span>
                                                                        </p>
                                                                        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../resources/images/office365/test-mig-test-user.png"><img class="MCPopupThumbnail img imgthumbnail" data-mc-width="2225" data-mc-height="148" src="../../../resources/images/office365/test-mig-test-user_thumb_220_220.png" tabindex="" /></a>
                                                                        </p>
                                                                        <p>This confirms that Silent Activation is successful for the test user.</p>
                                                                    </li>
                                                                </ol>
                                                            </li>
                                                            <li value="5">
                                                                <p>Restore the execution policy to the original value using the following command:</p>
                                                                <p><span class="codeblock">Set-ExecutionPolicy &lt;initialPolicy&gt;</span>
                                                                </p>
                                                            </li>
                                                        </ol>
                                                    </div>
                                                    <h2>See also</h2>
                                                    <p><a href="../apps_o365_silent_activation.htm" class="MCXref xref">Office 365 Silent Activation: New Implementations</a>
                                                    </p>
                                                    <p><a href="advanced.htm" class="MCXref xref">Advanced integration topics for Office 365</a>
                                                    </p>
                                                    <p><a href="../office365-deployment/deploy-main.htm" class="MCXref xref">Typical workflow for deploying Microsoft Office 365 in Okta</a>
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- div class="toolbar-main">
            <MadCap:topicToolbarProxy data-mc-skin="/Project/Skins/okta-toolbar-no-expand.flskn" style="mc-topic-toolbar-items: ;" />
                </div -->
                                    <!-- *********************** Footer rows ********************************* -->
                                    <div class="footer2" data-test="footer">
                                        <div>
                                            <p class="copyright" data-test="copyrightNotice">  <span class="mc-variable okta-variables.Year variable">2023</span> <span class="mc-variable okta-variables.CompanyName variable">Okta, Inc</span>. All Rights Reserved. Various trademarks held by their respective owners.
	</p>
                                        </div>
                                    </div>
                                    <!-- ********************** Scripts ************************************* -->
                                    <script src="../../../resources/scripts/js/ignore-dompurify.js">
                                    </script>
                                    <script src="../../../resources/scripts/js/app.js">
                                    </script>
                                    <script src="../../../resources/scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../../resources/scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../../resources/scripts/coveo-resources/js/coveo.madcapflare.requirejs.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../../resources/scripts/coveo-resources/js/coveo.madcapflare.okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                    <!-- Feedback tab for Qualtrics survey -->
                                    <div id="feedback-tab" data-mc-conditions="Primary.live-site-only"><a id="feedback-link" href="#" onclick="openSurvey();  return false" target="_blank" title="Submit feedback"><div id="feedback-container"><p id="feedback-text" translate="no">Feedback</p></div></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
