<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="_Skins_okta_html5_topnav_nav_poc" data-mc-search-type="Stem" data-mc-help-system-file-name="okta_help.xml" data-mc-path-to-help-system="../../../../" data-mc-has-content-body="True" data-mc-toc-path="App integrations|[%=System.LinkedHeader%]|Microsoft Azure AD&#160;and Office 365|[%=System.LinkedHeader%]|Deploy Office 365" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic;Default" data-mc-preload-images="false" data-mc-in-preview-mode="false">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="typeofcontent" content="documentation" />
        <meta name="audience" content="admin" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="Explains different provisioning types and how to configure them." /><title>Provision users to Office 365 | Okta</title>
        <meta charset="utf-8" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, height=device-height" />
        <link rel="shortcut icon" href="../../../Resources/Images/favicon.ico" type="image/x-icon" />
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Google Tag Manager -->
        <!-- End Google Tag Manager -->
        <!-- Pendo Script (Per Chris Bank) -->
        <!-- End Pendo Script -->
        <link href="../../../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/foundation.6.2.3.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Styles.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Tablet.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../../Skins/Fluid/Stylesheets/Mobile.css" rel="stylesheet" type="text/css" data-mc-generated="True" />
        <link href="../../../Resources/Stylesheets/okta-main-new-nav.css" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.5395/css/CoveoFullSearchNewDesign.css" />
        <style>/*&lt;meta /&gt;*/

.button.select-language-button
{
	-pie-background: linear-gradient(#ffffff, #ffffff);
}

.button.previous-topic-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.button.next-topic-button
{
	-pie-background: linear-gradient(#ffffff, #ececec);
}

.needs-pie
{
	behavior: url('../../../../Resources/Scripts/PIE-no-motw.htc');
}

</style>
        <script src="../../../../Resources/Scripts/jquery.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/purify.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/require.min.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/require.config.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/foundation.6.2.3_custom.js" type="text/javascript">
        </script>
        <script src="../../../../Resources/Scripts/plugins.min.js" type="text/javascript" defer="defer">
        </script>
        <script src="../../../../Resources/Scripts/MadCapAll.js" type="text/javascript" defer="defer">
        </script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-NMZZV4P');
			/* ]]> */
		</script>
        <script>
			/* <![CDATA[ */
			(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
			new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
			j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
			'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
			})(window,document,'script','dataLayer','GTM-KXMLV58');
			/* ]]> */
		</script>
        <script>
		/* <![CDATA[ */
		(function(apiKey){
			(function(p,e,n,d,o){var v,w,x,y,z;o=p[d]=p[d]||{};o._q=o._q||[];
			v=['initialize','identify','updateOptions','pageLoad','track'];for(w=0,x=v.length;w<x;++w)(function(m){
			o[m]=o[m]||function(){o._q[m===v[0]?'unshift':'push']([m].concat([].slice.call(arguments,0)));};})(v[w]);
			y=e.createElement(n);y.async=!0;y.src='https://cdn.pendo.io/agent/static/'+apiKey+'/pendo.js';
			z=e.getElementsByTagName(n)[0];z.parentNode.insertBefore(y,z);})(window,document,'script','pendo');

        pendo.initialize({
            visitor: {
                id:              'VISITOR-UNIQUE-ID'
            },	
            account: {
                id:           'ACCOUNT-UNIQUE-ID'
            }
        });
		})('a9bd3885-93ae-46ab-700b-dd29e613c19d');
		/* ]]> */
		</script>
    </head>
    <body>
        <div class="foundation-wrap off-canvas-wrapper">
            <div class="off-canvas-wrapper-inner" data-off-canvas-wrapper="">
                <aside class="off-canvas position-right" role="navigation" id="offCanvas" data-off-canvas="" data-position="right" data-mc-ignore="true">
                    <ul class="off-canvas-drilldown vertical menu off-canvas-list" data-drilldown="" data-mc-back-link="Back" data-mc-css-tree-node-expanded="is-drilldown-submenu-parent" data-mc-css-tree-node-collapsed="is-drilldown-submenu-parent" data-mc-css-sub-menu="vertical menu slide-in-right is-drilldown-submenu" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="True" data-mc-include-back="True" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.drilldown" data-mc-toc="True">
                    </ul>
                </aside>
                <div class="off-canvas-content inner-wrap" data-off-canvas-content="">
                    <div data-sticky-container="" class="title-bar-container">
                        <nav class="title-bar tab-bar sticky" role="banner" data-sticky="" data-options="marginTop:0" style="width:100%" data-sticky-on="only screen and (max-width: 1024px)" data-mc-ignore="true"><a class="skip-to-content fluid-skip showOnFocus" href="#">Skip To Main Content</a>
                            <div class="middle title-bar-section outer-row clearfix">
                                <div class="menu-icon-container relative clearfix">
                                    <div class="central-account-wrapper">
                                        <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                            <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                                <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                            </div>
                                        </div>
                                    </div>
                                    <button class="menu-icon" aria-label="Show Navigation Panel" data-toggle="offCanvas"><span></span>
                                    </button>
                                </div>
                            </div>
                            <div class="title-bar-layout outer-row">
                                <div class="logo-wrapper"><a class="logo" href="https://support.okta.com/help/s/" alt="Okta"></a>
                                </div>
                                <div class="navigation-wrapper nocontent">
                                    <ul class="navigation clearfix" role="navigation" data-mc-css-tree-node-has-children="has-children" data-mc-css-sub-menu="sub-menu" data-mc-expand-event="mouseenter" data-mc-top-nav-menu="True" data-mc-max-depth="2" data-mc-include-icon="False" data-mc-include-indicator="False" data-mc-include-children="True" data-mc-include-siblings="True" data-mc-include-parent="True" data-mc-toc="True">
                                        <li class="placeholder" style="visibility:hidden"><a>placeholder</a>
                                        </li>
                                    </ul>
                                </div>
                                <div class="central-account-wrapper">
                                    <div class="central-dropdown"><a class="central-account-drop"><span class="central-account-image"></span><span class="central-account-text">Account</span></a>
                                        <div class="central-dropdown-content"><a class="MCCentralLink central-dropdown-content-settings">Settings</a>
                                            <hr class="central-separator" /><a class="MCCentralLink central-dropdown-content-logout">Logout</a>
                                        </div>
                                    </div>
                                </div>
                                <div class="nav-search-wrapper">
                                    <div class="nav-search row">
                                        <form class="search" action="#">
                                            <div class="search-bar search-bar-container needs-pie">
                                                <input class="search-field needs-pie" type="search" aria-label="Search Field" placeholder="Search" />
                                                <div class="search-filter-wrapper"><span class="invisible-label" id="search-filters-label">Filter: </span>
                                                    <div class="search-filter" aria-haspopup="true" aria-controls="sf-content" aria-expanded="false" aria-label="Search Filter" title="All Files" role="button" tabindex="0">
                                                    </div>
                                                    <div class="search-filter-content" id="sf-content">
                                                        <ul>
                                                            <li>
                                                                <button class="mc-dropdown-item" aria-labelledby="search-filters-label filterSelectorLabel-00001"><span id="filterSelectorLabel-00001">All Files</span>
                                                                </button>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="search-submit-wrapper" dir="ltr">
                                                    <div class="search-submit" title="Search" role="button" tabindex="0"><span class="invisible-label">Submit Search</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="main-section">
                        <div class="row outer-row sidenav-layout">
                            <nav class="sidenav-wrapper">
                                <div class="sidenav-container">
                                    <ul class="off-canvas-accordion vertical menu sidenav" data-accordion-menu="" data-mc-css-tree-node-expanded="is-accordion-submenu-parent" data-mc-css-tree-node-collapsed="is-accordion-submenu-parent" data-mc-css-sub-menu="vertical menu accordion-menu is-accordion-submenu nested" data-mc-include-indicator="False" data-mc-include-icon="False" data-mc-include-parent-link="False" data-mc-include-back="False" data-mc-defer-expand-event="True" data-mc-expand-event="click.zf.accordionMenu" data-mc-toc="True" data-mc-side-nav-menu="True">
                                    </ul>
                                </div>
                            </nav>
                            <div class="body-container">
                                <div data-mc-content-body="True">
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NMZZV4P" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Google Tag Manager (noscript) -->
                                    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KXMLV58" height="0" width="0" style="display:none;visibility:hidden"></iframe>
                                    </noscript>
                                    <!-- End Google Tag Manager (noscript) -->
                                    <!-- Coveo config parameters -->
                                    <div id="coveo_org_id" style="Display:None"><span class="mc-variable okta-coveo-config.OrgId variable">oktaproduction9ounvcxa</span>
                                    </div>
                                    <div id="coveo_rest_uri" style="Display:None"><span class="mc-variable okta-coveo-config.PlatformRestUri variable">https://platform.cloud.coveo.com/rest/search</span>
                                    </div>
                                    <div id="coveo_search_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchPageUrl variable">https://support.okta.com/help/s/global-search/%40uri</span>
                                    </div>
                                    <div id="coveo_token_url" style="Display:None"><span class="mc-variable okta-coveo-config.SearchTokenServiceUrl variable">https://support.okta.com/help/services/apexrest/PublicSearchToken?site=help</span>
                                    </div>
                                    <!-- End Coveo config parameters -->
                                    <!-- ************** Coveo Search bar ************************************* -->
                                    <!-- set margin and size in /Content/Resources/Scripts/coveo-resources/css/Coveo.Okta.StandaloneSearchbox.min.css to make room for replacing Flare-generated top-nav with HTML code (see below)-->
                                    <div id="OLC_Coveo_Headline" class="coveo-headline-wrapper" data-mc-conditions="MultiProdPubish.SearchBar">
                                        <div class="slds-p-vertical_small">
                                            <!--Search Bar-->
                                            <div class="slds-grid slds-grid_align-center">
                                                <div id="customSelect" class="CoveoCustomSelect slds-float_right">
                                                </div>
                                                <div id="standaloneSearchbox">
                                                    <div class="CoveoAnalytics" data-search-hub="OktaCommunityFullSearch">
                                                    </div>
                                                    <div class="CoveoTab" data-id="Help" data-caption="Help" style="display:none">
                                                    </div>
                                                    <div class="CoveoSearchbox" data-enable-omnibox="true" data-enable-query-suggest-addon="true">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="replace_top_nav">
                                        <div class="navbar">
                                            <div class="dropdown" data-mc-conditions="MultiProdPubish.DocMenu">
                                                <button class="dropbtn">Documentation <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content">
                                                    <div><a href="https://help.okta.com/en-us/Content/Topics/ReleaseNotes/okta-relnotes.htm">Release notes</a>
                                                    </div>
                                                    <div><a href="https://help.okta.com/en-us/Content/index.htm">Product documentation</a>
                                                    </div>
                                                    <div><a href="https://developer.okta.com/documentation" target="_blank">Developer documentation<img src="../../../Resources/Images/okta-assets/external-link-icon.svg" style="margin-left: 8px;" /></a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown"><a href="https://support.okta.com/help/s/knowledge">Knowledge base</a>
                                            </div>
                                            <div class="dropdown">
                                                <button class="dropbtn">Community <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content">
                                                    <div><a href="https://support.okta.com/help/s/questions?language=en_US">Questions</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/group/CollaborationGroup/Recent?language=en_US">Discussions</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/events?language=en_US">Webinars</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown">
                                                <button class="dropbtn">Product <i class="fa fa-caret-down"></i></button>
                                                <div class="dropdown-content">
                                                    <div><a href="https://support.okta.com/help/s/ideas" target="_blank">Ideas<img src="../../../Resources/Images/okta-assets/external-link-icon.svg" style="margin-left: 8px;" /></a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/productroadmap?language=en_US">Roadmap</a>
                                                    </div>
                                                    <div><a href="https://support.okta.com/help/s/product-hub?language=en_US">Product hub</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown"><a href="https://www.okta.com/services/education-services/" target="_blank">Training<span><img src="../../../Resources/Images/okta-assets/external-link-icon.svg" style="margin-left: 8px;" /></span></a>
                                            </div>
                                        </div>
                                        <div class="logo_container"><a class="logo" href="https://support.okta.com/help/s/"><img src="../../../Resources/Images/okta-assets/Logo.png" alt="Okta Support" title="Okta Support" /></a>
                                        </div>
                                    </div>
                                    <!-- **********************  Main content row  ********************** -->
                                    <div class="okta-topics">
                                        <!-- *** Col1: Body Col *** -->
                                        <div>
                                            <div class="is-not-in-mobile">
                                                <!-- Breadcrumbs -->
                                                <div class="nocontent">
                                                    <div class="MCBreadcrumbsBox_0 breadcrumbs" role="navigation" aria-label="Breadcrumbs" data-mc-breadcrumbs-divider="  &gt;  " data-mc-breadcrumbs-count="3" data-mc-toc="True">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="toolbar-main">
                                                <div class="buttons popup-container clearfix topicToolbarProxy _Skins_okta_toolbar_no_expand mc-component nocontent" style="mc-topic-toolbar-items: ;">
                                                    <div class="button-group-container-left">
                                                        <button class="button needs-pie select-language-button" title="Change language">
                                                            <div>
                                                                <div role="img" class="button-icon-wrapper" aria-label="Change language">
                                                                    <div class="button-icon"> </div>
                                                                </div>
                                                            </div>
                                                        </button>
                                                        <button class="button needs-pie previous-topic-button" title="Previous topic" disabled="true">
                                                            <div>
                                                                <div role="img" class="button-icon-wrapper" aria-label="Navigate previous">
                                                                    <div class="button-icon"> </div>
                                                                </div>
                                                            </div>
                                                        </button>
                                                        <button class="button needs-pie next-topic-button" title="Next topic" disabled="true">
                                                            <div>
                                                                <div role="img" class="button-icon-wrapper" aria-label="Navigate next">
                                                                    <div class="button-icon"> </div>
                                                                </div>
                                                            </div>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="body-main">
                                                <!-- Main content body -->
                                                <div role="main" id="mc-main-content">
                                                    <h1>Provision users to Office 365</h1>
                                                    <p>You can create, update, and deprovision users in Office 365 from your Okta org. You can import users from different source directories into Okta and provision them in Office 365 using profile mappings.</p>
                                                    <h2>Before you begin
        </h2>
                                                    <ul>
                                                        <li>Complete <a href="configure-sso.htm" class="MCXref xref">Configure single sign on for Office 365</a>.</li>
                                                        <li>Disable the Microsoft MFA for the Office 365 admin account you’re using for WS-Federation. If the MFA is enabled, it can break provisioning and single sign on set-ups in Okta.</li>
                                                        <li>
                                                            <p><b>Bring users in Okta</b>: You can import users from a directory such as Active Directory (AD) or an app such as Salesforce. You can also create users directly in Okta. See the following  for more information.</p>
                                                            <ul>
                                                                <li><a href="../../Directory/ad-agent-manage-users-groups.htm" class="MCXref xref">Manage Active Directory users and groups</a>
                                                                </li>
                                                                <li><a href="../../users-groups-profiles/usgp-add-users.htm" class="MCXref xref">Add users manually</a>
                                                                </li>
                                                                <li><a href="../../users-groups-profiles/usgp-import-users-main.htm" class="MCXref xref">Import users</a> from an app. Imports that take longer than two hours to complete are not currently supported. For such imports, please <a href="https://support.okta.com/help/s/opencase">contact Support</a>. </li>
                                                            </ul>
                                                        </li>
                                                        <li>
                                                            <p>Decide the type of provisioning, depending on your provisioning needs. See <a href="../Office365/References/provisioning-types.htm" class="MCXref xref">Provisioning options for Office 365</a>.</p>
                                                        </li>
                                                    </ul>
                                                    <h2>Start this procedure</h2>
                                                    <p>To provision users in Office 365, you need to:</p>
                                                    <p><a href="#1." class="MCXref xref">1. Set up Okta to Office 365 provisioning</a>
                                                    </p>
                                                    <p><a href="#2." class="MCXref xref">2. Map profile attributes Okta to Office 365</a>
                                                    </p>
                                                    <p><a href="#3." class="MCXref xref">3. Test provisioning</a>
                                                    </p>
                                                    <h3><a name="1."></a>1. Set up Okta to Office 365 provisioning</h3>
                                                    <p>You can automate provisioning tasks by enabling API integration and configuring settings for different user life cycle stages.</p>
                                                    <h4>1.1. Enable API integration</h4>
                                                    <p>Office 365 requires a token to authenticate against the Microsoft API. This allows Okta to implement provisioning in Office 365.</p>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../Resources/Images/Office365/Office365_Provisioning_Tab_Unconfigured.png"><img class="MCPopupThumbnail img" data-mc-width="1940" data-mc-height="1046" src="../../../Resources/Images/Office365/Office365_Provisioning_Tab_Unconfigured_thumb_220_220.png" tabindex="" id="imgthumbnail" /></a>
                                                    </p>
                                                    <ol>
                                                        <li value="1">Go to <span class="uicontrol">Office 365 &gt; Provisioning &gt; API Integration &gt; Configure API Integration</span>.</li>
                                                        <li value="2">Check <span class="uicontrol">Enable API Integration</span>.</li>
                                                        <li value="3">Enter your Office 365 Global Administrator credentials.</li>
                                                        <li value="4">
                                                            <p>To import groups now, check <span class="uicontrol">Import Groups</span>.</p>
                                                            <p>You can import groups later after finishing provisioning. See <a href="../Office365/Skip_Group_Import_Office365.htm" class="MCXref xref">Skip importing groups during Office 365 user provisioning</a>.</p>
                                                        </li>
                                                        <li value="5">Click <span class="uicontrol">Test API Credentials</span>.</li>
                                                        <li value="6">Save the credentials once they are verified successfully.</li>
                                                    </ol>
                                                    <h4>1.2. Select provisioning type and settings</h4>
                                                    <p>You can select provisioning and deprovisioning settings depending on the provisioning type you select.</p>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../Resources/Images/Office365/o365-provision-types.png"><img class="MCPopupThumbnail img" data-mc-width="1009" data-mc-height="629" src="../../../Resources/Images/Office365/o365-provision-types_thumb_220_220.png" tabindex="" id="imgthumbnail" /></a>
                                                    </p>
                                                    <ol>
                                                        <li value="1">Go to <span class="uicontrol">Office 365 &gt; Provisioning &gt; To App &gt; Edit</span>.</li>
                                                        <li value="2">
                                                            <p>Select <span class="uicontrol">Office 365 Provisioning Type</span>. See <a href="../Office365/References/provisioning-types.htm" class="MCXref xref">Provisioning options for Office 365</a>.</p>
                                                            <p>For <span class="uicontrol">Universal Sync</span> only: Check <span class="uicontrol">Send full profile, contacts, and conference rooms from these AD instances</span> if you want to sync AD groups and resources.</p>
                                                        </li>
                                                        <li value="3">Enable or Disable other provisioning settings. See <a href="../Apps_Okta_Enhancements_Office_365_Integration.htm#EnablingEnhancedProvisioning" class="MCXref xref">Get started with Office 365 provisioning and deprovisioning</a>.</li>
                                                        <li value="4">Click <span class="uicontrol">Save</span>.</li>
                                                    </ol>
                                                    <div class="noteOkta">
                                                        <img src="../../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                        <p class="noteHeading">Note</p>
                                                        <p class="noteContent">Each user provisioned for Office365 has an attribute, <span class="code">StsRefreshTokensValidFrom</span>, which is a date that invalidates existing login sessions and refresh tokens when the user changes their password, requiring the user to log into their apps again. This attribute is automatically calculated and populated based on the Provisioning Type.</p>
                                                        <ul>
                                                            <li>
                                                                <p>License Only or Profile Sync:&#160;The <span class="code">StsRefreshTokensValidFrom</span> attribute is set to the current date and time when the user changes their password in Okta.</p>
                                                            </li>
                                                            <li>
                                                                <p>User Sync or Universal Sync: If the user is linked from Active Directory, the <span class="code">StsRefreshTokensValidFrom</span> attribute is set to the <span class="code">pwdLastSet </span>attribute in Active Directory. For all other users, the <span class="code">StsRefreshTokensValidFrom</span> attribute is set to the current date and time when the user changes their password in Okta.</p>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <h3><a name="2."></a>2. Map profile attributes Okta to Office 365</h3>
                                                    <p>Depending on where your users are sourced from, the username format can vary. For users to successfully sign into Office 365, their username for Office 365 must be in an email address format for the domain you are federating (<span class="userinput">username@yourfederated.domain</span>).</p>
                                                    <div class="noteOkta">
                                                        <img src="../../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Important Note" alt="Important Note" />
                                                        <p class="noteContent">You must remap attributes whenever you make any changes to provisioning settings.</p>
                                                    </div>
                                                    <h4>Map username as-is</h4>
                                                    <p>If your users already have their username in an email address format for the domain you are federating (<span class="userinput">username@yourfederated.domain</span>) format, you can map the email as-is.</p>
                                                    <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../Resources/Images/Office365/o365-username-email.png"><img class="MCPopupThumbnail img" data-mc-width="525" data-mc-height="122" src="../../../Resources/Images/Office365/o365-username-email_thumb_220_220.png" tabindex="" id="imgthumbnail" /></a>
                                                    </p>
                                                    <ol>
                                                        <li value="1">Go to <span class="uicontrol">Office 365 &gt; Sign on &gt; Edit</span>.</li>
                                                        <li value="2">In <span class="uicontrol">Credentials Details &gt; Application username format</span>, select <span class="uicontrol">Email</span>.</li>
                                                        <li value="3">Click <span class="uicontrol">Save</span>.</li>
                                                    </ol>
                                                    <h4>Map custom username</h4>
                                                    <p>If your users are sourced from different directories or apps, their username format may vary. You can use Okta expression language to customize the username that will be passed on to Office 365.</p>
                                                    <div data-mc-conditions="MultiProdPubish.Core">
                                                        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../Resources/Images/Office365/o365-username-custom.png"><img class="MCPopupThumbnail img" data-mc-width="694" data-mc-height="240" src="../../../Resources/Images/Office365/o365-username-custom_thumb_220_220.png" tabindex="" id="imgthumbnail" /></a>
                                                        </p>
                                                        <ol>
                                                            <li value="1">Go to <span class="uicontrol">Office 365 &gt; Sign on &gt; Edit</span>.</li>
                                                            <li value="2">In <span class="uicontrol">Credentials Details &gt; Application username format</span>, select <span class="uicontrol">Custom</span>.</li>
                                                            <li value="3">
                                                                <p>Enter this expression in the provided text box.</p>
                                                                <p id="code">String.substringBefore(user.email, "@") + "@yourfederated.domain"
                </p>
                                                            </li>
                                                            <li value="4">Replace <code id="code">yourfederated.domain</code> with the domain you are federating.</li>
                                                            <li value="5">Enter an Okta user in the Preview box to check the result of the mapping.</li>
                                                            <li value="6">The resulting username should match the Office 365 username for the user.</li>
                                                            <li value="7">Click <span class="uicontrol">Save</span>.</li>
                                                        </ol>
                                                    </div>
                                                    <h4>Map email address</h4>
                                                    <p>If your users’ email addresses do not reside in the domain you are federating, you can use Okta expression language to customize the email address that will be passed on to Office 365.</p>
                                                    <p style="font-weight: bold;">Prerequisite</p>
                                                    <p>Provisioning type should be selected to User Sync or Universal Sync. See <a href="../Office365/References/provisioning-types.htm" class="MCXref xref">Provisioning options for Office 365</a>.</p>
                                                    <div data-mc-conditions="MultiProdPubish.Core">
                                                        <p><a class="MCPopupThumbnailLink MCPopupThumbnailPopup" href="../../../Resources/Images/Office365/o365-profile-editor-email-custom.png"><img class="MCPopupThumbnail img" data-mc-width="1002" data-mc-height="566" src="../../../Resources/Images/Office365/o365-profile-editor-email-custom_thumb_220_220.png" tabindex="" id="imgthumbnail" /></a>
                                                        </p>
                                                        <ol>
                                                            <li value="1">Go to <span class="uicontrol">Directory &gt; Profile Editor &gt; Microsoft Office 365 Mappings &gt; Okta to Microsoft Office 365</span>.</li>
                                                            <li value="2">
                                                                <p>In the <span class="uicontrol">source.email</span> field, enter the expression:</p>
                                                                <p id="code"><span class="userinput">String.substringBefore(user.email, "@") + "@yourfederated.domain"
</span><![CDATA[                ]]></p>
                                                            </li>
                                                            <li value="3">Replace <span class="userinput">yourfederated.domain</span> with the domain you are federating.</li>
                                                            <li value="4">Enter an Okta user in the Preview box to check the result of the mapping.</li>
                                                            <li value="5">The resultant email address should match the Office 365 email address for the user.</li>
                                                            <li value="6">Exit Preview and save mappings.</li>
                                                            <li value="7">Click <span class="uicontrol">Apply Updates Now</span>.</li>
                                                        </ol>
                                                    </div>
                                                    <h3><a name="3."></a>3. Test provisioning</h3>
                                                    <p>Ensure you have correctly configured provisioning by assigning Office 365 to test users in Okta and verifying they appear in your Microsoft tenant.</p>
                                                    <p>Prerequisite: The <span class="uicontrol">Create Users</span> option  in Provisioning must be checked.</p>
                                                    <p>In Okta,</p>
                                                    <ol>
                                                        <li value="1">Open <span class="uicontrol">Assignment</span> tab of the Microsoft Office 365 app.</li>
                                                        <li value="2">Click <span class="uicontrol">Assign</span>.</li>
                                                        <li value="3">Assign appropriate Office 365 licenses to test users.</li>
                                                        <li value="4">Click <span class="uicontrol">Done</span>.</li>
                                                    </ol>
                                                    <p>In Microsoft Admin Center,</p>
                                                    <ol>
                                                        <li value="1">Open the list of Active Users.</li>
                                                        <li value="2">Ensure all test users appear in the list with appropriate licenses.</li>
                                                    </ol>
                                                    <p>In Okta,</p>
                                                    <ol>
                                                        <li value="1">Log into Okta as a test user.</li>
                                                        <li value="2">Ensure all Office 365 apps appear on the user dashboard.</li>
                                                    </ol>
                                                    <div class="noteOkta">
                                                        <img src="../../../Resources/Images/assets/Icons/Notes/Help.png" class="noteImgFloat" title="Info" alt="Info" />
                                                        <p class="noteHeading">Note</p>
                                                        <p class="noteContent">
            If you have selected the <span class="uicontrol">User Sync</span> or <span class="uicontrol">Universal Sync</span> provisioning type, all users irrespective of where their profile is sourced from, appear as <span class="uicontrol">Synced with Active Directory</span> in the Office 365 tenant. However, the user is still sourced from the source directory.</p>
                                                    </div>
                                                    <h2><span>Next step</span>
                                                    </h2>
                                                    <p><a href="assign-o365.htm" class="MCXref xref">Assign Office 365 to users and groups</a>
                                                    </p>
                                                </div>
                                                <!-- Back to Top button --><a href="#" class="sf-back-to-top"><span class="arrow"></span>Top</a>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- div class="toolbar-main">
            <MadCap:topicToolbarProxy data-mc-skin="/Project/Skins/okta-toolbar-no-expand.flskn" style="mc-topic-toolbar-items: ;" />
                </div -->
                                    <!-- *********************** Footer rows ********************************* -->
                                    <div class="footer2">
                                        <div>
                                            <p class="copyright">©  <span class="mc-variable okta-variables.Year variable">2022</span> <span class="mc-variable okta-variables.CompanyName variable">Okta, Inc</span>. All Rights Reserved. Various trademarks held by their respective owners.
	</p>
                                        </div>
                                    </div>
                                    <!-- Qualtrics setup to use with script below, replacing getfeedback -->
                                    <div id="ZN_6fGBJ8J3VcIBymN">
                                        <!--DO NOT REMOVE-CONTENTS PLACED HERE-->
                                    </div>
                                    <!-- ********************** Scripts ************************************* -->
                                    <!-- Foundation -->
                                    <script src="../../../Resources/Scripts/js/app.js">
                                    </script>
                                    <script src="../../../Resources/Scripts/js/vendor/what-input.js">
                                    </script>
                                    <script src="https://cdnjs.cloudflare.com/ajax/libs/foundation/6.4.4-rc1/js/foundation.min.js">
                                    </script>
                                    <script type="text/javascript" src="../../../Resources/Scripts/js/vendor/qualtrics.js">
                                    </script>
                                    <!-- Coveo -->
                                    <script src="https://static.cloud.coveo.com/searchui/v2.5395/js/CoveoJsSearch.Lazy.min.js" defer="defer">
                                    </script>
                                    <script src="../../../Resources/Scripts/coveo-resources/js/cultures/en.js" id="coveoCultureScript" defer="defer">
                                    </script>
                                    <script src="../../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.RequireJS.js" id="coveoRequireScript" defer="defer">
                                    </script>
                                    <script src="../../../Resources/Scripts/coveo-resources/js/Coveo.MadcapFlare.Okta.js" id="coveoInitscript" defer="defer">
                                    </script>
                                </div>
                            </div>
                        </div>
                    </div><a data-close="true"></a>
                </div>
            </div>
        </div>
    </body>
</html>
